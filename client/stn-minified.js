var e,l=this;function aa(a,b){var c=a.split("."),d=l;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)c.length||void 0===b?d=d[f]?d[f]:d[f]={}:d[f]=b}function ba(a){a=a.split(".");for(var b=l,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}
function m(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function p(a){return"array"==m(a)}function ca(a){var b=m(a);return"array"==b||"object"==b&&"number"==typeof a.length}function s(a){return"string"==typeof a}function t(a){return"number"==typeof a}function da(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var ea="closure_uid_"+(1E9*Math.random()>>>0),fa=0;
function u(a,b){function c(){}c.prototype=b.prototype;a.Fb=b.prototype;a.prototype=new c;a.Kb=function(a,c,g){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};var ga;function ha(a){if(!ia.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ja,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(ka,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(la,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(ma,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(na,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(oa,"&#0;"));return a}var ja=/&/g,ka=/</g,la=/>/g,ma=/"/g,na=/'/g,oa=/\x00/g,ia=/[\x00&<>"']/;function pa(a,b){return a<b?-1:a>b?1:0};var w="closure_listenable_"+(1E6*Math.random()|0),qa=0;function ra(a,b,c,d,f){this.U=a;this.Aa=null;this.src=b;this.type=c;this.ra=!!d;this.wa=f;this.key=++qa;this.ca=this.qa=!1}function sa(a){a.ca=!0;a.U=null;a.Aa=null;a.src=null;a.wa=null};function ta(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function ua(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function va(a){for(var b in a)return!1;return!0}var wa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xa(a,b){for(var c,d,f=1;f<arguments.length;f++){d=arguments[f];for(c in d)a[c]=d[c];for(var g=0;g<wa.length;g++)c=wa[g],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var x=Array.prototype,ya=x.indexOf?function(a,b,c){return x.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(s(a))return s(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},za=x.forEach?function(a,b,c){x.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=s(a)?a.split(""):a,g=0;g<d;g++)g in f&&b.call(c,f[g],g,a)},Aa=x.filter?function(a,b,c){return x.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=[],g=0,h=s(a)?
a.split(""):a,k=0;k<d;k++)if(k in h){var q=h[k];b.call(c,q,k,a)&&(f[g++]=q)}return f};function y(a,b){return 0<=ya(a,b)}function Ba(a,b){var c=ya(a,b),d;(d=0<=c)&&x.splice.call(a,c,1);return d}function Ca(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Da(a,b,c){return 2>=arguments.length?x.slice.call(a,b):x.slice.call(a,b,c)};function z(a){this.src=a;this.A={};this.Da=0}z.prototype.add=function(a,b,c,d,f){var g=a.toString();a=this.A[g];a||(a=this.A[g]=[],this.Da++);var h=Ea(a,b,d,f);-1<h?(b=a[h],c||(b.qa=!1)):(b=new ra(b,this.src,g,!!d,f),b.qa=c,a.push(b));return b};z.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.A))return!1;var f=this.A[a];b=Ea(f,b,c,d);return-1<b?(sa(f[b]),x.splice.call(f,b,1),0==f.length&&(delete this.A[a],this.Da--),!0):!1};
function Fa(a,b){var c=b.type;c in a.A&&Ba(a.A[c],b)&&(sa(b),0==a.A[c].length&&(delete a.A[c],a.Da--))}z.prototype.ia=function(a,b,c,d){a=this.A[a.toString()];var f=-1;a&&(f=Ea(a,b,c,d));return-1<f?a[f]:null};function Ea(a,b,c,d){for(var f=0;f<a.length;++f){var g=a[f];if(!g.ca&&g.U==b&&g.ra==!!c&&g.wa==d)return f}return-1};var A;a:{var Ga=l.navigator;if(Ga){var Ha=Ga.userAgent;if(Ha){A=Ha;break a}}A=""}function B(a){return-1!=A.indexOf(a)};var Ia,Ja,Ka=B("Opera")||B("OPR"),C=B("Trident")||B("MSIE"),D=B("Gecko")&&-1==A.toLowerCase().indexOf("webkit")&&!(B("Trident")||B("MSIE")),E=-1!=A.toLowerCase().indexOf("webkit"),F,La=l.navigator||null;F=La&&La.platform||"";Ia=-1!=F.indexOf("Mac");Ja=-1!=F.indexOf("Win");var Ma=-1!=F.indexOf("Linux");function Na(){var a=l.document;return a?a.documentMode:void 0}
var Oa=function(){var a="",b;if(Ka&&l.opera)return a=l.opera.version,"function"==m(a)?a():a;D?b=/rv\:([^\);]+)(\)|;)/:C?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:E&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(A))?a[1]:"");return C&&(b=Na(),b>parseFloat(a))?String(b):a}(),Pa={};
function G(a){var b;if(!(b=Pa[a])){b=0;for(var c=String(Oa).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(c.length,d.length),g=0;0==b&&g<f;g++){var h=c[g]||"",k=d[g]||"",q=RegExp("(\\d*)(\\D*)","g"),v=RegExp("(\\d*)(\\D*)","g");do{var r=q.exec(h)||["","",""],n=v.exec(k)||["","",""];if(0==r[0].length&&0==n[0].length)break;b=pa(0==r[1].length?0:parseInt(r[1],10),0==n[1].length?0:parseInt(n[1],10))||pa(0==r[2].length,0==n[2].length)||
pa(r[2],n[2])}while(0==b)}b=Pa[a]=0<=b}return b}var Qa=l.document,Ra=Qa&&C?Na()||("CSS1Compat"==Qa.compatMode?parseInt(Oa,10):5):void 0;var Sa=!C||C&&9<=Ra,Ta=C&&!G("9");!E||G("528");D&&G("1.9b")||C&&G("8")||Ka&&G("9.5")||E&&G("528");D&&!G("8")||C&&G("9");function H(){0!=Ua&&(this[ea]||(this[ea]=++fa))}var Ua=0;H.prototype.Ua=!1;function I(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=this.ba=!1;this.hb=!0}I.prototype.preventDefault=function(){this.defaultPrevented=!0;this.hb=!1};function Va(a){Va[" "](a);return a}Va[" "]=function(){};function J(a,b){I.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.charCode=this.keyCode=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.Ga=this.state=null;if(a){var c=this.type=a.type;this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(D){var f;a:{try{Va(d.nodeName);f=!0;break a}catch(g){}f=!1}f||(d=null)}}else"mouseover"==c?
d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=E||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=E||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=
a.metaKey;this.state=a.state;this.Ga=a;a.defaultPrevented&&this.preventDefault()}}u(J,I);J.prototype.preventDefault=function(){J.Fb.preventDefault.call(this);var a=this.Ga;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ta)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Wa="closure_lm_"+(1E6*Math.random()|0),Xa={},Ya=0;function K(a,b,c,d,f){if(p(b)){for(var g=0;g<b.length;g++)K(a,b[g],c,d,f);return null}c=Za(c);if(a&&a[w])a=a.Ka(b,c,d,f);else{if(!b)throw Error("Invalid event type");var g=!!d,h=L(a);h||(a[Wa]=h=new z(a));c=h.add(b,c,!1,d,f);c.Aa||(d=$a(),c.Aa=d,d.src=a,d.U=c,a.addEventListener?a.addEventListener(b.toString(),d,g):a.attachEvent(ab(b.toString()),d),Ya++);a=c}return a}
function $a(){var a=bb,b=Sa?function(c){return a.call(b.src,b.U,c)}:function(c){c=a.call(b.src,b.U,c);if(!c)return c};return b}function cb(a,b,c,d,f){if(p(b))for(var g=0;g<b.length;g++)cb(a,b[g],c,d,f);else c=Za(c),a&&a[w]?a.Ea(b,c,d,f):a&&(a=L(a))&&(b=a.ia(b,c,!!d,f))&&M(b)}
function M(a){if(!t(a)&&a&&!a.ca){var b=a.src;if(b&&b[w])Fa(b.$,a);else{var c=a.type,d=a.Aa;b.removeEventListener?b.removeEventListener(c,d,a.ra):b.detachEvent&&b.detachEvent(ab(c),d);Ya--;(c=L(b))?(Fa(c,a),0==c.Da&&(c.src=null,b[Wa]=null)):sa(a)}}}function ab(a){return a in Xa?Xa[a]:Xa[a]="on"+a}function db(a,b,c,d){var f=1;if(a=L(a))if(b=a.A[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var g=b[a];g&&g.ra==c&&!g.ca&&(f&=!1!==eb(g,d))}return Boolean(f)}
function eb(a,b){var c=a.U,d=a.wa||a.src;a.qa&&M(a);return c.call(d,b)}
function bb(a,b){if(a.ca)return!0;if(!Sa){var c=b||ba("window.event"),d=new J(c,this),f=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var g=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(h){g=!0}if(g||void 0==c.returnValue)c.returnValue=!0}c=[];for(g=d.currentTarget;g;g=g.parentNode)c.push(g);for(var g=a.type,k=c.length-1;!d.ba&&0<=k;k--)d.currentTarget=c[k],f&=db(c[k],g,!0,d);for(k=0;!d.ba&&k<c.length;k++)d.currentTarget=c[k],f&=db(c[k],g,!1,d)}return f}return eb(a,new J(b,this))}
function L(a){a=a[Wa];return a instanceof z?a:null}var fb="__closure_events_fn_"+(1E9*Math.random()>>>0);function Za(a){return"function"==m(a)?a:a[fb]||(a[fb]=function(b){return a.handleEvent(b)})};N.canvas=function(){};function O(a){a=a.className;return s(a)&&a.match(/\S+/g)||[]}function gb(a,b){var c=O(a),d=Da(arguments,1),f=c.length+d.length;hb(c,d);a.className=c.join(" ");return c.length==f}function ib(a,b){var c=O(a),c=jb(c,Da(arguments,1));a.className=c.join(" ")}function hb(a,b){for(var c=0;c<b.length;c++)y(a,b[c])||a.push(b[c])}function jb(a,b){return Aa(a,function(a){return!y(b,a)})}
function kb(a,b,c){var d=O(a);s(b)?Ba(d,b):p(b)&&(d=jb(d,b));s(c)&&!y(d,c)?d.push(c):p(c)&&hb(d,c);a.className=d.join(" ")};function P(a,b,c,d,f,g){if(6==arguments.length)this.setTransform(a,b,c,d,f,g);else{if(0!=arguments.length)throw Error("Insufficient matrix parameters");this.m=this.p=1;this.o=this.n=this.t=this.u=0}}e=P.prototype;e.setTransform=function(a,b,c,d,f,g){if(!(t(a)&&t(b)&&t(c)&&t(d)&&t(f)&&t(g)))throw Error("Invalid transform parameters");this.m=a;this.o=b;this.n=c;this.p=d;this.t=f;this.u=g;return this};e.scale=function(a,b){this.m*=a;this.o*=a;this.n*=b;this.p*=b;return this};
e.translate=function(a,b){this.t+=a*this.m+b*this.n;this.u+=a*this.o+b*this.p;return this};e.rotate=function(a,b,c){var d=new P,f=Math.cos(a);a=Math.sin(a);b=d.setTransform(f,a,-a,f,b-b*f+c*a,c-b*a-c*f);return lb(this,b)};e.toString=function(){return"matrix("+[this.m,this.o,this.n,this.p,this.t,this.u].join()+")"};function lb(a,b){var c=a.m,d=a.n;a.m=b.m*c+b.o*d;a.n=b.n*c+b.p*d;a.t+=b.t*c+b.u*d;c=a.o;d=a.p;a.o=b.m*c+b.o*d;a.p=b.n*c+b.p*d;a.u+=b.t*c+b.u*d;return a}
e.transform=function(a,b,c,d,f){var g=b;for(b+=2*f;g<b;){f=a[g++];var h=a[g++];c[d++]=f*this.m+h*this.n+this.t;c[d++]=f*this.o+h*this.p+this.u}};function Q(a){var b=a.m*a.p-a.n*a.o;return new P(a.p/b,-a.o/b,-a.n/b,a.m/b,(a.n*a.u-a.p*a.t)/b,(a.o*a.t-a.m*a.u)/b)}e.Wa=function(a){return this==a?!0:a?this.m==a.m&&this.n==a.n&&this.t==a.t&&this.o==a.o&&this.p==a.p&&this.u==a.u:!1};var mb=!C||C&&9<=Ra,nb=!D&&!C||C&&C&&9<=Ra||D&&G("1.9.1");C&&G("9");function ob(a,b){return s(b)?a.getElementById(b):b}function pb(a,b){ta(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in qb?a.setAttribute(qb[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var qb={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function rb(a,b,c,d){function f(c){c&&b.appendChild(s(c)?a.createTextNode(c):c)}for(;d<c.length;d++){var g=c[d];if(!ca(g)||da(g)&&0<g.nodeType)f(g);else{var h;a:{if(g&&"number"==typeof g.length){if(da(g)){h="function"==typeof g.item||"string"==typeof g.item;break a}if("function"==m(g)){h="function"==typeof g.item;break a}}h=!1}za(h?Ca(g):g,f)}}}function R(a,b){rb(sb(a),a,arguments,1)}function S(a){return nb&&void 0!=a.children?a.children:Aa(a.childNodes,function(a){return 1==a.nodeType})}
function T(a){if(void 0!=a.firstElementChild)a=a.firstElementChild;else for(a=a.firstChild;a&&1!=a.nodeType;)a=a.nextSibling;return a}function sb(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function tb(a){this.ta=a||l.document||document}e=tb.prototype;e.w=function(a){return ob(this.ta,a)};e.ma=pb;
e.qb=function(a,b,c){var d=this.ta,f=arguments,g=f[0],h=f[1];if(!mb&&h&&(h.name||h.type)){g=["<",g];h.name&&g.push(' name="',ha(h.name),'"');if(h.type){g.push(' type="',ha(h.type),'"');var k={};xa(k,h);delete k.type;h=k}g.push(">");g=g.join("")}g=d.createElement(g);h&&(s(h)?g.className=h:p(h)?gb.apply(null,[g].concat(h)):pb(g,h));2<f.length&&rb(d,g,f,2);return g};e.createElement=function(a){return this.ta.createElement(a)};e.createTextNode=function(a){return this.ta.createTextNode(String(a))};
e.appendChild=function(a,b){a.appendChild(b)};N.a=function(){};N.a.Na={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};N.a.Qa=function(a,b){for(var c=0,d=a.length;c<d;c++)a[c][0]+=b};N.a.Ra=function(a,b){for(var c=0,d=a.length;c<d;c++)a[c][1]+=b};N.a.ha=function(a){for(var b,c,d={x:a[0][0],y:a[0][1],V:a[0][0],W:a[0][1],width:0,height:0},f=1,g=a.length;f<g;f++)b=a[f][0],c=a[f][1],b<d.x&&(d.x=b),c<d.y&&(d.y=c),b>d.V&&(d.V=b),c>d.W&&(d.W=c);d.width=d.V-d.x;d.height=d.W-d.y;return d};
N.a.ja=function(a){for(var b=[],c,d=0,f=a.getAttribute("points").split(/\s|\,/),g=0,h=f.length;g<h;g++)0===d&&(c=[]),a=f[g],""!==a&&(c[d]=parseInt(a),1===d&&b.push(c),0===d?d=1:d=0);return b};N.a.Eb=function(a,b){for(var c="",d=0,f=b.length;d<f;d++)c+=b[d][0].toString()+","+b[d][1].toString()+" ";a.setAttribute("points",c)};N.a.sb="(matrix)\\(\\s*([+-]?[\\d\\.]+)\\s*(?:[\\s,]\\s*([+-]?[\\d\\.]+)\\s*(?:[\\s,]\\s*([+-]?[\\d\\.]+)\\s*(?:[\\s,]\\s*([+-]?[\\d\\.]+)\\s*[\\s,]\\s*([+-]?[\\d\\.]+)\\s*[\\s,]\\s*([+-]?[\\d\\.]+)\\s*)?)?)?\\)";
N.a.tb=new RegExp(N.a.sb);N.a.rb=function(a){var b;if(a=N.a.tb.exec(a))b=Array(6),b[0]=parseFloat(a[2]),b[1]=parseFloat(a[3]),b[2]=parseFloat(a[4]),b[3]=parseFloat(a[5]),b[4]=parseFloat(a[6]),b[5]=parseFloat(a[7]);return b};N.a.Xa=function(a){a=a.getAttribute("transform");return(a=N.a.rb(a))?new P(a[0],a[1],a[2],a[3],a[4],a[5]):new P};N.a.L=function(a,b){a.setAttribute("transform","matrix("+b.m+","+b.o+","+b.n+","+b.p+","+b.t+","+b.u+")")};N.svg=N.a;N.a.c=function(){};N.a.c.H=function(a,b,c){var d=[a.clientX,a.clientY];Q(b.h.B).transform(d,0,ub(b),0,1);b.state="drag";b.G.element=a.target;a=c.S(a.target);b.G.coords=a};
N.a.c.I=function(a,b,c){var d=[a.clientX,a.clientY];a=b.G.element;var f=b.G.coords,g=ub(b),h=b.h.ea,k=0,q=0,v=0,r=0,k=Array(2),n=Array(f.length);Q(b.h.B).transform(d,0,k,0,1);b=0;for(d=f.length;b<d;b++)n[b]=Array(2),n[b][0]=-g[0]+k[0]+f[b][0],n[b][1]=-g[1]+k[1]+f[b][1];f=N.a.ha(n);k=f.x-h.x;v=h.V-f.V;q=f.y-h.y;r=h.W-f.W;0>k&&N.a.Qa(n,-k);0>v&&N.a.Qa(n,v);0>q&&N.a.Ra(n,-q);0>r&&N.a.Ra(n,r);c.Q(a,n);return n};
N.a.c.Za=function(a,b){var c,d=a.getAttribute("class");d&&(c=d.split(/\s+/));return c?y(c,b):!1};N.a.c.J=function(a,b){b.state="none"};N.a.c.sa=function(a){return document.createElementNS(N.a.Na.svg,a)};N.a.c.ma=function(a,b){for(var c in b){var d=b[c],f=c.indexOf(":");-1===f?a.setAttribute(c,d):a.setAttributeNS(N.a.Na[c.substring(0,f)],c,d)}};N.a.c.create=function(a,b){var c=N.a.c.sa(a.tagName);b&&N.a.c.ma(c,b);return c};N.a.g=function(){};N.a.g.za=function(a,b){return a&&N.a.c.Za(a,b.className)};N.a.g.H=function(a,b,c){"modify"===b.K&&N.a.g.za(a.target,c)&&(b.la.shape=c,b.la.element=a.target,N.a.c.H(a,b,c),b.s.N(c.Fa(a.target)))};N.a.g.I=function(a,b,c){"modify"===b.K&&"drag"===(b.state?b.state:"none")&&N.a.g.za(b.G.element,c)&&(a=N.a.c.I(a,b,c))&&b.s.update(a)};N.a.g.J=function(a,b,c){"modify"===b.K&&N.a.g.za(b.G.element,c)&&N.a.c.J(a,b,c)};
N.a.g.T=function(a,b,c){"delete"===b.K&&N.a.g.za(a.target,c)&&(a=a.target)&&N.a.c.Za(a,"xrx-shape")&&(b.s.N(c.Fa(a)),window.confirm("Delete forever?")&&(a&&a.parentNode&&a.parentNode.removeChild(a),U(b.s)))};N.a.g.create=function(a,b,c){c=c||{};a=N.a.c.sa(a);c["class"]="xrx-shape "+b;N.a.c.ma(a,c);return a};N.a.pa=function(){};N.a.pa.tagName="svg";N.a.pa.create=function(a){return N.a.c.create(N.a.pa,a)};N.a.P=function(){};N.a.P.tagName="g";N.a.P.create=function(a){return N.a.c.create(N.a.P,a)};N.a.R=function(){};N.a.R.tagName="circle";N.a.R.cb=function(){};N.a.R.create=function(a){return N.a.c.create(N.a.R,a)};N.a.k=function(){};N.a.k.wb=function(a){return parseInt(a.getAttribute("cx"))};N.a.k.xb=function(a){return parseInt(a.getAttribute("cy"))};N.a.k.S=function(a){return[[N.a.k.wb(a),N.a.k.xb(a)]]};N.a.k.Q=function(a,b){a.setAttribute("cx",b[0][0]);a.setAttribute("cy",b[0][1])};N.a.k.H=function(a,b){b.s.F.N();N.a.c.H(a,b,N.a.k)};
N.a.k.I=function(a,b){if("none"!==(b.state?b.state:"none")){var c,d=b.G.element,f=b.s,g=S(f.l),h;c=g||S(f.l);for(var k=0;k<c.length&&(h=k,c[k]!==d);k++);d=h;h=b.la.shape.vb;N.a.c.I(a,b,N.a.k);c=f.i.q;for(var f=g||S(f.l),g=f.length,k=Array(g),q,v,r=0;r<g;r++)q=Array(2),v=c.k.S(f[r]),q[0]=v[0][0],q[1]=v[0][1],k[r]=q;c=k;h&&(c=h(c,d));b.O.update(c);b.s.update(c,d)}};N.a.k.J=function(a,b){b.O.F.N();N.a.c.J(a,b,N.a.k)};N.a.k.create=function(a){return N.a.R.create({cx:a[0],cy:a[1],r:"2",style:"fill:white;"})};N.aa=function(){};N.aa.nb={ob:"svg",Jb:"vml",Gb:"canvas"};N.aa.Ma=function(){};N.aa.Ma.Wa=function(a,b){return a[0]===b[0]&&a[1]===b[1]};N.a.d=function(){};N.a.d.className="xrx-shape-polygon";N.a.d.S=function(a){return N.a.ja(a)};N.a.d.Q=function(a,b){N.a.Eb(a,b)};N.a.d.ha=function(a){a=N.a.d.S(a);return N.a.ha(a)};N.a.d.cb=function(){};N.a.d.H=function(a,b){N.a.g.H(a,b,N.a.d)};N.a.d.I=function(a,b){N.a.g.I(a,b,N.a.d)};N.a.d.J=function(a,b){N.a.g.J(a,b,N.a.d)};N.a.d.T=function(a,b){N.a.g.T(a,b,N.a.d)};N.a.d.Fa=function(a,b){return N.a.Oa.create(a,b)};N.a.d.create=function(a){return N.a.g.create("polygon",N.a.d.className,a)};
N.a.Oa=function(){};N.a.Oa.create=function(a){for(var b=N.a.ja(a),c=N.a.P.create(),d=0,f=b.length;d<f;d++)a=N.a.k.create(b[d]),R(c,a);return c};N.a.X=function(){};N.a.X.Ia=function(a){return 0===a.length};N.a.X.Ja=function(a){return"xrx-shape-endpoint"===a.getAttribute("class")};
N.a.X.Ya=function(a,b){var c=[a.clientX,a.clientY],d=Array(2);Q(b.h.B).transform(c,0,d,0,1);var c=b.C,f=S(c.l);if(N.a.X.Ja(a.target)){var g=N.a.ja(f[0]),d=N.a.d.create();N.a.d.Q(d,g);R(b.O.l,d);U(c)}else N.a.X.Ia(f)?(g=N.a.g.create("polyline","xrx-shape-polyline",{points:d}),R(c.l,g),d=N.a.R.create({cx:d[0],cy:d[1],r:"4",style:"fill:white;stroke:black;stroke-width:1","class":"xrx-shape-endpoint"}),R(c.l,d)):(g=N.a.ja(f[0]),N.aa.Ma.Wa(g[g.length-1],d)||(g=g.concat([d]),N.a.d.Q(f[0],g)))};
N.a.PolygonCreate=N.a.X;N.a.f=function(){};N.a.f.className="xrx-shape-rect";N.a.f.S=N.a.d.S;N.a.f.Q=N.a.d.Q;N.a.f.ha=N.a.d.ha;N.a.f.H=function(a,b){N.a.g.H(a,b,N.a.f)};N.a.f.I=function(a,b){N.a.g.I(a,b,N.a.f)};N.a.f.J=function(a,b){N.a.g.J(a,b,N.a.f)};N.a.f.T=function(a,b){N.a.g.T(a,b,N.a.f)};N.a.f.Fa=function(a,b){return N.a.Pa.create(a,b)};N.a.f.vb=function(a,b){var c=a[b][0],d=a[b][1];0===b?(a[1][1]=d,a[3][0]=c):1===b?(a[0][1]=d,a[2][0]=c):2===b?(a[1][0]=c,a[3][1]=d):(a[0][0]=c,a[2][1]=d);return a};
N.a.f.create=function(a){return N.a.g.create("polygon",N.a.f.className,a)};N.a.Pa=function(){};N.a.Pa.create=function(a){for(var b=N.a.P.create(),c=N.a.f.S(a),d=0,f=c.length;d<f;d++)a=N.a.k.create([c[d][0],c[d][1]]),R(b,a);return b};N.a.Y=function(){};N.a.Y.Ia=function(a){return 0===a.length};N.a.Y.Ja=function(a){return!N.a.Y.Ia(a)};
N.a.Y.Ya=function(a,b){var c=[a.clientX,a.clientY],d=Array(2);Q(b.h.B).transform(c,0,d,0,1);var c=b.C,f=S(c.l);N.a.Y.Ja(f)?(f=N.a.ja(f[0]),f.push(d[0],f[0][1]),f.push(d),f.push(f[0][0],d[1]),f=N.a.f.create({points:f}),R(b.O.l,f),U(c)):(f=N.a.f.create({points:d}),R(c.l,f),d=N.a.R.create({cx:d[0],cy:d[1],r:"4",style:"fill:white;stroke:black;stroke-width:1","class":"xrx-shape-endpoint"}),R(c.l,d))};N.a.RectCreate=N.a.Y;N.a.da=function(){};N.a.da.tagName="image";N.a.da.cb=function(){};N.a.da.create=function(a){return N.a.c.create(N.a.da,a)};N.aa.Hb=function(){};N.canvas.e=function(){};N.canvas.e.lb=function(a){a.L(a.h.B.scale(1.05,1.05))};N.canvas.e.mb=function(a){a.L(a.h.B.scale(.95,.95))};N.canvas.e.Ca=function(a){a.K="pan";a.Ha.F.N();U(a.s);U(a.C)};N.canvas.e.Cb=function(a,b){!1===a?N.canvas.e.Ca(b):(b.K="delete",b.O.F.N(),U(b.s),U(b.C))};N.canvas.e.Db=function(a,b){!1===a?N.canvas.e.Ca(b):(b.K="modify",b.O.F.N(),U(b.s),U(b.C))};
N.canvas.e.jb=function(a,b,c){!1===a?N.canvas.e.Ca(b):(b.C.F.N(),U(b.s),U(b.C),b.Ta.shape=b.q[c],b.Va&&M(b.Va),b.Va=K(b.C.w(),"click",function(a){b.Ta.shape.Ya(a,b)}))};N.canvas.e.Bb=function(a){a.L(a.h.B.rotate(-90*Math.PI/180,a.h.fa[0],a.h.fa[1]))};N.canvas.e.ib=function(a){a.L(a.h.B.rotate(90*Math.PI/180,a.h.fa[0],a.h.fa[1]))};N.canvas.Ib={};function vb(a,b){this.b=a;this.i=b;this.Z()}vb.prototype.T=function(a){var b,c,d=0;c=S(this.b);b=N.canvas.j.className;if(y(O(a.target.parentNode),b)){for(var f=0,g=c.length;f<g;f++)b=T(c[f]),b!==a.target&&N.canvas.j.na(b,!1);(c=y(O(a.target),"xrx-ui-state-selected"))?N.canvas.j.na(a.target,!1):(N.canvas.j.na(a.target),d+=1);0===d&&N.canvas.j.na(T(T(this.b)))}};
vb.prototype.Z=function(){function a(a,b,d){K(a,"click",function(a){y(O(a.target),"xrx-ui-state-selected")?b(!0,c.i,d):b(!1,c.i,d)})}function b(a,b){K(a,"click",function(){b(c.i)})}var c=this;K(this.b,"click",function(a){c.T(a)},!0);var d=N.canvas.j.create("./res/openhand.png","Zoom, Pan or Rotate the Canvas.");b(d,N.canvas.e.Ca);var f=N.canvas.v.create("./res/zoomIn.png","Zoom In.");b(f,N.canvas.e.lb);var g=N.canvas.v.create("./res/zoomOut.png","Zoom Out.");b(g,N.canvas.e.mb);var h=N.canvas.v.create("./res/rotateLeft.png",
"Rotate Left.");b(h,N.canvas.e.Bb);var k=N.canvas.v.create("./res/rotateRight.png","Rotate Right.");b(k,N.canvas.e.ib);var q=N.canvas.j.create("./res/shapeRect.png","Draw a Rect.");a(q,N.canvas.e.jb,"RectCreate");var v=N.canvas.j.create("./res/shapePolygon.png","Draw a Polygon.");a(v,N.canvas.e.jb,"PolygonCreate");var r=N.canvas.j.create("./res/move.png","Move or Modify a Shape.");a(r,N.canvas.e.Db);var n=N.canvas.j.create("./res/delete.png","Delete a Shape.");a(n,N.canvas.e.Cb);R(this.b,d);R(this.b,
f);R(this.b,g);R(this.b,h);R(this.b,k);R(this.b,q);R(this.b,v);R(this.b,r);R(this.b,n);N.canvas.j.na(T(T(this.b)));return this.b};N.canvas.v=function(){};N.canvas.v.className="xrx-canvas-toolbar-button";N.canvas.v.va=function(a){kb(a.target,"xrx-ui-state-mouseout","xrx-ui-state-mouseover")};N.canvas.v.ua=function(a){kb(a.target,"xrx-ui-state-mouseover","xrx-ui-state-mouseout")};
N.canvas.v.create=function(a,b){var c=document.createElement("span");c.className=N.canvas.v.className;var d=document.createElement("img");d.setAttribute("src",a);d.setAttribute("title",b);d.className="xrx-ui-state-mouseout";R(c,d);K(c,"mouseover",function(a){N.canvas.v.va(a)});K(c,"mouseout",function(a){N.canvas.v.ua(a)});return c};N.canvas.j=function(){};N.canvas.j.className="xrx-canvas-toolbar-toggle";N.canvas.j.na=function(a,b){!1===b?ib(a,"xrx-ui-state-selected"):gb(a,"xrx-ui-state-selected")};
N.canvas.j.va=N.canvas.v.va;N.canvas.j.ua=N.canvas.v.ua;N.canvas.j.create=function(a,b){var c=document.createElement("span");c.className=N.canvas.j.className;var d=document.createElement("img");d.setAttribute("src",a);d.setAttribute("title",b);d.className="xrx-ui-state-mouseout";R(c,d);K(c,"mouseover",function(a){N.canvas.j.va(a)});K(c,"mouseout",function(a){N.canvas.j.ua(a)});return c};function V(a){H.call(this);this.ka=a;this.$a={}}u(V,H);var wb=[];V.prototype.Ka=function(a,b,c,d){p(b)||(b&&(wb[0]=b.toString()),b=wb);for(var f=0;f<b.length;f++){var g=K(a,b[f],c||this.handleEvent,d||!1,this.ka||this);if(!g)break;this.$a[g.key]=g}return this};
V.prototype.Ea=function(a,b,c,d,f){if(p(b))for(var g=0;g<b.length;g++)this.Ea(a,b[g],c,d,f);else c=c||this.handleEvent,f=f||this.ka||this,c=Za(c),d=!!d,b=a&&a[w]?a.ia(b,c,d,f):a?(a=L(a))?a.ia(b,c,d,f):null:null,b&&(M(b),delete this.$a[b.key]);return this};V.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function W(){H.call(this);this.$=new z(this);this.pb=this}u(W,H);W.prototype[w]=!0;e=W.prototype;e.fb=null;e.addEventListener=function(a,b,c,d){K(this,a,b,c,d)};e.removeEventListener=function(a,b,c,d){cb(this,a,b,c,d)};
e.dispatchEvent=function(a){var b,c=this.fb;if(c)for(b=[];c;c=c.fb)b.push(c);var c=this.pb,d=a.type||a;if(s(a))a=new I(a,c);else if(a instanceof I)a.target=a.target||c;else{var f=a;a=new I(d,c);xa(a,f)}var f=!0,g;if(b)for(var h=b.length-1;!a.ba&&0<=h;h--)g=a.currentTarget=b[h],f=xb(g,d,!0,a)&&f;a.ba||(g=a.currentTarget=c,f=xb(g,d,!0,a)&&f,a.ba||(f=xb(g,d,!1,a)&&f));if(b)for(h=0;!a.ba&&h<b.length;h++)g=a.currentTarget=b[h],f=xb(g,d,!1,a)&&f;return f};
e.Ka=function(a,b,c,d){return this.$.add(String(a),b,!1,c,d)};e.Ea=function(a,b,c,d){return this.$.remove(String(a),b,c,d)};function xb(a,b,c,d){b=a.$.A[String(b)];if(!b)return!0;b=b.concat();for(var f=!0,g=0;g<b.length;++g){var h=b[g];if(h&&!h.ca&&h.ra==c){var k=h.U,q=h.wa||h.src;h.qa&&Fa(a.$,h);f=!1!==k.call(q,d)&&f}}return f&&!1!=d.hb}e.ia=function(a,b,c,d){return this.$.ia(String(a),b,c,d)};function yb(a){W.call(this);this.ya={};this.xa={};this.ka=new V(this);this.gb=a}u(yb,W);var zb=[C&&!G("11")?"readystatechange":"load","abort","error"];function Ab(a){var b=s("../data/SachsenspiegelHeidelberg/Bilder-34553-28167-1600.jpg")?"../data/SachsenspiegelHeidelberg/Bilder-34553-28167-1600.jpg":"../data/SachsenspiegelHeidelberg/Bilder-34553-28167-1600.jpg".src;b&&(a.ya.xrxImage={src:b,Sa:null})}
yb.prototype.start=function(){var a=this.ya;za(ua(a),function(b){var c=a[b];if(c&&(delete a[b],!this.Ua)){var d;this.gb?(d=this.gb,d=(d?new tb(sb(d)):ga||(ga=new tb)).qb("img")):d=new Image;c.Sa&&(d.crossOrigin=c.Sa);this.ka.Ka(d,zb,this.eb);this.xa[b]=d;d.id=b;d.src=c.src}},this)};
yb.prototype.eb=function(a){var b=a.currentTarget;if(b){if("readystatechange"==a.type)if("complete"==b.readyState)a.type="load";else return;"undefined"==typeof b.naturalWidth&&("load"==a.type?(b.naturalWidth=b.width,b.naturalHeight=b.height):(b.naturalWidth=0,b.naturalHeight=0));this.dispatchEvent({type:a.type,target:b});!this.Ua&&(a=b.id,delete this.ya[a],b=this.xa[a])&&(delete this.xa[a],this.ka.Ea(b,zb,this.eb),va(this.xa)&&va(this.ya)&&this.dispatchEvent("complete"))}};function X(a){this.i=a;this.Z()}X.prototype.w=function(){return this.b};X.prototype.N=function(){var a;a=this.i;a=[a.Ha,a.O,a.s,a.C];for(var b=0,c=a.length;b<c;b++){var d=a[b].F;d.b.setAttribute("width","0px");d.b.setAttribute("height","0px")}this.b.setAttribute("width","100%");this.b.setAttribute("height","100%")};X.prototype.Z=function(){var a=this.i.q,b=a.c.sa("rect");a.c.ma(b,{width:"0px",height:"0px",style:"fill-opacity:0.0","class":"xrx-canvas-shield"});this.b=b};N.canvas.M=function(){};N.canvas.M.yb=function(a,b){N.canvas.e.ib(b)};N.canvas.M.H=function(a,b){if("pan"===b.K){var c=[a.clientX,a.clientY],d=new P;b.oa||(b.oa=Array(2));Q(d).transform(c,0,b.oa,0,1);b.state="drag"}};N.canvas.M.I=function(a,b){if("pan"===b.K&&"drag"===b.state){var c=Array(2),d=[a.clientX,a.clientY],f=new P;Q(f).transform(d,0,c,0,1);b.h.B=lb(f.translate(c[0]-b.oa[0],c[1]-b.oa[1]),b.h.B);b.L(b.h.B);b.oa=c}};N.canvas.M.J=function(a,b){"pan"===b.K&&(b.state="none")};
N.canvas.M.zb=function(a,b){0>a.ub?N.canvas.e.lb(b):N.canvas.e.mb(b)};function Bb(a,b){W.call(this);var c=this.b=a;if(c=da(c)&&1==c.nodeType?this.b:this.b?this.b.body:null){var d=sb(c);d.defaultView&&d.defaultView.getComputedStyle&&(c=d.defaultView.getComputedStyle(c,null))&&(c.direction||c.getPropertyValue("direction"))}K(this.b,D?"DOMMouseScroll":"mousewheel",this,b)}u(Bb,W);
Bb.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.Ga;if("mousewheel"==a.type){c=1;if(C||E&&(Ja||G("532.0")))c=40;d=Cb(-a.wheelDelta,c);void 0!==a.wheelDeltaX?(b=Cb(-a.wheelDeltaX,c),c=Cb(-a.wheelDeltaY,c)):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),void 0!==a.axis&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;if(t(this.ab)){var f=this.ab;Math.min(Math.max(b,-this.ab),f)}t(this.bb)&&(b=this.bb,c=Math.min(Math.max(c,-this.bb),b));d=new Db(d,a,0,c);this.dispatchEvent(d)};
function Cb(a,b){return E&&(Ia||Ma)&&0!=a%b?a:a/b}function Db(a,b,c,d){J.call(this,b);this.type="mousewheel";this.detail=a;this.ub=d}u(Db,J);function Y(a){this.i=a;this.b;this.l;this.F;this.Z();this.Ba()}Y.prototype.w=function(){return this.b};function U(a){a=a.l;for(var b;b=a.firstChild;)a.removeChild(b)}Y.prototype.handleEvent=function(a,b){a.preventDefault();b(a,this.i)};function Z(a,b,c){K(b,["mousedown","touchstart"],function(b){a.handleEvent(b,c.H)});K(b,["mousemove","touchmove"],function(b){a.handleEvent(b,c.I)});K(b,["mouseup","touchend"],function(b){a.handleEvent(b,c.J)})}
function Eb(a,b){var c=N.canvas.M,d=new Bb(b);K(d,"mousewheel",function(b){a.handleEvent(b,c.zb)})}function Fb(a,b){var c=N.canvas.M;K(b,["dblclick"],function(b){a.handleEvent(b,c.yb)})}function Gb(a,b,c){K(b,["click"],function(b){a.handleEvent(b,c.T)})}Y.prototype.Z=function(){var a=this.i.q;this.b=a.P.create();this.l=a.P.create();this.F=new X(this.i);R(this.b,this.F.w());R(this.b,this.l);return this.b};function Hb(a){Y.call(this,a)}u(Hb,Y);Hb.prototype.Z=function(){var a=this.i.q,b=this.i.D.object;this.b=a.P.create();var c=a.c.sa("rect");a.c.ma(c,{width:"100%",height:"100%"});R(this.b,c);console.log();a=this.i.D.element=a.da.create({"xlink:href":b.getAttribute("src"),width:b.naturalWidth,height:b.naturalHeight});R(this.b,a);this.F=new X(this.i);R(this.b,this.F.w())};Hb.prototype.Ba=function(){Eb(this,this.b);Z(this,this.b,N.canvas.M);Fb(this,this.b)};function Ib(a){Y.call(this,a)}u(Ib,Y);Ib.prototype.update=function(a){this.i.la.shape.Q(this.i.la.element,a)};Ib.prototype.Ba=function(){var a=this.i.q;Eb(this,this.b);Z(this,this.b,N.canvas.M);Z(this,this.b,a.f);Z(this,this.b,a.d);Fb(this,this.b);Gb(this,this.b,a.f);Gb(this,this.b,a.d)};function N(){}aa("xrx",N);function $(a){Y.call(this,a)}u($,Y);$.prototype.N=function(a){var b=this.l,c=b.parentNode;c&&c.replaceChild(a,b);this.l=a};$.prototype.update=function(a,b){for(var c=this.i.q,d=S(this.l),f=0,g=d.length;f<g;f++)f!=b&&c.k.Q(d[f],[a[f]])};$.prototype.Ba=function(){var a=this.i.q;Eb(this,this.b);Z(this,this.b,a.k);Fb(this,this.b)};function Jb(a){Y.call(this,a)}u(Jb,Y);Jb.prototype.Ba=function(){Eb(this,this.b);Fb(this,this.b)};function Kb(a,b){this.q=b||ba("xrx."+N.aa.nb.ob);this.b=a;this.state="none";this.K="pan";this.la={shape:null,element:null};this.G={element:null,La:null,coords:null};this.Ta={shape:null};this.D={object:null,element:null};this.h={fa:null,B:new P,ea:{x:0,y:0,V:0,W:0,width:0,height:0}};Lb(this)}function ub(a){a.G.La||(a.G.La=Array(2));return a.G.La}Kb.prototype.w=function(){return this.b};Kb.prototype.Xa=function(){return this.q.Xa(this.D.element)};
Kb.prototype.L=function(a){this.q.L(this.D.element,a);this.q.L(this.O.w(),a);this.q.L(this.s.w(),a);this.q.L(this.C.w(),a)};
function Lb(a){var b=new yb;K(b,"load",function(b){a.D.object=b.target;a.ga=a.q.pa.create({width:"100%",height:"100%"});R(a.b,a.ga);a.Ha=new Hb(a);R(a.ga,a.Ha.w());a.O=new Ib(a);R(a.ga,a.O.w());a.s=new $(a);R(a.ga,a.s.w());a.C=new Jb(a);R(a.ga,a.C.w());a.h.fa=[a.D.object.naturalWidth/2,a.D.object.naturalHeight/2];a.h.ea.V=a.D.object.naturalWidth;a.h.ea.W=a.D.object.naturalHeight;a.h.ea.width=a.D.object.naturalWidth;a.h.ea.height=a.D.object.naturalHeight});Ab(b);b.start()};N.kb={};N.kb.Ab=function(){var a=ob(document,"toolbar"),b=new Kb(ob(document,"stn"));new vb(a,b);return!0};aa("xrx.stn.install",N.kb.Ab);
