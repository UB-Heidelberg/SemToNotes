var xrx=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){var n=n||{};n.global=this,n.global.CLOSURE_UNCOMPILED_DEFINES,n.global.CLOSURE_DEFINES,n.isDef=function(e){return void 0!==e},n.exportPath_=function(e,t,r){var i=e.split("."),o=r||n.global;i[0]in o||!o.execScript||o.execScript("var "+i[0]);for(var s;i.length&&(s=i.shift());)!i.length&&n.isDef(t)?o[s]=t:o=o[s]?o[s]:o[s]={}},n.define=function(e,t){var r=t;n.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(n.global.CLOSURE_UNCOMPILED_DEFINES,e)?r=n.global.CLOSURE_UNCOMPILED_DEFINES[e]:n.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(n.global.CLOSURE_DEFINES,e)&&(r=n.global.CLOSURE_DEFINES[e]),n.exportPath_(e,r)},n.DEBUG=!0,n.define("goog.LOCALE","en"),n.define("goog.TRUSTED_SITE",!0),n.define("goog.STRICT_MODE_COMPATIBLE",!1),n.provide=function(e){if(n.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete n.implicitNamespaces_[e];for(var t=e;(t=t.substring(0,t.lastIndexOf(".")))&&!n.getObjectByName(t);)n.implicitNamespaces_[t]=!0;n.exportPath_(e)},n.setTestOnly=function(e){},n.forwardDeclare=function(e){},n.isProvided_=function(e){return!n.implicitNamespaces_[e]&&n.isDefAndNotNull(n.getObjectByName(e))},n.implicitNamespaces_={},n.getObjectByName=function(e,t){for(var r,i=e.split("."),o=t||n.global;r=i.shift();){if(!n.isDefAndNotNull(o[r]))return null;o=o[r]}return o},n.globalize=function(e,t){var r=t||n.global;for(var i in e)r[i]=e[i]},n.addDependency=function(e,t,r){if(n.DEPENDENCIES_ENABLED){for(var i,o,s=e.replace(/\\/g,"/"),a=n.dependencies_,l=0;i=t[l];l++)a.nameToPath[i]=s,s in a.pathToNames||(a.pathToNames[s]={}),a.pathToNames[s][i]=!0;for(var h=0;o=r[h];h++)s in a.requires||(a.requires[s]={}),a.requires[s][o]=!0}},n.define("goog.ENABLE_DEBUG_LOADER",!0),n.require=function(e){if(!n.isProvided_(e)){if(n.ENABLE_DEBUG_LOADER){var t=n.getPathFromDeps_(e);if(t)return n.included_[t]=!0,void n.writeScripts_()}var r="goog.require could not find: "+e;throw n.global.console&&n.global.console.error(r),Error(r)}},n.basePath="",n.global.CLOSURE_BASE_PATH,n.global.CLOSURE_NO_DEPS,n.global.CLOSURE_IMPORT_SCRIPT,n.nullFunction=function(){},n.identityFunction=function(e,t){return e},n.abstractMethod=function(){throw Error("unimplemented abstract method")},n.addSingletonGetter=function(e){e.getInstance=function(){return e.instance_?e.instance_:(n.DEBUG&&(n.instantiatedSingletons_[n.instantiatedSingletons_.length]=e),e.instance_=new e)}},n.instantiatedSingletons_=[],n.DEPENDENCIES_ENABLED=n.ENABLE_DEBUG_LOADER,n.DEPENDENCIES_ENABLED&&(n.included_={},n.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},n.inHtmlDocument_=function(){var e=n.global.document;return void 0!==e&&"write"in e},n.findBasePath_=function(){if(n.global.CLOSURE_BASE_PATH)return void(n.basePath=n.global.CLOSURE_BASE_PATH);if(n.inHtmlDocument_())for(var e=n.global.document,t=e.getElementsByTagName("script"),r=t.length-1;r>=0;--r){var i=t[r].src,o=i.lastIndexOf("?"),s=-1==o?i.length:o;if("base.js"==i.substr(s-7,7))return void(n.basePath=i.substr(0,s-7))}},n.importScript_=function(e){var t=n.global.CLOSURE_IMPORT_SCRIPT||n.writeScriptTag_;!n.dependencies_.written[e]&&t(e)&&(n.dependencies_.written[e]=!0)},n.writeScriptTag_=function(e){if(n.inHtmlDocument_()){var t=n.global.document;if("complete"==t.readyState){if(/\bdeps.js$/.test(e))return!1;throw Error('Cannot write "'+e+'" after document load')}return t.write('<script type="text/javascript" src="'+e+'"><\/script>'),!0}return!1},n.writeScripts_=function(){function e(o){if(!(o in i.written)){if(o in i.visited)return void(o in r||(r[o]=!0,t.push(o)));if(i.visited[o]=!0,o in i.requires)for(var s in i.requires[o])if(!n.isProvided_(s)){if(!(s in i.nameToPath))throw Error("Undefined nameToPath for "+s);e(i.nameToPath[s])}o in r||(r[o]=!0,t.push(o))}}var t=[],r={},i=n.dependencies_;for(var o in n.included_)i.written[o]||e(o);for(var s=0;s<t.length;s++){if(!t[s])throw Error("Undefined script input");n.importScript_(n.basePath+t[s])}},n.getPathFromDeps_=function(e){return e in n.dependencies_.nameToPath?n.dependencies_.nameToPath[e]:null},n.findBasePath_(),n.global.CLOSURE_NO_DEPS||n.importScript_(n.basePath+"deps.js")),n.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var r=Object.prototype.toString.call(e);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t},n.isNull=function(e){return null===e},n.isDefAndNotNull=function(e){return null!=e},n.isArray=function(e){return"array"==n.typeOf(e)},n.isArrayLike=function(e){var t=n.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},n.isDateLike=function(e){return n.isObject(e)&&"function"==typeof e.getFullYear},n.isString=function(e){return"string"==typeof e},n.isBoolean=function(e){return"boolean"==typeof e},n.isNumber=function(e){return"number"==typeof e},n.isFunction=function(e){return"function"==n.typeOf(e)},n.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},n.getUid=function(e){return e[n.UID_PROPERTY_]||(e[n.UID_PROPERTY_]=++n.uidCounter_)},n.hasUid=function(e){return!!e[n.UID_PROPERTY_]},n.removeUid=function(e){"removeAttribute"in e&&e.removeAttribute(n.UID_PROPERTY_);try{delete e[n.UID_PROPERTY_]}catch(e){}},n.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),n.uidCounter_=0,n.getHashCode=n.getUid,n.removeHashCode=n.removeUid,n.cloneObject=function(e){var t=n.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();var r="array"==t?[]:{};for(var i in e)r[i]=n.cloneObject(e[i]);return r}return e},n.bindNative_=function(e,t,r){return e.call.apply(e.bind,arguments)},n.bindJs_=function(e,t,r){if(!e)throw new Error;if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}},n.bind=function(e,t,r){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?n.bind=n.bindNative_:n.bind=n.bindJs_,n.bind.apply(null,arguments)},n.partial=function(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}},n.mixin=function(e,t){for(var r in t)e[r]=t[r]},n.now=n.TRUSTED_SITE&&Date.now||function(){return+new Date},n.globalEval=function(e){if(n.global.execScript)n.global.execScript(e,"JavaScript");else{if(!n.global.eval)throw Error("goog.globalEval not available");if(null==n.evalWorksForGlobals_&&(n.global.eval("var _et_ = 1;"),void 0!==n.global._et_?(delete n.global._et_,n.evalWorksForGlobals_=!0):n.evalWorksForGlobals_=!1),n.evalWorksForGlobals_)n.global.eval(e);else{var t=n.global.document,r=t.createElement("script");r.type="text/javascript",r.defer=!1,r.appendChild(t.createTextNode(e)),t.body.appendChild(r),t.body.removeChild(r)}}},n.evalWorksForGlobals_=null,n.cssNameMapping_,n.cssNameMappingStyle_,n.getCssName=function(e,t){var r,i=function(e){return n.cssNameMapping_[e]||e},o=function(e){for(var t=e.split("-"),r=[],n=0;n<t.length;n++)r.push(i(t[n]));return r.join("-")};return r=n.cssNameMapping_?"BY_WHOLE"==n.cssNameMappingStyle_?i:o:function(e){return e},t?e+"-"+r(t):r(e)},n.setCssNameMapping=function(e,t){n.cssNameMapping_=e,n.cssNameMappingStyle_=t},n.global.CLOSURE_CSS_NAME_MAPPING,n.global.CLOSURE_CSS_NAME_MAPPING&&(n.cssNameMapping_=n.global.CLOSURE_CSS_NAME_MAPPING),n.getMsg=function(e,t){var r=t||{};for(var n in r){var i=(""+r[n]).replace(/\$/g,"$$$$");e=e.replace(new RegExp("\\{\\$"+n+"\\}","gi"),i)}return e},n.getMsgWithFallback=function(e,t){return e},n.exportSymbol=function(e,t,r){n.exportPath_(e,t,r)},n.exportProperty=function(e,t,r){e[t]=r},n.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.base=function(e,r,n){var i=Array.prototype.slice.call(arguments,2);return t.prototype[r].apply(e,i)}},n.base=function(e,t,r){var i=arguments.callee.caller;if(n.STRICT_MODE_COMPATIBLE||n.DEBUG&&!i)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(i.superClass_)return i.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1));for(var o=Array.prototype.slice.call(arguments,2),s=!1,a=e.constructor;a;a=a.superClass_&&a.superClass_.constructor)if(a.prototype[t]===i)s=!0;else if(s)return a.prototype[t].apply(e,o);if(e[t]===i)return e.constructor.prototype[t].apply(e,o);throw Error("goog.base called from a method of one name to a method of a different name")},n.scope=function(e){e.call(n.global)},n.global.COMPILED=!1,n.provide("xrx.drawing"),n.provide("xrx.drawing.EventType"),n.provide("xrx.drawing.Orientation"),n.provide("xrx.drawing.Position"),n.provide("xrx.drawing.Mode"),n.provide("xrx.drawing.State"),xrx.drawing=function(){},xrx.drawing.State={DRAG:1,NONE:2},xrx.drawing.Mode={VIEW:1,MODIFY:2,DELETE:3,CREATE:4,DISABLED:5,SELECT:6,HOVER:7,HOVERMULTIPLE:8},xrx.drawing.Orientation={C:"C",NE:"NE",SE:"SE",SW:"SW",NW:"NW"},xrx.drawing.Position={NE:"NE",SE:"SE",SW:"SW",NW:"NW"},xrx.drawing.EventType={VIEWBOX_CHANGE:"eventViewboxChange",SHAPE_MODIFY:"eventShapeModify",SHAPE_CREATED:"eventShapeCreated",SHAPE_SELECTED:"eventShapeSelected",SHAPE_HOVER_IN:"eventShapeHoverIn",SHAPE_HOVER_MOVE:"eventShapeHoverMove",SHAPE_HOVER_OUT:"eventShapeHoverOut",SHAPE_BEFORE_DRAW:"eventShapeBeforeDraw"},n.provide("goog.object"),n.object.forEach=function(e,t,r){for(var n in e)t.call(r,e[n],n,e)},n.object.filter=function(e,t,r){var n={};for(var i in e)t.call(r,e[i],i,e)&&(n[i]=e[i]);return n},n.object.map=function(e,t,r){var n={};for(var i in e)n[i]=t.call(r,e[i],i,e);return n},n.object.some=function(e,t,r){for(var n in e)if(t.call(r,e[n],n,e))return!0;return!1},n.object.every=function(e,t,r){for(var n in e)if(!t.call(r,e[n],n,e))return!1;return!0},n.object.getCount=function(e){var t=0;for(var r in e)t++;return t},n.object.getAnyKey=function(e){for(var t in e)return t},n.object.getAnyValue=function(e){for(var t in e)return e[t]},n.object.contains=function(e,t){return n.object.containsValue(e,t)},n.object.getValues=function(e){var t=[],r=0;for(var n in e)t[r++]=e[n];return t},n.object.getKeys=function(e){var t=[],r=0;for(var n in e)t[r++]=n;return t},n.object.getValueByKeys=function(e,t){for(var r=n.isArrayLike(t),i=r?t:arguments,o=r?0:1;o<i.length&&(e=e[i[o]],n.isDef(e));o++);return e},n.object.containsKey=function(e,t){return t in e},n.object.containsValue=function(e,t){for(var r in e)if(e[r]==t)return!0;return!1},n.object.findKey=function(e,t,r){for(var n in e)if(t.call(r,e[n],n,e))return n},n.object.findValue=function(e,t,r){var i=n.object.findKey(e,t,r);return i&&e[i]},n.object.isEmpty=function(e){for(var t in e)return!1;return!0},n.object.clear=function(e){for(var t in e)delete e[t]},n.object.remove=function(e,t){var r;return(r=t in e)&&delete e[t],r},n.object.add=function(e,t,r){if(t in e)throw Error('The object already contains the key "'+t+'"');n.object.set(e,t,r)},n.object.get=function(e,t,r){return t in e?e[t]:r},n.object.set=function(e,t,r){e[t]=r},n.object.setIfUndefined=function(e,t,r){return t in e?e[t]:e[t]=r},n.object.clone=function(e){var t={};for(var r in e)t[r]=e[r];return t},n.object.unsafeClone=function(e){var t=n.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();var r="array"==t?[]:{};for(var i in e)r[i]=n.object.unsafeClone(e[i]);return r}return e},n.object.transpose=function(e){var t={};for(var r in e)t[e[r]]=r;return t},n.object.PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],n.object.extend=function(e,t){for(var r,i,o=1;o<arguments.length;o++){i=arguments[o];for(r in i)e[r]=i[r];for(var s=0;s<n.object.PROTOTYPE_FIELDS_.length;s++)r=n.object.PROTOTYPE_FIELDS_[s],Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}},n.object.create=function(e){var t=arguments.length;if(1==t&&n.isArray(arguments[0]))return n.object.create.apply(null,arguments[0]);if(t%2)throw Error("Uneven number of arguments");for(var r={},i=0;i<t;i+=2)r[arguments[i]]=arguments[i+1];return r},n.object.createSet=function(e){var t=arguments.length;if(1==t&&n.isArray(arguments[0]))return n.object.createSet.apply(null,arguments[0]);for(var r={},i=0;i<t;i++)r[arguments[i]]=!0;return r},n.object.createImmutableView=function(e){var t=e;return Object.isFrozen&&!Object.isFrozen(e)&&(t=Object.create(e),Object.freeze(t)),t},n.object.isImmutableView=function(e){return!!Object.isFrozen&&Object.isFrozen(e)},n.provide("goog.string"),n.provide("goog.string.Unicode"),n.define("goog.string.DETECT_DOUBLE_ESCAPING",!1),n.string.Unicode={NBSP:" "},n.string.startsWith=function(e,t){return 0==e.lastIndexOf(t,0)},n.string.endsWith=function(e,t){var r=e.length-t.length;return r>=0&&e.indexOf(t,r)==r},n.string.caseInsensitiveStartsWith=function(e,t){return 0==n.string.caseInsensitiveCompare(t,e.substr(0,t.length))},n.string.caseInsensitiveEndsWith=function(e,t){return 0==n.string.caseInsensitiveCompare(t,e.substr(e.length-t.length,t.length))},n.string.caseInsensitiveEquals=function(e,t){return e.toLowerCase()==t.toLowerCase()},n.string.subs=function(e,t){for(var r=e.split("%s"),n="",i=Array.prototype.slice.call(arguments,1);i.length&&r.length>1;)n+=r.shift()+i.shift();return n+r.join("%s")},n.string.collapseWhitespace=function(e){return e.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},n.string.isEmpty=function(e){return/^[\s\xa0]*$/.test(e)},n.string.isEmptySafe=function(e){return n.string.isEmpty(n.string.makeSafe(e))},n.string.isBreakingWhitespace=function(e){return!/[^\t\n\r ]/.test(e)},n.string.isAlpha=function(e){return!/[^a-zA-Z]/.test(e)},n.string.isNumeric=function(e){return!/[^0-9]/.test(e)},n.string.isAlphaNumeric=function(e){return!/[^a-zA-Z0-9]/.test(e)},n.string.isSpace=function(e){return" "==e},n.string.isUnicodeChar=function(e){return 1==e.length&&e>=" "&&e<="~"||e>=""&&e<="�"},n.string.stripNewlines=function(e){return e.replace(/(\r\n|\r|\n)+/g," ")},n.string.canonicalizeNewlines=function(e){return e.replace(/(\r\n|\r|\n)/g,"\n")},n.string.normalizeWhitespace=function(e){return e.replace(/\xa0|\s/g," ")},n.string.normalizeSpaces=function(e){return e.replace(/\xa0|[ \t]+/g," ")},n.string.collapseBreakingSpaces=function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")},n.string.trim=function(e){return e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},n.string.trimLeft=function(e){return e.replace(/^[\s\xa0]+/,"")},n.string.trimRight=function(e){return e.replace(/[\s\xa0]+$/,"")},n.string.caseInsensitiveCompare=function(e,t){var r=String(e).toLowerCase(),n=String(t).toLowerCase();return r<n?-1:r==n?0:1},n.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g,n.string.numerateCompare=function(e,t){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var r=e.toLowerCase().match(n.string.numerateCompareRegExp_),i=t.toLowerCase().match(n.string.numerateCompareRegExp_),o=Math.min(r.length,i.length),s=0;s<o;s++){var a=r[s],l=i[s];if(a!=l){var h=parseInt(a,10);if(!isNaN(h)){var p=parseInt(l,10);if(!isNaN(p)&&h-p)return h-p}return a<l?-1:1}}return r.length!=i.length?r.length-i.length:e<t?-1:1},n.string.urlEncode=function(e){return encodeURIComponent(String(e))},n.string.urlDecode=function(e){return decodeURIComponent(e.replace(/\+/g," "))},n.string.newLineToBr=function(e,t){return e.replace(/(\r\n|\r|\n)/g,t?"<br />":"<br>")},n.string.htmlEscape=function(e,t){return t?(e=e.replace(n.string.AMP_RE_,"&amp;").replace(n.string.LT_RE_,"&lt;").replace(n.string.GT_RE_,"&gt;").replace(n.string.QUOT_RE_,"&quot;").replace(n.string.SINGLE_QUOTE_RE_,"&#39;").replace(n.string.NULL_RE_,"&#0;"),n.string.DETECT_DOUBLE_ESCAPING&&(e=e.replace(n.string.E_RE_,"&#101;")),e):n.string.ALL_RE_.test(e)?(-1!=e.indexOf("&")&&(e=e.replace(n.string.AMP_RE_,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(n.string.LT_RE_,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(n.string.GT_RE_,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(n.string.QUOT_RE_,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(n.string.SINGLE_QUOTE_RE_,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(n.string.NULL_RE_,"&#0;")),n.string.DETECT_DOUBLE_ESCAPING&&-1!=e.indexOf("e")&&(e=e.replace(n.string.E_RE_,"&#101;")),e):e},n.string.AMP_RE_=/&/g,n.string.LT_RE_=/</g,n.string.GT_RE_=/>/g,n.string.QUOT_RE_=/"/g,n.string.SINGLE_QUOTE_RE_=/'/g,n.string.NULL_RE_=/\x00/g,n.string.E_RE_=/e/g,n.string.ALL_RE_=n.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/,n.string.unescapeEntities=function(e){return n.string.contains(e,"&")?"document"in n.global?n.string.unescapeEntitiesUsingDom_(e):n.string.unescapePureXmlEntities_(e):e},n.string.unescapeEntitiesWithDocument=function(e,t){return n.string.contains(e,"&")?n.string.unescapeEntitiesUsingDom_(e,t):e},n.string.unescapeEntitiesUsingDom_=function(e,t){var r,i={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};return r=t?t.createElement("div"):n.global.document.createElement("div"),e.replace(n.string.HTML_ENTITY_PATTERN_,function(e,t){var n=i[e];if(n)return n;if("#"==t.charAt(0)){var o=Number("0"+t.substr(1));isNaN(o)||(n=String.fromCharCode(o))}return n||(r.innerHTML=e+" ",n=r.firstChild.nodeValue.slice(0,-1)),i[e]=n})},n.string.unescapePureXmlEntities_=function(e){return e.replace(/&([^;]+);/g,function(e,t){switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==t.charAt(0)){var r=Number("0"+t.substr(1));if(!isNaN(r))return String.fromCharCode(r)}return e}})},n.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g,n.string.whitespaceEscape=function(e,t){return n.string.newLineToBr(e.replace(/  /g," &#160;"),t)},n.string.preserveSpaces=function(e){return e.replace(/(^|[\n ]) /g,"$1"+n.string.Unicode.NBSP)},n.string.stripQuotes=function(e,t){for(var r=t.length,n=0;n<r;n++){var i=1==r?t:t.charAt(n);if(e.charAt(0)==i&&e.charAt(e.length-1)==i)return e.substring(1,e.length-1)}return e},n.string.truncate=function(e,t,r){return r&&(e=n.string.unescapeEntities(e)),e.length>t&&(e=e.substring(0,t-3)+"..."),r&&(e=n.string.htmlEscape(e)),e},n.string.truncateMiddle=function(e,t,r,i){if(r&&(e=n.string.unescapeEntities(e)),i&&e.length>t){i>t&&(i=t);var o=e.length-i,s=t-i;e=e.substring(0,s)+"..."+e.substring(o)}else if(e.length>t){var a=Math.floor(t/2),l=e.length-a;a+=t%2,e=e.substring(0,a)+"..."+e.substring(l)}return r&&(e=n.string.htmlEscape(e)),e},n.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\"},n.string.jsEscapeCache_={"'":"\\'"},n.string.quote=function(e){if(e=String(e),e.quote)return e.quote();for(var t=['"'],r=0;r<e.length;r++){var i=e.charAt(r),o=i.charCodeAt(0);t[r+1]=n.string.specialEscapeChars_[i]||(o>31&&o<127?i:n.string.escapeChar(i))}return t.push('"'),t.join("")},n.string.escapeString=function(e){for(var t=[],r=0;r<e.length;r++)t[r]=n.string.escapeChar(e.charAt(r));return t.join("")},n.string.escapeChar=function(e){if(e in n.string.jsEscapeCache_)return n.string.jsEscapeCache_[e];if(e in n.string.specialEscapeChars_)return n.string.jsEscapeCache_[e]=n.string.specialEscapeChars_[e];var t=e,r=e.charCodeAt(0);return r>31&&r<127?t=e:(r<256?(t="\\x",(r<16||r>256)&&(t+="0")):(t="\\u",r<4096&&(t+="0")),t+=r.toString(16).toUpperCase()),n.string.jsEscapeCache_[e]=t},n.string.toMap=function(e){for(var t={},r=0;r<e.length;r++)t[e.charAt(r)]=!0;return t},n.string.contains=function(e,t){return-1!=e.indexOf(t)},n.string.caseInsensitiveContains=function(e,t){return n.string.contains(e.toLowerCase(),t.toLowerCase())},n.string.countOf=function(e,t){return e&&t?e.split(t).length-1:0},n.string.removeAt=function(e,t,r){var n=e;return t>=0&&t<e.length&&r>0&&(n=e.substr(0,t)+e.substr(t+r,e.length-t-r)),n},n.string.remove=function(e,t){var r=new RegExp(n.string.regExpEscape(t),"");return e.replace(r,"")},n.string.removeAll=function(e,t){var r=new RegExp(n.string.regExpEscape(t),"g");return e.replace(r,"")},n.string.regExpEscape=function(e){return String(e).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},n.string.repeat=function(e,t){return new Array(t+1).join(e)},n.string.padNumber=function(e,t,r){var i=n.isDef(r)?e.toFixed(r):String(e),o=i.indexOf(".");return-1==o&&(o=i.length),n.string.repeat("0",Math.max(0,t-o))+i},n.string.makeSafe=function(e){return null==e?"":String(e)},n.string.buildString=function(e){return Array.prototype.join.call(arguments,"")},n.string.getRandomString=function(){var e=2147483648;return Math.floor(Math.random()*e).toString(36)+Math.abs(Math.floor(Math.random()*e)^n.now()).toString(36)},n.string.compareVersions=function(e,t){for(var r=0,i=n.string.trim(String(e)).split("."),o=n.string.trim(String(t)).split("."),s=Math.max(i.length,o.length),a=0;0==r&&a<s;a++){var l=i[a]||"",h=o[a]||"",p=new RegExp("(\\d*)(\\D*)","g"),g=new RegExp("(\\d*)(\\D*)","g");do{var u=p.exec(l)||["","",""],c=g.exec(h)||["","",""];if(0==u[0].length&&0==c[0].length)break;var d=0==u[1].length?0:parseInt(u[1],10),x=0==c[1].length?0:parseInt(c[1],10);r=n.string.compareElements_(d,x)||n.string.compareElements_(0==u[2].length,0==c[2].length)||n.string.compareElements_(u[2],c[2])}while(0==r)}return r},n.string.compareElements_=function(e,t){return e<t?-1:e>t?1:0},n.string.HASHCODE_MAX_=4294967296,n.string.hashCode=function(e){for(var t=0,r=0;r<e.length;++r)t=31*t+e.charCodeAt(r),t%=n.string.HASHCODE_MAX_;return t},n.string.uniqueStringCounter_=2147483648*Math.random()|0,n.string.createUniqueString=function(){return"goog_"+n.string.uniqueStringCounter_++},n.string.toNumber=function(e){var t=Number(e);return 0==t&&n.string.isEmpty(e)?NaN:t},n.string.isLowerCamelCase=function(e){return/^[a-z]+([A-Z][a-z]*)*$/.test(e)},n.string.isUpperCamelCase=function(e){return/^([A-Z][a-z]*)+$/.test(e)},n.string.toCamelCase=function(e){return String(e).replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()})},n.string.toSelectorCase=function(e){return String(e).replace(/([A-Z])/g,"-$1").toLowerCase()},n.string.toTitleCase=function(e,t){var r=n.isString(t)?n.string.regExpEscape(t):"\\s";r=r?"|["+r+"]+":"";var i=new RegExp("(^"+r+")([a-z])","g");return e.replace(i,function(e,t,r){return t+r.toUpperCase()})},n.string.parseInt=function(e){return isFinite(e)&&(e=String(e)),n.isString(e)?/^\s*-?0x/i.test(e)?parseInt(e,16):parseInt(e,10):NaN},n.string.splitLimit=function(e,t,r){for(var n=e.split(t),i=[];r>0&&n.length;)i.push(n.shift()),r--;return n.length&&i.push(n.join(t)),i},n.provide("goog.labs.userAgent.util"),n.require("goog.string"),n.labs.userAgent.util.getNativeUserAgentString_=function(){var e=n.labs.userAgent.util.getNavigator_();if(e){var t=e.userAgent;if(t)return t}return""},n.labs.userAgent.util.getNavigator_=function(){return n.global.navigator},n.labs.userAgent.util.userAgent_=n.labs.userAgent.util.getNativeUserAgentString_(),n.labs.userAgent.util.setUserAgent=function(e){n.labs.userAgent.util.userAgent_=e||n.labs.userAgent.util.getNativeUserAgentString_()},n.labs.userAgent.util.getUserAgent=function(){return n.labs.userAgent.util.userAgent_},n.labs.userAgent.util.matchUserAgent=function(e){var t=n.labs.userAgent.util.getUserAgent();return n.string.contains(t,e)},n.labs.userAgent.util.matchUserAgentIgnoreCase=function(e){var t=n.labs.userAgent.util.getUserAgent();return n.string.caseInsensitiveContains(t,e)},n.labs.userAgent.util.extractVersionTuples=function(e){for(var t,r=new RegExp("(\\w[\\w ]+)/([^\\s]+)\\s*(?:\\((.*?)\\))?","g"),n=[];t=r.exec(e);)n.push([t[1],t[2],t[3]||void 0]);return n},n.provide("goog.dom.NodeType"),n.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},n.provide("goog.debug.Error"),n.debug.Error=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,n.debug.Error);else{var t=(new Error).stack;t&&(this.stack=t)}e&&(this.message=String(e))},n.inherits(n.debug.Error,Error),n.debug.Error.prototype.name="CustomError",n.provide("goog.asserts"),n.provide("goog.asserts.AssertionError"),n.require("goog.debug.Error"),n.require("goog.dom.NodeType"),n.require("goog.string"),n.define("goog.asserts.ENABLE_ASSERTS",n.DEBUG),n.asserts.AssertionError=function(e,t){t.unshift(e),n.debug.Error.call(this,n.string.subs.apply(null,t)),t.shift(),this.messagePattern=e},n.inherits(n.asserts.AssertionError,n.debug.Error),n.asserts.AssertionError.prototype.name="AssertionError",n.asserts.doAssertFailure_=function(e,t,r,i){var o="Assertion failed";if(r){o+=": "+r;var s=i}else e&&(o+=": "+e,s=t);throw new n.asserts.AssertionError(""+o,s||[])},n.asserts.assert=function(e,t,r){return n.asserts.ENABLE_ASSERTS&&!e&&n.asserts.doAssertFailure_("",null,t,Array.prototype.slice.call(arguments,2)),e},n.asserts.fail=function(e,t){if(n.asserts.ENABLE_ASSERTS)throw new n.asserts.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))},n.asserts.assertNumber=function(e,t,r){return n.asserts.ENABLE_ASSERTS&&!n.isNumber(e)&&n.asserts.doAssertFailure_("Expected number but got %s: %s.",[n.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},n.asserts.assertString=function(e,t,r){return n.asserts.ENABLE_ASSERTS&&!n.isString(e)&&n.asserts.doAssertFailure_("Expected string but got %s: %s.",[n.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},n.asserts.assertFunction=function(e,t,r){return n.asserts.ENABLE_ASSERTS&&!n.isFunction(e)&&n.asserts.doAssertFailure_("Expected function but got %s: %s.",[n.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},n.asserts.assertObject=function(e,t,r){return n.asserts.ENABLE_ASSERTS&&!n.isObject(e)&&n.asserts.doAssertFailure_("Expected object but got %s: %s.",[n.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},n.asserts.assertArray=function(e,t,r){return n.asserts.ENABLE_ASSERTS&&!n.isArray(e)&&n.asserts.doAssertFailure_("Expected array but got %s: %s.",[n.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},n.asserts.assertBoolean=function(e,t,r){return n.asserts.ENABLE_ASSERTS&&!n.isBoolean(e)&&n.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[n.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},n.asserts.assertElement=function(e,t,r){return!n.asserts.ENABLE_ASSERTS||n.isObject(e)&&e.nodeType==n.dom.NodeType.ELEMENT||n.asserts.doAssertFailure_("Expected Element but got %s: %s.",[n.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},n.asserts.assertInstanceof=function(e,t,r,i){return!n.asserts.ENABLE_ASSERTS||e instanceof t||n.asserts.doAssertFailure_("instanceof check failed.",null,r,Array.prototype.slice.call(arguments,3)),e},n.asserts.assertObjectPrototypeIsIntact=function(){for(var e in Object.prototype)n.asserts.fail(e+" should not be enumerable in Object.prototype.")},n.provide("goog.array"),n.provide("goog.array.ArrayLike"),n.require("goog.asserts"),n.define("goog.NATIVE_ARRAY_PROTOTYPES",n.TRUSTED_SITE),n.define("goog.array.ASSUME_NATIVE_FUNCTIONS",!1),n.array.ArrayLike,n.array.peek=function(e){return e[e.length-1]},n.array.last=n.array.peek,n.array.ARRAY_PROTOTYPE_=Array.prototype,n.array.indexOf=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.indexOf)?function(e,t,r){return n.asserts.assert(null!=e.length),n.array.ARRAY_PROTOTYPE_.indexOf.call(e,t,r)}:function(e,t,r){var i=null==r?0:r<0?Math.max(0,e.length+r):r;if(n.isString(e))return n.isString(t)&&1==t.length?e.indexOf(t,i):-1;for(var o=i;o<e.length;o++)if(o in e&&e[o]===t)return o;return-1},n.array.lastIndexOf=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.lastIndexOf)?function(e,t,r){n.asserts.assert(null!=e.length);var i=null==r?e.length-1:r;return n.array.ARRAY_PROTOTYPE_.lastIndexOf.call(e,t,i)}:function(e,t,r){var i=null==r?e.length-1:r;if(i<0&&(i=Math.max(0,e.length+i)),n.isString(e))return n.isString(t)&&1==t.length?e.lastIndexOf(t,i):-1;for(var o=i;o>=0;o--)if(o in e&&e[o]===t)return o;return-1},n.array.forEach=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.forEach)?function(e,t,r){n.asserts.assert(null!=e.length),n.array.ARRAY_PROTOTYPE_.forEach.call(e,t,r)}:function(e,t,r){for(var i=e.length,o=n.isString(e)?e.split(""):e,s=0;s<i;s++)s in o&&t.call(r,o[s],s,e)},n.array.forEachRight=function(e,t,r){for(var i=e.length,o=n.isString(e)?e.split(""):e,s=i-1;s>=0;--s)s in o&&t.call(r,o[s],s,e)},n.array.filter=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.filter)?function(e,t,r){return n.asserts.assert(null!=e.length),n.array.ARRAY_PROTOTYPE_.filter.call(e,t,r)}:function(e,t,r){for(var i=e.length,o=[],s=0,a=n.isString(e)?e.split(""):e,l=0;l<i;l++)if(l in a){var h=a[l];t.call(r,h,l,e)&&(o[s++]=h)}return o},n.array.map=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.map)?function(e,t,r){return n.asserts.assert(null!=e.length),n.array.ARRAY_PROTOTYPE_.map.call(e,t,r)}:function(e,t,r){for(var i=e.length,o=new Array(i),s=n.isString(e)?e.split(""):e,a=0;a<i;a++)a in s&&(o[a]=t.call(r,s[a],a,e));return o},n.array.reduce=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.reduce)?function(e,t,r,i){return n.asserts.assert(null!=e.length),i&&(t=n.bind(t,i)),n.array.ARRAY_PROTOTYPE_.reduce.call(e,t,r)}:function(e,t,r,i){var o=r;return n.array.forEach(e,function(r,n){o=t.call(i,o,r,n,e)}),o},n.array.reduceRight=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.reduceRight)?function(e,t,r,i){return n.asserts.assert(null!=e.length),i&&(t=n.bind(t,i)),n.array.ARRAY_PROTOTYPE_.reduceRight.call(e,t,r)}:function(e,t,r,i){var o=r;return n.array.forEachRight(e,function(r,n){o=t.call(i,o,r,n,e)}),o},n.array.some=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.some)?function(e,t,r){return n.asserts.assert(null!=e.length),n.array.ARRAY_PROTOTYPE_.some.call(e,t,r)}:function(e,t,r){for(var i=e.length,o=n.isString(e)?e.split(""):e,s=0;s<i;s++)if(s in o&&t.call(r,o[s],s,e))return!0;return!1},n.array.every=n.NATIVE_ARRAY_PROTOTYPES&&(n.array.ASSUME_NATIVE_FUNCTIONS||n.array.ARRAY_PROTOTYPE_.every)?function(e,t,r){return n.asserts.assert(null!=e.length),n.array.ARRAY_PROTOTYPE_.every.call(e,t,r)}:function(e,t,r){for(var i=e.length,o=n.isString(e)?e.split(""):e,s=0;s<i;s++)if(s in o&&!t.call(r,o[s],s,e))return!1;return!0},n.array.count=function(e,t,r){var i=0;return n.array.forEach(e,function(e,n,o){t.call(r,e,n,o)&&++i},r),i},n.array.find=function(e,t,r){var i=n.array.findIndex(e,t,r);return i<0?null:n.isString(e)?e.charAt(i):e[i]},n.array.findIndex=function(e,t,r){for(var i=e.length,o=n.isString(e)?e.split(""):e,s=0;s<i;s++)if(s in o&&t.call(r,o[s],s,e))return s;return-1},n.array.findRight=function(e,t,r){var i=n.array.findIndexRight(e,t,r);return i<0?null:n.isString(e)?e.charAt(i):e[i]},n.array.findIndexRight=function(e,t,r){for(var i=e.length,o=n.isString(e)?e.split(""):e,s=i-1;s>=0;s--)if(s in o&&t.call(r,o[s],s,e))return s;return-1},n.array.contains=function(e,t){return n.array.indexOf(e,t)>=0},n.array.isEmpty=function(e){return 0==e.length},n.array.clear=function(e){if(!n.isArray(e))for(var t=e.length-1;t>=0;t--)delete e[t];e.length=0},n.array.insert=function(e,t){n.array.contains(e,t)||e.push(t)},n.array.insertAt=function(e,t,r){n.array.splice(e,r,0,t)},n.array.insertArrayAt=function(e,t,r){n.partial(n.array.splice,e,r,0).apply(null,t)},n.array.insertBefore=function(e,t,r){var i;2==arguments.length||(i=n.array.indexOf(e,r))<0?e.push(t):n.array.insertAt(e,t,i)},n.array.remove=function(e,t){var r,i=n.array.indexOf(e,t);return(r=i>=0)&&n.array.removeAt(e,i),r},n.array.removeAt=function(e,t){return n.asserts.assert(null!=e.length),1==n.array.ARRAY_PROTOTYPE_.splice.call(e,t,1).length},n.array.removeIf=function(e,t,r){var i=n.array.findIndex(e,t,r);return i>=0&&(n.array.removeAt(e,i),!0)},n.array.concat=function(e){return n.array.ARRAY_PROTOTYPE_.concat.apply(n.array.ARRAY_PROTOTYPE_,arguments)},n.array.join=function(e){return n.array.ARRAY_PROTOTYPE_.concat.apply(n.array.ARRAY_PROTOTYPE_,arguments)},n.array.toArray=function(e){var t=e.length;if(t>0){for(var r=new Array(t),n=0;n<t;n++)r[n]=e[n];return r}return[]},n.array.clone=n.array.toArray,n.array.extend=function(e,t){for(var r=1;r<arguments.length;r++){var i,o=arguments[r];if(n.isArray(o)||(i=n.isArrayLike(o))&&Object.prototype.hasOwnProperty.call(o,"callee"))e.push.apply(e,o);else if(i)for(var s=e.length,a=o.length,l=0;l<a;l++)e[s+l]=o[l];else e.push(o)}},n.array.splice=function(e,t,r,i){return n.asserts.assert(null!=e.length),n.array.ARRAY_PROTOTYPE_.splice.apply(e,n.array.slice(arguments,1))},n.array.slice=function(e,t,r){return n.asserts.assert(null!=e.length),arguments.length<=2?n.array.ARRAY_PROTOTYPE_.slice.call(e,t):n.array.ARRAY_PROTOTYPE_.slice.call(e,t,r)},n.array.removeDuplicates=function(e,t,r){for(var i=t||e,o=function(e){return n.isObject(p)?"o"+n.getUid(p):(typeof p).charAt(0)+p},s=r||o,a={},l=0,h=0;h<e.length;){var p=e[h++],g=s(p);Object.prototype.hasOwnProperty.call(a,g)||(a[g]=!0,i[l++]=p)}i.length=l},n.array.binarySearch=function(e,t,r){return n.array.binarySearch_(e,r||n.array.defaultCompare,!1,t)},n.array.binarySelect=function(e,t,r){return n.array.binarySearch_(e,t,!0,void 0,r)},n.array.binarySearch_=function(e,t,r,n,i){for(var o,s=0,a=e.length;s<a;){var l,h=s+a>>1;l=r?t.call(i,e[h],h,e):t(n,e[h]),l>0?s=h+1:(a=h,o=!l)}return o?s:~s},n.array.sort=function(e,t){e.sort(t||n.array.defaultCompare)},n.array.stableSort=function(e,t){function r(e,t){return o(e.value,t.value)||e.index-t.index}for(var i=0;i<e.length;i++)e[i]={index:i,value:e[i]};var o=t||n.array.defaultCompare;n.array.sort(e,r);for(var i=0;i<e.length;i++)e[i]=e[i].value},n.array.sortObjectsByKey=function(e,t,r){var i=r||n.array.defaultCompare;n.array.sort(e,function(e,r){return i(e[t],r[t])})},n.array.isSorted=function(e,t,r){for(var i=t||n.array.defaultCompare,o=1;o<e.length;o++){var s=i(e[o-1],e[o]);if(s>0||0==s&&r)return!1}return!0},n.array.equals=function(e,t,r){if(!n.isArrayLike(e)||!n.isArrayLike(t)||e.length!=t.length)return!1;for(var i=e.length,o=r||n.array.defaultCompareEquality,s=0;s<i;s++)if(!o(e[s],t[s]))return!1;return!0},n.array.compare3=function(e,t,r){for(var i=r||n.array.defaultCompare,o=Math.min(e.length,t.length),s=0;s<o;s++){var a=i(e[s],t[s]);if(0!=a)return a}return n.array.defaultCompare(e.length,t.length)},n.array.defaultCompare=function(e,t){return e>t?1:e<t?-1:0},n.array.defaultCompareEquality=function(e,t){return e===t},n.array.binaryInsert=function(e,t,r){var i=n.array.binarySearch(e,t,r);return i<0&&(n.array.insertAt(e,t,-(i+1)),!0)},n.array.binaryRemove=function(e,t,r){var i=n.array.binarySearch(e,t,r);return i>=0&&n.array.removeAt(e,i)},n.array.bucket=function(e,t,r){for(var i={},o=0;o<e.length;o++){var s=e[o],a=t.call(r,s,o,e);if(n.isDef(a)){(i[a]||(i[a]=[])).push(s)}}return i},n.array.toObject=function(e,t,r){var i={};return n.array.forEach(e,function(n,o){i[t.call(r,n,o,e)]=n}),i},n.array.range=function(e,t,r){var n=[],i=0,o=e,s=r||1;if(void 0!==t&&(i=e,o=t),s*(o-i)<0)return[];if(s>0)for(var a=i;a<o;a+=s)n.push(a);else for(var a=i;a>o;a+=s)n.push(a);return n},n.array.repeat=function(e,t){for(var r=[],n=0;n<t;n++)r[n]=e;return r},n.array.flatten=function(e){for(var t=[],r=0;r<arguments.length;r++){var i=arguments[r];n.isArray(i)?t.push.apply(t,n.array.flatten.apply(null,i)):t.push(i)}return t},n.array.rotate=function(e,t){return n.asserts.assert(null!=e.length),e.length&&(t%=e.length,t>0?n.array.ARRAY_PROTOTYPE_.unshift.apply(e,e.splice(-t,t)):t<0&&n.array.ARRAY_PROTOTYPE_.push.apply(e,e.splice(0,-t))),e},n.array.moveItem=function(e,t,r){n.asserts.assert(t>=0&&t<e.length),n.asserts.assert(r>=0&&r<e.length);var i=n.array.ARRAY_PROTOTYPE_.splice.call(e,t,1);n.array.ARRAY_PROTOTYPE_.splice.call(e,r,0,i[0])},n.array.zip=function(e){if(!arguments.length)return[];for(var t=[],r=0;!0;r++){for(var n=[],i=0;i<arguments.length;i++){var o=arguments[i];if(r>=o.length)return t;n.push(o[r])}t.push(n)}},n.array.shuffle=function(e,t){for(var r=t||Math.random,n=e.length-1;n>0;n--){var i=Math.floor(r()*(n+1)),o=e[n];e[n]=e[i],e[i]=o}},n.provide("goog.labs.userAgent.browser"),n.require("goog.array"),n.require("goog.asserts"),n.require("goog.labs.userAgent.util"),n.require("goog.string"),n.labs.userAgent.browser.matchOpera_=function(){return n.labs.userAgent.util.matchUserAgent("Opera")||n.labs.userAgent.util.matchUserAgent("OPR")},n.labs.userAgent.browser.matchIE_=function(){return n.labs.userAgent.util.matchUserAgent("Trident")||n.labs.userAgent.util.matchUserAgent("MSIE")},n.labs.userAgent.browser.matchFirefox_=function(){return n.labs.userAgent.util.matchUserAgent("Firefox")},n.labs.userAgent.browser.matchSafari_=function(){return n.labs.userAgent.util.matchUserAgent("Safari")&&!n.labs.userAgent.util.matchUserAgent("Chrome")&&!n.labs.userAgent.util.matchUserAgent("CriOS")&&!n.labs.userAgent.util.matchUserAgent("Android")},n.labs.userAgent.browser.matchChrome_=function(){return n.labs.userAgent.util.matchUserAgent("Chrome")||n.labs.userAgent.util.matchUserAgent("CriOS")},n.labs.userAgent.browser.matchAndroidBrowser_=function(){return n.labs.userAgent.util.matchUserAgent("Android")&&!n.labs.userAgent.util.matchUserAgent("Chrome")&&!n.labs.userAgent.util.matchUserAgent("CriOS")},n.labs.userAgent.browser.isOpera=n.labs.userAgent.browser.matchOpera_,n.labs.userAgent.browser.isIE=n.labs.userAgent.browser.matchIE_,n.labs.userAgent.browser.isFirefox=n.labs.userAgent.browser.matchFirefox_,n.labs.userAgent.browser.isSafari=n.labs.userAgent.browser.matchSafari_,n.labs.userAgent.browser.isChrome=n.labs.userAgent.browser.matchChrome_,n.labs.userAgent.browser.isAndroidBrowser=n.labs.userAgent.browser.matchAndroidBrowser_,n.labs.userAgent.browser.isSilk=function(){return n.labs.userAgent.util.matchUserAgent("Silk")},n.labs.userAgent.browser.getVersion=function(){var e=n.labs.userAgent.util.getUserAgent();if(n.labs.userAgent.browser.isIE())return n.labs.userAgent.browser.getIEVersion_(e);if(n.labs.userAgent.browser.isOpera())return n.labs.userAgent.browser.getOperaVersion_(e);var t=n.labs.userAgent.util.extractVersionTuples(e);return n.labs.userAgent.browser.getVersionFromTuples_(t)},n.labs.userAgent.browser.isVersionOrHigher=function(e){return n.string.compareVersions(n.labs.userAgent.browser.getVersion(),e)>=0},n.labs.userAgent.browser.getIEVersion_=function(e){var t=/rv: *([\d\.]*)/.exec(e);if(t&&t[1])return t[1];var r="",n=/MSIE +([\d\.]+)/.exec(e);if(n&&n[1]){var i=/Trident\/(\d.\d)/.exec(e);if("7.0"==n[1])if(i&&i[1])switch(i[1]){case"4.0":r="8.0";break;case"5.0":r="9.0";break;case"6.0":r="10.0";break;case"7.0":r="11.0"}else r="7.0";else r=n[1]}return r},n.labs.userAgent.browser.getOperaVersion_=function(e){var t=n.labs.userAgent.util.extractVersionTuples(e),r=n.array.peek(t);return"OPR"==r[0]&&r[1]?r[1]:n.labs.userAgent.browser.getVersionFromTuples_(t)},n.labs.userAgent.browser.getVersionFromTuples_=function(e){return n.asserts.assert(e.length>2,"Couldn't extract version tuple from user agent string"),e[2]&&e[2][1]?e[2][1]:""},n.provide("goog.labs.userAgent.engine"),n.require("goog.array"),n.require("goog.labs.userAgent.util"),n.require("goog.string"),n.labs.userAgent.engine.isPresto=function(){return n.labs.userAgent.util.matchUserAgent("Presto")},n.labs.userAgent.engine.isTrident=function(){return n.labs.userAgent.util.matchUserAgent("Trident")||n.labs.userAgent.util.matchUserAgent("MSIE")},n.labs.userAgent.engine.isWebKit=function(){return n.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")},n.labs.userAgent.engine.isGecko=function(){return n.labs.userAgent.util.matchUserAgent("Gecko")&&!n.labs.userAgent.engine.isWebKit()&&!n.labs.userAgent.engine.isTrident()},n.labs.userAgent.engine.getVersion=function(){var e=n.labs.userAgent.util.getUserAgent();if(e){var t=n.labs.userAgent.util.extractVersionTuples(e),r=t[1];if(r)return"Gecko"==r[0]?n.labs.userAgent.engine.getVersionForKey_(t,"Firefox"):r[1];var i,o=t[0];if(o&&(i=o[2])){var s=/Trident\/([^\s;]+)/.exec(i);if(s)return s[1]}}return""},n.labs.userAgent.engine.isVersionOrHigher=function(e){return n.string.compareVersions(n.labs.userAgent.engine.getVersion(),e)>=0},n.labs.userAgent.engine.getVersionForKey_=function(e,t){var r=n.array.find(e,function(e){return t==e[0]});return r&&r[1]||""},n.provide("goog.userAgent"),n.require("goog.labs.userAgent.browser"),n.require("goog.labs.userAgent.engine"),n.require("goog.labs.userAgent.util"),n.require("goog.string"),n.define("goog.userAgent.ASSUME_IE",!1),n.define("goog.userAgent.ASSUME_GECKO",!1),n.define("goog.userAgent.ASSUME_WEBKIT",!1),n.define("goog.userAgent.ASSUME_MOBILE_WEBKIT",!1),n.define("goog.userAgent.ASSUME_OPERA",!1),n.define("goog.userAgent.ASSUME_ANY_VERSION",!1),n.userAgent.BROWSER_KNOWN_=n.userAgent.ASSUME_IE||n.userAgent.ASSUME_GECKO||n.userAgent.ASSUME_MOBILE_WEBKIT||n.userAgent.ASSUME_WEBKIT||n.userAgent.ASSUME_OPERA,n.userAgent.getUserAgentString=function(){return n.labs.userAgent.util.getUserAgent()},n.userAgent.getNavigator=function(){return n.global.navigator||null},n.userAgent.OPERA=n.userAgent.BROWSER_KNOWN_?n.userAgent.ASSUME_OPERA:n.labs.userAgent.browser.isOpera(),n.userAgent.IE=n.userAgent.BROWSER_KNOWN_?n.userAgent.ASSUME_IE:n.labs.userAgent.browser.isIE(),n.userAgent.GECKO=n.userAgent.BROWSER_KNOWN_?n.userAgent.ASSUME_GECKO:n.labs.userAgent.engine.isGecko(),n.userAgent.WEBKIT=n.userAgent.BROWSER_KNOWN_?n.userAgent.ASSUME_WEBKIT||n.userAgent.ASSUME_MOBILE_WEBKIT:n.labs.userAgent.engine.isWebKit(),n.userAgent.isMobile_=function(){return n.userAgent.WEBKIT&&n.labs.userAgent.util.matchUserAgent("Mobile")},n.userAgent.MOBILE=n.userAgent.ASSUME_MOBILE_WEBKIT||n.userAgent.isMobile_(),n.userAgent.SAFARI=n.userAgent.WEBKIT,n.userAgent.determinePlatform_=function(){var e=n.userAgent.getNavigator();return e&&e.platform||""},n.userAgent.PLATFORM=n.userAgent.determinePlatform_(),n.define("goog.userAgent.ASSUME_MAC",!1),n.define("goog.userAgent.ASSUME_WINDOWS",!1),n.define("goog.userAgent.ASSUME_LINUX",!1),n.define("goog.userAgent.ASSUME_X11",!1),n.define("goog.userAgent.ASSUME_ANDROID",!1),n.define("goog.userAgent.ASSUME_IPHONE",!1),n.define("goog.userAgent.ASSUME_IPAD",!1),n.userAgent.PLATFORM_KNOWN_=n.userAgent.ASSUME_MAC||n.userAgent.ASSUME_WINDOWS||n.userAgent.ASSUME_LINUX||n.userAgent.ASSUME_X11||n.userAgent.ASSUME_ANDROID||n.userAgent.ASSUME_IPHONE||n.userAgent.ASSUME_IPAD,n.userAgent.initPlatform_=function(){n.userAgent.detectedMac_=n.string.contains(n.userAgent.PLATFORM,"Mac"),n.userAgent.detectedWindows_=n.string.contains(n.userAgent.PLATFORM,"Win"),n.userAgent.detectedLinux_=n.string.contains(n.userAgent.PLATFORM,"Linux"),n.userAgent.detectedX11_=!!n.userAgent.getNavigator()&&n.string.contains(n.userAgent.getNavigator().appVersion||"","X11");var e=n.userAgent.getUserAgentString();n.userAgent.detectedAndroid_=!!e&&n.string.contains(e,"Android"),n.userAgent.detectedIPhone_=!!e&&n.string.contains(e,"iPhone"),n.userAgent.detectedIPad_=!!e&&n.string.contains(e,"iPad")},n.userAgent.PLATFORM_KNOWN_||n.userAgent.initPlatform_(),n.userAgent.MAC=n.userAgent.PLATFORM_KNOWN_?n.userAgent.ASSUME_MAC:n.userAgent.detectedMac_,n.userAgent.WINDOWS=n.userAgent.PLATFORM_KNOWN_?n.userAgent.ASSUME_WINDOWS:n.userAgent.detectedWindows_,n.userAgent.LINUX=n.userAgent.PLATFORM_KNOWN_?n.userAgent.ASSUME_LINUX:n.userAgent.detectedLinux_,n.userAgent.X11=n.userAgent.PLATFORM_KNOWN_?n.userAgent.ASSUME_X11:n.userAgent.detectedX11_,n.userAgent.ANDROID=n.userAgent.PLATFORM_KNOWN_?n.userAgent.ASSUME_ANDROID:n.userAgent.detectedAndroid_,n.userAgent.IPHONE=n.userAgent.PLATFORM_KNOWN_?n.userAgent.ASSUME_IPHONE:n.userAgent.detectedIPhone_,n.userAgent.IPAD=n.userAgent.PLATFORM_KNOWN_?n.userAgent.ASSUME_IPAD:n.userAgent.detectedIPad_,n.userAgent.determineVersion_=function(){var e,t="";if(n.userAgent.OPERA&&n.global.opera){var r=n.global.opera.version;return n.isFunction(r)?r():r}if(n.userAgent.GECKO?e=/rv\:([^\);]+)(\)|;)/:n.userAgent.IE?e=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:n.userAgent.WEBKIT&&(e=/WebKit\/(\S+)/),e){var i=e.exec(n.userAgent.getUserAgentString());t=i?i[1]:""}if(n.userAgent.IE){var o=n.userAgent.getDocumentMode_();if(o>parseFloat(t))return String(o)}return t},n.userAgent.getDocumentMode_=function(){var e=n.global.document;return e?e.documentMode:void 0},n.userAgent.VERSION=n.userAgent.determineVersion_(),n.userAgent.compare=function(e,t){return n.string.compareVersions(e,t)},n.userAgent.isVersionOrHigherCache_={},n.userAgent.isVersionOrHigher=function(e){return n.userAgent.ASSUME_ANY_VERSION||n.userAgent.isVersionOrHigherCache_[e]||(n.userAgent.isVersionOrHigherCache_[e]=n.string.compareVersions(n.userAgent.VERSION,e)>=0)},n.userAgent.isVersion=n.userAgent.isVersionOrHigher,n.userAgent.isDocumentModeOrHigher=function(e){return n.userAgent.IE&&n.userAgent.DOCUMENT_MODE>=e},n.userAgent.isDocumentMode=n.userAgent.isDocumentModeOrHigher,n.userAgent.DOCUMENT_MODE=function(){var e=n.global.document;if(e&&n.userAgent.IE){return n.userAgent.getDocumentMode_()||("CSS1Compat"==e.compatMode?parseInt(n.userAgent.VERSION,10):5)}}(),n.provide("xrx.engine"),n.require("goog.userAgent"),xrx.engine=function(){},xrx.engine.CANVAS="canvas",xrx.engine.SVG="svg",xrx.engine.VML="vml",xrx.engine.hasDom=function(e){return e===xrx.engine.SVG||e===xrx.engine.VML},xrx.engine.isSupported=function(e){if(e===xrx.engine.CANVAS)return!!document.createElement("canvas").getContext;if(e===xrx.engine.SVG)return!!document.createElementNS&&!!document.createElementNS(xrx.svg.Namespace.svg,"svg").createSVGRect;if(e===xrx.engine.VML)return!!document.namespaces;throw Error("Unknown engine.")},n.provide("xrx.shape"),xrx.shape=function(){},xrx.shape.EventType={SHAPE_BEFORE_DRAW:"eventShapeBeforeDraw"},n.provide("goog.disposable.IDisposable"),n.disposable.IDisposable=function(){},n.disposable.IDisposable.prototype.dispose=n.abstractMethod;n.disposable.IDisposable.prototype.isDisposed=n.abstractMethod,n.provide("goog.Disposable"),n.provide("goog.dispose"),n.provide("goog.disposeAll"),n.require("goog.disposable.IDisposable"),n.Disposable=function(){n.Disposable.MONITORING_MODE!=n.Disposable.MonitoringMode.OFF&&(n.Disposable.INCLUDE_STACK_ON_CREATION&&(this.creationStack=(new Error).stack),n.Disposable.instances_[n.getUid(this)]=this)},n.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2},n.define("goog.Disposable.MONITORING_MODE",0),n.define("goog.Disposable.INCLUDE_STACK_ON_CREATION",!0),n.Disposable.instances_={},n.Disposable.getUndisposedObjects=function(){var e=[];for(var t in n.Disposable.instances_)n.Disposable.instances_.hasOwnProperty(t)&&e.push(n.Disposable.instances_[Number(t)]);return e},n.Disposable.clearUndisposedObjects=function(){n.Disposable.instances_={}},n.Disposable.prototype.disposed_=!1,n.Disposable.prototype.onDisposeCallbacks_,n.Disposable.prototype.creationStack,n.Disposable.prototype.isDisposed=function(){return this.disposed_},n.Disposable.prototype.getDisposed=n.Disposable.prototype.isDisposed,n.Disposable.prototype.dispose=function(){if(!this.disposed_&&(this.disposed_=!0,this.disposeInternal(),n.Disposable.MONITORING_MODE!=n.Disposable.MonitoringMode.OFF)){var e=n.getUid(this);if(n.Disposable.MONITORING_MODE==n.Disposable.MonitoringMode.PERMANENT&&!n.Disposable.instances_.hasOwnProperty(e))throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call");delete n.Disposable.instances_[e]}},n.Disposable.prototype.registerDisposable=function(e){this.addOnDisposeCallback(n.partial(n.dispose,e))},n.Disposable.prototype.addOnDisposeCallback=function(e,t){this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]),this.onDisposeCallbacks_.push(n.isDef(t)?n.bind(e,t):e)},n.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()},n.Disposable.isDisposed=function(e){return!(!e||"function"!=typeof e.isDisposed)&&e.isDisposed()},n.dispose=function(e){e&&"function"==typeof e.dispose&&e.dispose()},n.disposeAll=function(e){for(var t=0,r=arguments.length;t<r;++t){var i=arguments[t];n.isArrayLike(i)?n.disposeAll.apply(null,i):n.dispose(i)}},n.provide("xrx.shape.Style"),n.require("goog.Disposable"),n.require("xrx.shape"),xrx.shape.Style=function(){n.base(this),this.fill_={color:"",opacity:0},this.stroke_={color:"black",width:1}},n.inherits(xrx.shape.Style,n.Disposable),xrx.shape.Style.prototype.setStyle=function(e){this.stroke_.color=e.getStrokeColor(),this.stroke_.width=e.getStrokeWidth(),this.fill_.color=e.getFillColor(),this.fill_.opacity=e.getFillOpacity()},xrx.shape.Style.prototype.getStrokeWidth=function(){return this.stroke_.width},xrx.shape.Style.prototype.setStrokeWidth=function(e){void 0!==e&&(this.stroke_.width=e)},xrx.shape.Style.prototype.getStrokeColor=function(){return this.stroke_.color},xrx.shape.Style.prototype.setStrokeColor=function(e){void 0!==e&&(this.stroke_.color=e)},xrx.shape.Style.prototype.getFillColor=function(){return this.fill_.color},xrx.shape.Style.prototype.setFillColor=function(e){0===this.fill_.opacity&&(this.fill_.opacity=1),void 0!==e&&(this.fill_.color=e)},xrx.shape.Style.prototype.getFillOpacity=function(){return this.fill_.opacity},xrx.shape.Style.prototype.setFillOpacity=function(e){void 0!==e&&(this.fill_.opacity=e)},xrx.shape.Style.prototype.disposeInternal=function(){this.fill_=null,this.stroke_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.RenderStylable"),n.require("xrx.engine"),n.require("xrx.shape.Style"),xrx.shape.RenderStylable=function(e){n.base(this),this.zoomFactor_=1,this.shapeGroup_,this.hasDom_=xrx.engine.hasDom(e.getEngine().getName()),this.fillChanged_={color:!0,opacity:!0},this.strokeChanged_={color:!0,width:!0}},n.inherits(xrx.shape.RenderStylable,xrx.shape.Style),xrx.shape.RenderStylable.prototype.getShapeGroup=function(){return this.shapeGroup_},xrx.shape.RenderStylable.prototype.setShapeGroup=function(e){this.shapeGroup_=e},xrx.shape.RenderStylable.prototype.getEngineElement=function(){return this.engineElement_},xrx.shape.RenderStylable.prototype.setZoomFactor=function(e){this.zoomFactor_=e},xrx.shape.RenderStylable.prototype.setStyles=function(e){this.setStyle(e),this.getHoverable().setStyle(e.getHoverable()),this.getModifiable().setStyle(e.getModifiable()),this.getSelectable().setStyle(e.getSelectable())},xrx.shape.RenderStylable.prototype.setStyle=function(e){n.base(this,"setStyle",e),this.fillChanged_.color=!0,this.fillChanged_.opacity=!0,this.strokeChanged_.color=!0,this.strokeChanged_.width=!0},xrx.shape.RenderStylable.prototype.setFillColor=function(e){n.base(this,"setFillColor",e),this.fillChanged_.color=!0},xrx.shape.RenderStylable.prototype.getRenderingFillColor=function(){var e=this.shapeGroup_?this.shapeGroup_.getFillColor():this.hasDom_&&!1===this.fillChanged_.color?void 0:this.fill_.color;return this.fillChanged_.color=!1,e},xrx.shape.RenderStylable.prototype.setFillOpacity=function(e){n.base(this,"setFillOpacity",e),this.fillChanged_.opacity=!0},xrx.shape.RenderStylable.prototype.getRenderingFillOpacity=function(){var e=this.shapeGroup_?this.shapeGroup_.getFillOpacity():this.hasDom_&&!1===this.fillChanged_.opacity?void 0:this.fill_.opacity;return this.fillChanged_.opacity=!1,e},xrx.shape.RenderStylable.prototype.setStrokeColor=function(e){n.base(this,"setStrokeColor",e),this.strokeChanged_.color=!0},xrx.shape.RenderStylable.prototype.getRenderingStrokeColor=function(){var e=this.shapeGroup_?this.shapeGroup_.getStrokeColor():this.hasDom_&&!1===this.strokeChanged_.color?void 0:this.stroke_.color;return this.strokeChanged_.color=!1,e},xrx.shape.RenderStylable.prototype.setStrokeWidth=function(e){n.base(this,"setStrokeWidth",e),this.strokeChanged_.width=!0},xrx.shape.RenderStylable.prototype.getRenderingStrokeWidth=function(){var e=this.shapeGroup_?this.shapeGroup_.getStrokeWidth()/this.zoomFactor_:this.hasDom_&&!1===this.strokeChanged_.width?void 0:this.stroke_.width/this.zoomFactor_;return this.strokeChanged_.width=!1,e},xrx.shape.RenderStylable.prototype.startDrawing_=function(){this.drawing_.eventBeforeRendering(this),this.engineElement_.applyTransform(this.ctm_),this.engineElement_.startDrawing()},xrx.shape.RenderStylable.prototype.finishDrawing_=function(){this.engineElement_.finishDrawing()},xrx.shape.RenderStylable.prototype.disposeInternal=function(){this.engineElement_.dispose(),this.engineElement_=null,n.dispose(this.shapeGroup_),this.shapeGroup_=null,n.base(this,"disposeInternal")},n.provide("goog.dom.classes"),n.require("goog.array"),n.dom.classes.set=function(e,t){e.className=t},n.dom.classes.get=function(e){var t=e.className;return n.isString(t)&&t.match(/\S+/g)||[]},n.dom.classes.add=function(e,t){var r=n.dom.classes.get(e),i=n.array.slice(arguments,1),o=r.length+i.length;return n.dom.classes.add_(r,i),n.dom.classes.set(e,r.join(" ")),r.length==o},n.dom.classes.remove=function(e,t){var r=n.dom.classes.get(e),i=n.array.slice(arguments,1),o=n.dom.classes.getDifference_(r,i);return n.dom.classes.set(e,o.join(" ")),o.length==r.length-i.length},n.dom.classes.add_=function(e,t){for(var r=0;r<t.length;r++)n.array.contains(e,t[r])||e.push(t[r])},n.dom.classes.getDifference_=function(e,t){return n.array.filter(e,function(e){return!n.array.contains(t,e)})},n.dom.classes.swap=function(e,t,r){for(var i=n.dom.classes.get(e),o=!1,s=0;s<i.length;s++)i[s]==t&&(n.array.splice(i,s--,1),o=!0);return o&&(i.push(r),n.dom.classes.set(e,i.join(" "))),o},n.dom.classes.addRemove=function(e,t,r){var i=n.dom.classes.get(e);n.isString(t)?n.array.remove(i,t):n.isArray(t)&&(i=n.dom.classes.getDifference_(i,t)),n.isString(r)&&!n.array.contains(i,r)?i.push(r):n.isArray(r)&&n.dom.classes.add_(i,r),n.dom.classes.set(e,i.join(" "))},n.dom.classes.has=function(e,t){return n.array.contains(n.dom.classes.get(e),t)},n.dom.classes.enable=function(e,t,r){r?n.dom.classes.add(e,t):n.dom.classes.remove(e,t)},n.dom.classes.toggle=function(e,t){var r=!n.dom.classes.has(e,t);return n.dom.classes.enable(e,t,r),r},n.provide("goog.dom.TagName"),n.dom.TagName={A:"A",ABBR:"ABBR",ACRONYM:"ACRONYM",ADDRESS:"ADDRESS",APPLET:"APPLET",AREA:"AREA",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",B:"B",BASE:"BASE",BASEFONT:"BASEFONT",BDI:"BDI",BDO:"BDO",BIG:"BIG",BLOCKQUOTE:"BLOCKQUOTE",BODY:"BODY",BR:"BR",BUTTON:"BUTTON",CANVAS:"CANVAS",CAPTION:"CAPTION",CENTER:"CENTER",CITE:"CITE",CODE:"CODE",COL:"COL",COLGROUP:"COLGROUP",COMMAND:"COMMAND",DATA:"DATA",DATALIST:"DATALIST",DD:"DD",DEL:"DEL",DETAILS:"DETAILS",DFN:"DFN",DIALOG:"DIALOG",DIR:"DIR",DIV:"DIV",DL:"DL",DT:"DT",EM:"EM",EMBED:"EMBED",FIELDSET:"FIELDSET",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FONT:"FONT",FOOTER:"FOOTER",FORM:"FORM",FRAME:"FRAME",FRAMESET:"FRAMESET",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEAD:"HEAD",HEADER:"HEADER",HGROUP:"HGROUP",HR:"HR",HTML:"HTML",I:"I",IFRAME:"IFRAME",IMG:"IMG",INPUT:"INPUT",INS:"INS",ISINDEX:"ISINDEX",KBD:"KBD",KEYGEN:"KEYGEN",LABEL:"LABEL",LEGEND:"LEGEND",LI:"LI",LINK:"LINK",MAP:"MAP",MARK:"MARK",MATH:"MATH",MENU:"MENU",META:"META",METER:"METER",NAV:"NAV",NOFRAMES:"NOFRAMES",NOSCRIPT:"NOSCRIPT",OBJECT:"OBJECT",OL:"OL",OPTGROUP:"OPTGROUP",OPTION:"OPTION",OUTPUT:"OUTPUT",P:"P",PARAM:"PARAM",PRE:"PRE",PROGRESS:"PROGRESS",Q:"Q",RP:"RP",RT:"RT",RUBY:"RUBY",S:"S",SAMP:"SAMP",SCRIPT:"SCRIPT",SECTION:"SECTION",SELECT:"SELECT",SMALL:"SMALL",SOURCE:"SOURCE",SPAN:"SPAN",STRIKE:"STRIKE",STRONG:"STRONG",STYLE:"STYLE",SUB:"SUB",SUMMARY:"SUMMARY",SUP:"SUP",SVG:"SVG",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TEXTAREA:"TEXTAREA",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",TIME:"TIME",TITLE:"TITLE",TR:"TR",TRACK:"TRACK",TT:"TT",U:"U",UL:"UL",VAR:"VAR",VIDEO:"VIDEO",WBR:"WBR"},n.provide("goog.math.Size"),n.math.Size=function(e,t){this.width=e,this.height=t},n.math.Size.equals=function(e,t){return e==t||!(!e||!t)&&(e.width==t.width&&e.height==t.height)},n.math.Size.prototype.clone=function(){return new n.math.Size(this.width,this.height)},n.DEBUG&&(n.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"}),n.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)},n.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)},n.math.Size.prototype.area=function(){return this.width*this.height},n.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)},n.math.Size.prototype.aspectRatio=function(){return this.width/this.height},n.math.Size.prototype.isEmpty=function(){return!this.area()},n.math.Size.prototype.ceil=function(){return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},n.math.Size.prototype.fitsInside=function(e){return this.width<=e.width&&this.height<=e.height},n.math.Size.prototype.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},n.math.Size.prototype.round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},n.math.Size.prototype.scale=function(e,t){var r=n.isNumber(t)?t:e;return this.width*=e,this.height*=r,this},n.math.Size.prototype.scaleToFit=function(e){var t=this.aspectRatio()>e.aspectRatio()?e.width/this.width:e.height/this.height;return this.scale(t)},n.provide("goog.functions"),n.functions.constant=function(e){return function(){return e}},n.functions.FALSE=n.functions.constant(!1),n.functions.TRUE=n.functions.constant(!0),n.functions.NULL=n.functions.constant(null),n.functions.identity=function(e,t){return e},n.functions.error=function(e){return function(){throw Error(e)}},n.functions.fail=function(e){return function(){throw e}},n.functions.lock=function(e,t){return t=t||0,function(){return e.apply(this,Array.prototype.slice.call(arguments,0,t))}},n.functions.nth=function(e){return function(){return arguments[e]}},n.functions.withReturnValue=function(e,t){return n.functions.sequence(e,n.functions.constant(t))},n.functions.compose=function(e,t){var r=arguments,n=r.length;return function(){var e;n&&(e=r[n-1].apply(this,arguments));for(var t=n-2;t>=0;t--)e=r[t].call(this,e);return e}},n.functions.sequence=function(e){var t=arguments,r=t.length;return function(){for(var e,n=0;n<r;n++)e=t[n].apply(this,arguments);return e}},n.functions.and=function(e){var t=arguments,r=t.length;return function(){for(var e=0;e<r;e++)if(!t[e].apply(this,arguments))return!1;return!0}},n.functions.or=function(e){var t=arguments,r=t.length;return function(){for(var e=0;e<r;e++)if(t[e].apply(this,arguments))return!0;return!1}},n.functions.not=function(e){return function(){return!e.apply(this,arguments)}},n.functions.create=function(e,t){var r=function(){};r.prototype=e.prototype;var n=new r;return e.apply(n,Array.prototype.slice.call(arguments,1)),n},n.define("goog.functions.CACHE_RETURN_VALUE",!0),n.functions.cacheReturnValue=function(e){var t,r=!1;return function(){return n.functions.CACHE_RETURN_VALUE?(r||(t=e(),r=!0),t):e()}},n.provide("goog.dom.BrowserFeature"),n.require("goog.userAgent"),n.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!n.userAgent.IE||n.userAgent.isDocumentModeOrHigher(9),CAN_USE_CHILDREN_ATTRIBUTE:!n.userAgent.GECKO&&!n.userAgent.IE||n.userAgent.IE&&n.userAgent.isDocumentModeOrHigher(9)||n.userAgent.GECKO&&n.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:n.userAgent.IE&&!n.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:n.userAgent.IE||n.userAgent.OPERA||n.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:n.userAgent.IE},n.provide("goog.math"),n.require("goog.array"),n.require("goog.asserts"),n.math.randomInt=function(e){return Math.floor(Math.random()*e)},n.math.uniformRandom=function(e,t){return e+Math.random()*(t-e)},n.math.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},n.math.modulo=function(e,t){var r=e%t;return r*t<0?r+t:r},n.math.lerp=function(e,t,r){return e+r*(t-e)},n.math.nearlyEquals=function(e,t,r){return Math.abs(e-t)<=(r||1e-6)},n.math.standardAngle=function(e){return n.math.modulo(e,360)},n.math.standardAngleInRadians=function(e){return n.math.modulo(e,2*Math.PI)},n.math.toRadians=function(e){return e*Math.PI/180},n.math.toDegrees=function(e){return 180*e/Math.PI},n.math.angleDx=function(e,t){return t*Math.cos(n.math.toRadians(e))},n.math.angleDy=function(e,t){return t*Math.sin(n.math.toRadians(e))},n.math.angle=function(e,t,r,i){return n.math.standardAngle(n.math.toDegrees(Math.atan2(i-t,r-e)))},n.math.angleDifference=function(e,t){var r=n.math.standardAngle(t)-n.math.standardAngle(e);return r>180?r-=360:r<=-180&&(r=360+r),r},n.math.sign=function(e){return 0==e?0:e<0?-1:1},n.math.longestCommonSubsequence=function(e,t,r,n){for(var i=r||function(e,t){return e==t},o=n||function(t,r){return e[t]},s=e.length,a=t.length,l=[],h=0;h<s+1;h++)l[h]=[],l[h][0]=0;for(var p=0;p<a+1;p++)l[0][p]=0;for(h=1;h<=s;h++)for(p=1;p<=a;p++)i(e[h-1],t[p-1])?l[h][p]=l[h-1][p-1]+1:l[h][p]=Math.max(l[h-1][p],l[h][p-1]);for(var g=[],h=s,p=a;h>0&&p>0;)i(e[h-1],t[p-1])?(g.unshift(o(h-1,p-1)),h--,p--):l[h-1][p]>l[h][p-1]?h--:p--;return g},n.math.sum=function(e){return n.array.reduce(arguments,function(e,t){return e+t},0)},n.math.average=function(e){return n.math.sum.apply(null,arguments)/arguments.length},n.math.sampleVariance=function(e){var t=arguments.length;if(t<2)return 0;var r=n.math.average.apply(null,arguments);return n.math.sum.apply(null,n.array.map(arguments,function(e){return Math.pow(e-r,2)}))/(t-1)},n.math.standardDeviation=function(e){return Math.sqrt(n.math.sampleVariance.apply(null,arguments))},n.math.isInt=function(e){return isFinite(e)&&e%1==0},n.math.isFiniteNumber=function(e){return isFinite(e)&&!isNaN(e)},n.math.log10Floor=function(e){if(e>0){var t=Math.round(Math.log(e)*Math.LOG10E);return t-(parseFloat("1e"+t)>e)}return 0==e?-1/0:NaN},n.math.safeFloor=function(e,t){return n.asserts.assert(!n.isDef(t)||t>0),Math.floor(e+(t||2e-15))},n.math.safeCeil=function(e,t){return n.asserts.assert(!n.isDef(t)||t>0),Math.ceil(e-(t||2e-15))},n.provide("goog.math.Coordinate"),n.require("goog.math"),n.math.Coordinate=function(e,t){this.x=n.isDef(e)?e:0,this.y=n.isDef(t)?t:0},n.math.Coordinate.prototype.clone=function(){return new n.math.Coordinate(this.x,this.y)},n.DEBUG&&(n.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"}),n.math.Coordinate.equals=function(e,t){return e==t||!(!e||!t)&&(e.x==t.x&&e.y==t.y)},n.math.Coordinate.distance=function(e,t){var r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)},n.math.Coordinate.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.math.Coordinate.azimuth=function(e){return n.math.angle(0,0,e.x,e.y)},n.math.Coordinate.squaredDistance=function(e,t){var r=e.x-t.x,n=e.y-t.y;return r*r+n*n},n.math.Coordinate.difference=function(e,t){return new n.math.Coordinate(e.x-t.x,e.y-t.y)},n.math.Coordinate.sum=function(e,t){return new n.math.Coordinate(e.x+t.x,e.y+t.y)},n.math.Coordinate.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},n.math.Coordinate.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},n.math.Coordinate.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},n.math.Coordinate.prototype.translate=function(e,t){return e instanceof n.math.Coordinate?(this.x+=e.x,this.y+=e.y):(this.x+=e,n.isNumber(t)&&(this.y+=t)),this},n.math.Coordinate.prototype.scale=function(e,t){var r=n.isNumber(t)?t:e;return this.x*=e,this.y*=r,this},n.math.Coordinate.prototype.rotateRadians=function(e,t){var r=t||new n.math.Coordinate(0,0),i=this.x,o=this.y,s=Math.cos(e),a=Math.sin(e);this.x=(i-r.x)*s-(o-r.y)*a+r.x,this.y=(i-r.x)*a+(o-r.y)*s+r.y},n.math.Coordinate.prototype.rotateDegrees=function(e,t){this.rotateRadians(n.math.toRadians(e),t)},n.provide("goog.dom"),n.provide("goog.dom.Appendable"),n.provide("goog.dom.DomHelper"),n.require("goog.array"),n.require("goog.asserts"),n.require("goog.dom.BrowserFeature"),n.require("goog.dom.NodeType"),n.require("goog.dom.TagName"),n.require("goog.dom.classes"),n.require("goog.functions"),n.require("goog.math.Coordinate"),n.require("goog.math.Size"),n.require("goog.object"),n.require("goog.string"),n.require("goog.userAgent"),n.define("goog.dom.ASSUME_QUIRKS_MODE",!1),n.define("goog.dom.ASSUME_STANDARDS_MODE",!1),n.dom.COMPAT_MODE_KNOWN_=n.dom.ASSUME_QUIRKS_MODE||n.dom.ASSUME_STANDARDS_MODE,n.dom.getDomHelper=function(e){return e?new n.dom.DomHelper(n.dom.getOwnerDocument(e)):n.dom.defaultDomHelper_||(n.dom.defaultDomHelper_=new n.dom.DomHelper)},n.dom.defaultDomHelper_,n.dom.getDocument=function(){return document},n.dom.getElement=function(e){return n.dom.getElementHelper_(document,e)},n.dom.getElementHelper_=function(e,t){return n.isString(t)?e.getElementById(t):t},n.dom.getRequiredElement=function(e){return n.dom.getRequiredElementHelper_(document,e)},n.dom.getRequiredElementHelper_=function(e,t){n.asserts.assertString(t);var r=n.dom.getElementHelper_(e,t);return r=n.asserts.assertElement(r,"No element found with id: "+t)},n.dom.$=n.dom.getElement,n.dom.getElementsByTagNameAndClass=function(e,t,r){return n.dom.getElementsByTagNameAndClass_(document,e,t,r)},n.dom.getElementsByClass=function(e,t){var r=t||document;return n.dom.canUseQuerySelector_(r)?r.querySelectorAll("."+e):n.dom.getElementsByTagNameAndClass_(document,"*",e,t)},n.dom.getElementByClass=function(e,t){var r=t||document;return(n.dom.canUseQuerySelector_(r)?r.querySelector("."+e):n.dom.getElementsByTagNameAndClass_(document,"*",e,t)[0])||null},n.dom.getRequiredElementByClass=function(e,t){var r=n.dom.getElementByClass(e,t);return n.asserts.assert(r,"No element found with className: "+e)},n.dom.canUseQuerySelector_=function(e){return!(!e.querySelectorAll||!e.querySelector)},n.dom.getElementsByTagNameAndClass_=function(e,t,r,i){var o=i||e,s=t&&"*"!=t?t.toUpperCase():"";if(n.dom.canUseQuerySelector_(o)&&(s||r)){var a=s+(r?"."+r:"");return o.querySelectorAll(a)}if(r&&o.getElementsByClassName){var l=o.getElementsByClassName(r);if(s){for(var h,p={},g=0,u=0;h=l[u];u++)s==h.nodeName&&(p[g++]=h);return p.length=g,p}return l}var l=o.getElementsByTagName(s||"*");if(r){for(var h,p={},g=0,u=0;h=l[u];u++){var c=h.className;"function"==typeof c.split&&n.array.contains(c.split(/\s+/),r)&&(p[g++]=h)}return p.length=g,p}return l},n.dom.$$=n.dom.getElementsByTagNameAndClass,n.dom.setProperties=function(e,t){n.object.forEach(t,function(t,r){"style"==r?e.style.cssText=t:"class"==r?e.className=t:"for"==r?e.htmlFor=t:r in n.dom.DIRECT_ATTRIBUTE_MAP_?e.setAttribute(n.dom.DIRECT_ATTRIBUTE_MAP_[r],t):n.string.startsWith(r,"aria-")||n.string.startsWith(r,"data-")?e.setAttribute(r,t):e[r]=t})},n.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},n.dom.getViewportSize=function(e){return n.dom.getViewportSize_(e||window)},n.dom.getViewportSize_=function(e){var t=e.document,r=n.dom.isCss1CompatMode_(t)?t.documentElement:t.body;return new n.math.Size(r.clientWidth,r.clientHeight)},n.dom.getDocumentHeight=function(){return n.dom.getDocumentHeight_(window)};n.dom.getDocumentHeight_=function(e){var t=e.document,r=0;if(t){var i=t.body,o=t.documentElement;if(!i&&!o)return 0;var s=n.dom.getViewportSize_(e).height;if(n.dom.isCss1CompatMode_(t)&&o.scrollHeight)r=o.scrollHeight!=s?o.scrollHeight:o.offsetHeight;else{var a=o.scrollHeight,l=o.offsetHeight;o.clientHeight!=l&&(a=i.scrollHeight,l=i.offsetHeight),r=a>s?a>l?a:l:a<l?a:l}}return r},n.dom.getPageScroll=function(e){var t=e||n.global||window;return n.dom.getDomHelper(t.document).getDocumentScroll()},n.dom.getDocumentScroll=function(){return n.dom.getDocumentScroll_(document)},n.dom.getDocumentScroll_=function(e){var t=n.dom.getDocumentScrollElement_(e),r=n.dom.getWindow_(e);return n.userAgent.IE&&n.userAgent.isVersionOrHigher("10")&&r.pageYOffset!=t.scrollTop?new n.math.Coordinate(t.scrollLeft,t.scrollTop):new n.math.Coordinate(r.pageXOffset||t.scrollLeft,r.pageYOffset||t.scrollTop)},n.dom.getDocumentScrollElement=function(){return n.dom.getDocumentScrollElement_(document)},n.dom.getDocumentScrollElement_=function(e){return!n.userAgent.WEBKIT&&n.dom.isCss1CompatMode_(e)?e.documentElement:e.body||e.documentElement},n.dom.getWindow=function(e){return e?n.dom.getWindow_(e):window},n.dom.getWindow_=function(e){return e.parentWindow||e.defaultView},n.dom.createDom=function(e,t,r){return n.dom.createDom_(document,arguments)},n.dom.createDom_=function(e,t){var r=t[0],i=t[1];if(!n.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&i&&(i.name||i.type)){var o=["<",r];if(i.name&&o.push(' name="',n.string.htmlEscape(i.name),'"'),i.type){o.push(' type="',n.string.htmlEscape(i.type),'"');var s={};n.object.extend(s,i),delete s.type,i=s}o.push(">"),r=o.join("")}var a=e.createElement(r);return i&&(n.isString(i)?a.className=i:n.isArray(i)?n.dom.classes.add.apply(null,[a].concat(i)):n.dom.setProperties(a,i)),t.length>2&&n.dom.append_(e,a,t,2),a},n.dom.append_=function(e,t,r,i){function o(r){r&&t.appendChild(n.isString(r)?e.createTextNode(r):r)}for(var s=i;s<r.length;s++){var a=r[s];n.isArrayLike(a)&&!n.dom.isNodeLike(a)?n.array.forEach(n.dom.isNodeList(a)?n.array.toArray(a):a,o):o(a)}},n.dom.$dom=n.dom.createDom,n.dom.createElement=function(e){return document.createElement(e)},n.dom.createTextNode=function(e){return document.createTextNode(String(e))},n.dom.createTable=function(e,t,r){return n.dom.createTable_(document,e,t,!!r)},n.dom.createTable_=function(e,t,r,i){for(var o=["<tr>"],s=0;s<r;s++)o.push(i?"<td>&nbsp;</td>":"<td></td>");o.push("</tr>"),o=o.join("");var a=["<table>"];for(s=0;s<t;s++)a.push(o);a.push("</table>");var l=e.createElement(n.dom.TagName.DIV);return l.innerHTML=a.join(""),l.removeChild(l.firstChild)},n.dom.htmlToDocumentFragment=function(e){return n.dom.htmlToDocumentFragment_(document,e)},n.dom.htmlToDocumentFragment_=function(e,t){var r=e.createElement("div");if(n.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT?(r.innerHTML="<br>"+t,r.removeChild(r.firstChild)):r.innerHTML=t,1==r.childNodes.length)return r.removeChild(r.firstChild);for(var i=e.createDocumentFragment();r.firstChild;)i.appendChild(r.firstChild);return i},n.dom.isCss1CompatMode=function(){return n.dom.isCss1CompatMode_(document)},n.dom.isCss1CompatMode_=function(e){return n.dom.COMPAT_MODE_KNOWN_?n.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==e.compatMode},n.dom.canHaveChildren=function(e){if(e.nodeType!=n.dom.NodeType.ELEMENT)return!1;switch(e.tagName){case n.dom.TagName.APPLET:case n.dom.TagName.AREA:case n.dom.TagName.BASE:case n.dom.TagName.BR:case n.dom.TagName.COL:case n.dom.TagName.COMMAND:case n.dom.TagName.EMBED:case n.dom.TagName.FRAME:case n.dom.TagName.HR:case n.dom.TagName.IMG:case n.dom.TagName.INPUT:case n.dom.TagName.IFRAME:case n.dom.TagName.ISINDEX:case n.dom.TagName.KEYGEN:case n.dom.TagName.LINK:case n.dom.TagName.NOFRAMES:case n.dom.TagName.NOSCRIPT:case n.dom.TagName.META:case n.dom.TagName.OBJECT:case n.dom.TagName.PARAM:case n.dom.TagName.SCRIPT:case n.dom.TagName.SOURCE:case n.dom.TagName.STYLE:case n.dom.TagName.TRACK:case n.dom.TagName.WBR:return!1}return!0},n.dom.appendChild=function(e,t){e.appendChild(t)},n.dom.append=function(e,t){n.dom.append_(n.dom.getOwnerDocument(e),e,arguments,1)},n.dom.removeChildren=function(e){for(var t;t=e.firstChild;)e.removeChild(t)},n.dom.insertSiblingBefore=function(e,t){t.parentNode&&t.parentNode.insertBefore(e,t)},n.dom.insertSiblingAfter=function(e,t){t.parentNode&&t.parentNode.insertBefore(e,t.nextSibling)},n.dom.insertChildAt=function(e,t,r){e.insertBefore(t,e.childNodes[r]||null)},n.dom.removeNode=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},n.dom.replaceNode=function(e,t){var r=t.parentNode;r&&r.replaceChild(e,t)},n.dom.flattenElement=function(e){var t,r=e.parentNode;if(r&&r.nodeType!=n.dom.NodeType.DOCUMENT_FRAGMENT){if(e.removeNode)return e.removeNode(!1);for(;t=e.firstChild;)r.insertBefore(t,e);return n.dom.removeNode(e)}},n.dom.getChildren=function(e){return n.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=e.children?e.children:n.array.filter(e.childNodes,function(e){return e.nodeType==n.dom.NodeType.ELEMENT})},n.dom.getFirstElementChild=function(e){return void 0!=e.firstElementChild?e.firstElementChild:n.dom.getNextElementNode_(e.firstChild,!0)},n.dom.getLastElementChild=function(e){return void 0!=e.lastElementChild?e.lastElementChild:n.dom.getNextElementNode_(e.lastChild,!1)},n.dom.getNextElementSibling=function(e){return void 0!=e.nextElementSibling?e.nextElementSibling:n.dom.getNextElementNode_(e.nextSibling,!0)},n.dom.getPreviousElementSibling=function(e){return void 0!=e.previousElementSibling?e.previousElementSibling:n.dom.getNextElementNode_(e.previousSibling,!1)},n.dom.getNextElementNode_=function(e,t){for(;e&&e.nodeType!=n.dom.NodeType.ELEMENT;)e=t?e.nextSibling:e.previousSibling;return e},n.dom.getNextNode=function(e){if(!e)return null;if(e.firstChild)return e.firstChild;for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null},n.dom.getPreviousNode=function(e){if(!e)return null;if(!e.previousSibling)return e.parentNode;for(e=e.previousSibling;e&&e.lastChild;)e=e.lastChild;return e},n.dom.isNodeLike=function(e){return n.isObject(e)&&e.nodeType>0},n.dom.isElement=function(e){return n.isObject(e)&&e.nodeType==n.dom.NodeType.ELEMENT},n.dom.isWindow=function(e){return n.isObject(e)&&e.window==e},n.dom.getParentElement=function(e){var t;if(n.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY){if(!(n.userAgent.IE&&n.userAgent.isVersionOrHigher("9")&&!n.userAgent.isVersionOrHigher("10")&&n.global.SVGElement&&e instanceof n.global.SVGElement)&&(t=e.parentElement))return t}return t=e.parentNode,n.dom.isElement(t)?t:null},n.dom.contains=function(e,t){if(e.contains&&t.nodeType==n.dom.NodeType.ELEMENT)return e==t||e.contains(t);if(void 0!==e.compareDocumentPosition)return e==t||Boolean(16&e.compareDocumentPosition(t));for(;t&&e!=t;)t=t.parentNode;return t==e},n.dom.compareNodeOrder=function(e,t){if(e==t)return 0;if(e.compareDocumentPosition)return 2&e.compareDocumentPosition(t)?1:-1;if(n.userAgent.IE&&!n.userAgent.isDocumentModeOrHigher(9)){if(e.nodeType==n.dom.NodeType.DOCUMENT)return-1;if(t.nodeType==n.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in e||e.parentNode&&"sourceIndex"in e.parentNode){var r=e.nodeType==n.dom.NodeType.ELEMENT,i=t.nodeType==n.dom.NodeType.ELEMENT;if(r&&i)return e.sourceIndex-t.sourceIndex;var o=e.parentNode,s=t.parentNode;return o==s?n.dom.compareSiblingOrder_(e,t):!r&&n.dom.contains(o,t)?-1*n.dom.compareParentsDescendantNodeIe_(e,t):!i&&n.dom.contains(s,e)?n.dom.compareParentsDescendantNodeIe_(t,e):(r?e.sourceIndex:o.sourceIndex)-(i?t.sourceIndex:s.sourceIndex)}var a,l,h=n.dom.getOwnerDocument(e);return a=h.createRange(),a.selectNode(e),a.collapse(!0),l=h.createRange(),l.selectNode(t),l.collapse(!0),a.compareBoundaryPoints(n.global.Range.START_TO_END,l)},n.dom.compareParentsDescendantNodeIe_=function(e,t){var r=e.parentNode;if(r==t)return-1;for(var i=t;i.parentNode!=r;)i=i.parentNode;return n.dom.compareSiblingOrder_(i,e)},n.dom.compareSiblingOrder_=function(e,t){for(var r=t;r=r.previousSibling;)if(r==e)return-1;return 1},n.dom.findCommonAncestor=function(e){var t,r=arguments.length;if(!r)return null;if(1==r)return arguments[0];var n=[],i=1/0;for(t=0;t<r;t++){for(var o=[],s=arguments[t];s;)o.unshift(s),s=s.parentNode;n.push(o),i=Math.min(i,o.length)}var a=null;for(t=0;t<i;t++){for(var l=n[0][t],h=1;h<r;h++)if(l!=n[h][t])return a;a=l}return a},n.dom.getOwnerDocument=function(e){return n.asserts.assert(e,"Node cannot be null or undefined."),e.nodeType==n.dom.NodeType.DOCUMENT?e:e.ownerDocument||e.document},n.dom.getFrameContentDocument=function(e){return e.contentDocument||e.contentWindow.document},n.dom.getFrameContentWindow=function(e){return e.contentWindow||n.dom.getWindow(n.dom.getFrameContentDocument(e))},n.dom.setTextContent=function(e,t){if(n.asserts.assert(null!=e,"goog.dom.setTextContent expects a non-null value for node"),"textContent"in e)e.textContent=t;else if(e.nodeType==n.dom.NodeType.TEXT)e.data=t;else if(e.firstChild&&e.firstChild.nodeType==n.dom.NodeType.TEXT){for(;e.lastChild!=e.firstChild;)e.removeChild(e.lastChild);e.firstChild.data=t}else{n.dom.removeChildren(e);var r=n.dom.getOwnerDocument(e);e.appendChild(r.createTextNode(String(t)))}},n.dom.getOuterHtml=function(e){if("outerHTML"in e)return e.outerHTML;var t=n.dom.getOwnerDocument(e),r=t.createElement("div");return r.appendChild(e.cloneNode(!0)),r.innerHTML},n.dom.findNode=function(e,t){var r=[];return n.dom.findNodes_(e,t,r,!0)?r[0]:void 0},n.dom.findNodes=function(e,t){var r=[];return n.dom.findNodes_(e,t,r,!1),r},n.dom.findNodes_=function(e,t,r,i){if(null!=e)for(var o=e.firstChild;o;){if(t(o)&&(r.push(o),i))return!0;if(n.dom.findNodes_(o,t,r,i))return!0;o=o.nextSibling}return!1},n.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},n.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"},n.dom.isFocusableTabIndex=function(e){return n.dom.hasSpecifiedTabIndex_(e)&&n.dom.isTabIndexFocusable_(e)},n.dom.setFocusableTabIndex=function(e,t){t?e.tabIndex=0:(e.tabIndex=-1,e.removeAttribute("tabIndex"))},n.dom.isFocusable=function(e){var t;return t=n.dom.nativelySupportsFocus_(e)?!e.disabled&&(!n.dom.hasSpecifiedTabIndex_(e)||n.dom.isTabIndexFocusable_(e)):n.dom.isFocusableTabIndex(e),t&&n.userAgent.IE?n.dom.hasNonZeroBoundingRect_(e):t},n.dom.hasSpecifiedTabIndex_=function(e){var t=e.getAttributeNode("tabindex");return n.isDefAndNotNull(t)&&t.specified},n.dom.isTabIndexFocusable_=function(e){var t=e.tabIndex;return n.isNumber(t)&&t>=0&&t<32768},n.dom.nativelySupportsFocus_=function(e){return e.tagName==n.dom.TagName.A||e.tagName==n.dom.TagName.INPUT||e.tagName==n.dom.TagName.TEXTAREA||e.tagName==n.dom.TagName.SELECT||e.tagName==n.dom.TagName.BUTTON},n.dom.hasNonZeroBoundingRect_=function(e){var t=n.isFunction(e.getBoundingClientRect)?e.getBoundingClientRect():{height:e.offsetHeight,width:e.offsetWidth};return n.isDefAndNotNull(t)&&t.height>0&&t.width>0},n.dom.getTextContent=function(e){var t;if(n.dom.BrowserFeature.CAN_USE_INNER_TEXT&&"innerText"in e)t=n.string.canonicalizeNewlines(e.innerText);else{var r=[];n.dom.getTextContent_(e,r,!0),t=r.join("")}return t=t.replace(/ \xAD /g," ").replace(/\xAD/g,""),t=t.replace(/\u200B/g,""),n.dom.BrowserFeature.CAN_USE_INNER_TEXT||(t=t.replace(/ +/g," "))," "!=t&&(t=t.replace(/^\s*/,"")),t},n.dom.getRawTextContent=function(e){var t=[];return n.dom.getTextContent_(e,t,!1),t.join("")},n.dom.getTextContent_=function(e,t,r){if(e.nodeName in n.dom.TAGS_TO_IGNORE_);else if(e.nodeType==n.dom.NodeType.TEXT)r?t.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(e.nodeValue);else if(e.nodeName in n.dom.PREDEFINED_TAG_VALUES_)t.push(n.dom.PREDEFINED_TAG_VALUES_[e.nodeName]);else for(var i=e.firstChild;i;)n.dom.getTextContent_(i,t,r),i=i.nextSibling},n.dom.getNodeTextLength=function(e){return n.dom.getTextContent(e).length},n.dom.getNodeTextOffset=function(e,t){for(var r=t||n.dom.getOwnerDocument(e).body,i=[];e&&e!=r;){for(var o=e;o=o.previousSibling;)i.unshift(n.dom.getTextContent(o));e=e.parentNode}return n.string.trimLeft(i.join("")).replace(/ +/g," ").length},n.dom.getNodeAtOffset=function(e,t,r){for(var i=[e],o=0,s=null;i.length>0&&o<t;)if(s=i.pop(),s.nodeName in n.dom.TAGS_TO_IGNORE_);else if(s.nodeType==n.dom.NodeType.TEXT){var a=s.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");o+=a.length}else if(s.nodeName in n.dom.PREDEFINED_TAG_VALUES_)o+=n.dom.PREDEFINED_TAG_VALUES_[s.nodeName].length;else for(var l=s.childNodes.length-1;l>=0;l--)i.push(s.childNodes[l]);return n.isObject(r)&&(r.remainder=s?s.nodeValue.length+t-o-1:0,r.node=s),s},n.dom.isNodeList=function(e){if(e&&"number"==typeof e.length){if(n.isObject(e))return"function"==typeof e.item||"string"==typeof e.item;if(n.isFunction(e))return"function"==typeof e.item}return!1},n.dom.getAncestorByTagNameAndClass=function(e,t,r){if(!t&&!r)return null;var i=t?t.toUpperCase():null;return n.dom.getAncestor(e,function(e){return(!i||e.nodeName==i)&&(!r||n.dom.classes.has(e,r))},!0)},n.dom.getAncestorByClass=function(e,t){return n.dom.getAncestorByTagNameAndClass(e,null,t)},n.dom.getAncestor=function(e,t,r,n){r||(e=e.parentNode);for(var i=null==n,o=0;e&&(i||o<=n);){if(t(e))return e;e=e.parentNode,o++}return null},n.dom.getActiveElement=function(e){try{return e&&e.activeElement}catch(e){}return null},n.dom.devicePixelRatio_,n.dom.getPixelRatio=n.functions.cacheReturnValue(function(){var e=n.dom.getWindow(),t=n.userAgent.GECKO&&n.userAgent.MOBILE;return n.isDef(e.devicePixelRatio)&&!t?e.devicePixelRatio:e.matchMedia?n.dom.matchesPixelRatio_(.75)||n.dom.matchesPixelRatio_(1.5)||n.dom.matchesPixelRatio_(2)||n.dom.matchesPixelRatio_(3)||1:1}),n.dom.matchesPixelRatio_=function(e){var t=n.dom.getWindow(),r="(-webkit-min-device-pixel-ratio: "+e+"),(min--moz-device-pixel-ratio: "+e+"),(min-resolution: "+e+"dppx)";return t.matchMedia(r).matches?e:0},n.dom.DomHelper=function(e){this.document_=e||n.global.document||document},n.dom.DomHelper.prototype.getDomHelper=n.dom.getDomHelper,n.dom.DomHelper.prototype.setDocument=function(e){this.document_=e},n.dom.DomHelper.prototype.getDocument=function(){return this.document_},n.dom.DomHelper.prototype.getElement=function(e){return n.dom.getElementHelper_(this.document_,e)},n.dom.DomHelper.prototype.getRequiredElement=function(e){return n.dom.getRequiredElementHelper_(this.document_,e)},n.dom.DomHelper.prototype.$=n.dom.DomHelper.prototype.getElement,n.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(e,t,r){return n.dom.getElementsByTagNameAndClass_(this.document_,e,t,r)},n.dom.DomHelper.prototype.getElementsByClass=function(e,t){var r=t||this.document_;return n.dom.getElementsByClass(e,r)},n.dom.DomHelper.prototype.getElementByClass=function(e,t){var r=t||this.document_;return n.dom.getElementByClass(e,r)},n.dom.DomHelper.prototype.getRequiredElementByClass=function(e,t){var r=t||this.document_;return n.dom.getRequiredElementByClass(e,r)},n.dom.DomHelper.prototype.$$=n.dom.DomHelper.prototype.getElementsByTagNameAndClass,n.dom.DomHelper.prototype.setProperties=n.dom.setProperties,n.dom.DomHelper.prototype.getViewportSize=function(e){return n.dom.getViewportSize(e||this.getWindow())},n.dom.DomHelper.prototype.getDocumentHeight=function(){return n.dom.getDocumentHeight_(this.getWindow())},n.dom.Appendable,n.dom.DomHelper.prototype.createDom=function(e,t,r){return n.dom.createDom_(this.document_,arguments)},n.dom.DomHelper.prototype.$dom=n.dom.DomHelper.prototype.createDom,n.dom.DomHelper.prototype.createElement=function(e){return this.document_.createElement(e)},n.dom.DomHelper.prototype.createTextNode=function(e){return this.document_.createTextNode(String(e))},n.dom.DomHelper.prototype.createTable=function(e,t,r){return n.dom.createTable_(this.document_,e,t,!!r)},n.dom.DomHelper.prototype.htmlToDocumentFragment=function(e){return n.dom.htmlToDocumentFragment_(this.document_,e)},n.dom.DomHelper.prototype.isCss1CompatMode=function(){return n.dom.isCss1CompatMode_(this.document_)},n.dom.DomHelper.prototype.getWindow=function(){return n.dom.getWindow_(this.document_)},n.dom.DomHelper.prototype.getDocumentScrollElement=function(){return n.dom.getDocumentScrollElement_(this.document_)},n.dom.DomHelper.prototype.getDocumentScroll=function(){return n.dom.getDocumentScroll_(this.document_)},n.dom.DomHelper.prototype.getActiveElement=function(e){return n.dom.getActiveElement(e||this.document_)},n.dom.DomHelper.prototype.appendChild=n.dom.appendChild,n.dom.DomHelper.prototype.append=n.dom.append,n.dom.DomHelper.prototype.canHaveChildren=n.dom.canHaveChildren,n.dom.DomHelper.prototype.removeChildren=n.dom.removeChildren,n.dom.DomHelper.prototype.insertSiblingBefore=n.dom.insertSiblingBefore,n.dom.DomHelper.prototype.insertSiblingAfter=n.dom.insertSiblingAfter,n.dom.DomHelper.prototype.insertChildAt=n.dom.insertChildAt,n.dom.DomHelper.prototype.removeNode=n.dom.removeNode,n.dom.DomHelper.prototype.replaceNode=n.dom.replaceNode,n.dom.DomHelper.prototype.flattenElement=n.dom.flattenElement,n.dom.DomHelper.prototype.getChildren=n.dom.getChildren,n.dom.DomHelper.prototype.getFirstElementChild=n.dom.getFirstElementChild,n.dom.DomHelper.prototype.getLastElementChild=n.dom.getLastElementChild,n.dom.DomHelper.prototype.getNextElementSibling=n.dom.getNextElementSibling,n.dom.DomHelper.prototype.getPreviousElementSibling=n.dom.getPreviousElementSibling,n.dom.DomHelper.prototype.getNextNode=n.dom.getNextNode,n.dom.DomHelper.prototype.getPreviousNode=n.dom.getPreviousNode,n.dom.DomHelper.prototype.isNodeLike=n.dom.isNodeLike,n.dom.DomHelper.prototype.isElement=n.dom.isElement,n.dom.DomHelper.prototype.isWindow=n.dom.isWindow,n.dom.DomHelper.prototype.getParentElement=n.dom.getParentElement,n.dom.DomHelper.prototype.contains=n.dom.contains,n.dom.DomHelper.prototype.compareNodeOrder=n.dom.compareNodeOrder,n.dom.DomHelper.prototype.findCommonAncestor=n.dom.findCommonAncestor,n.dom.DomHelper.prototype.getOwnerDocument=n.dom.getOwnerDocument,n.dom.DomHelper.prototype.getFrameContentDocument=n.dom.getFrameContentDocument,n.dom.DomHelper.prototype.getFrameContentWindow=n.dom.getFrameContentWindow,n.dom.DomHelper.prototype.setTextContent=n.dom.setTextContent,n.dom.DomHelper.prototype.getOuterHtml=n.dom.getOuterHtml,n.dom.DomHelper.prototype.findNode=n.dom.findNode,n.dom.DomHelper.prototype.findNodes=n.dom.findNodes,n.dom.DomHelper.prototype.isFocusableTabIndex=n.dom.isFocusableTabIndex,n.dom.DomHelper.prototype.setFocusableTabIndex=n.dom.setFocusableTabIndex,n.dom.DomHelper.prototype.isFocusable=n.dom.isFocusable,n.dom.DomHelper.prototype.getTextContent=n.dom.getTextContent,n.dom.DomHelper.prototype.getNodeTextLength=n.dom.getNodeTextLength,n.dom.DomHelper.prototype.getNodeTextOffset=n.dom.getNodeTextOffset,n.dom.DomHelper.prototype.getNodeAtOffset=n.dom.getNodeAtOffset,n.dom.DomHelper.prototype.isNodeList=n.dom.isNodeList,n.dom.DomHelper.prototype.getAncestorByTagNameAndClass=n.dom.getAncestorByTagNameAndClass,n.dom.DomHelper.prototype.getAncestorByClass=n.dom.getAncestorByClass,n.dom.DomHelper.prototype.getAncestor=n.dom.getAncestor,n.provide("goog.math.Box"),n.require("goog.math.Coordinate"),n.math.Box=function(e,t,r,n){this.top=e,this.right=t,this.bottom=r,this.left=n},n.math.Box.boundingBox=function(e){for(var t=new n.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x),r=1;r<arguments.length;r++){var i=arguments[r];t.top=Math.min(t.top,i.y),t.right=Math.max(t.right,i.x),t.bottom=Math.max(t.bottom,i.y),t.left=Math.min(t.left,i.x)}return t},n.math.Box.prototype.clone=function(){return new n.math.Box(this.top,this.right,this.bottom,this.left)},n.DEBUG&&(n.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"}),n.math.Box.prototype.contains=function(e){return n.math.Box.contains(this,e)},n.math.Box.prototype.expand=function(e,t,r,i){return n.isObject(e)?(this.top-=e.top,this.right+=e.right,this.bottom+=e.bottom,this.left-=e.left):(this.top-=e,this.right+=t,this.bottom+=r,this.left-=i),this},n.math.Box.prototype.expandToInclude=function(e){this.left=Math.min(this.left,e.left),this.top=Math.min(this.top,e.top),this.right=Math.max(this.right,e.right),this.bottom=Math.max(this.bottom,e.bottom)},n.math.Box.equals=function(e,t){return e==t||!(!e||!t)&&(e.top==t.top&&e.right==t.right&&e.bottom==t.bottom&&e.left==t.left)},n.math.Box.contains=function(e,t){return!(!e||!t)&&(t instanceof n.math.Box?t.left>=e.left&&t.right<=e.right&&t.top>=e.top&&t.bottom<=e.bottom:t.x>=e.left&&t.x<=e.right&&t.y>=e.top&&t.y<=e.bottom)},n.math.Box.relativePositionX=function(e,t){return t.x<e.left?t.x-e.left:t.x>e.right?t.x-e.right:0},n.math.Box.relativePositionY=function(e,t){return t.y<e.top?t.y-e.top:t.y>e.bottom?t.y-e.bottom:0},n.math.Box.distance=function(e,t){var r=n.math.Box.relativePositionX(e,t),i=n.math.Box.relativePositionY(e,t);return Math.sqrt(r*r+i*i)},n.math.Box.intersects=function(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom},n.math.Box.intersectsWithPadding=function(e,t,r){return e.left<=t.right+r&&t.left<=e.right+r&&e.top<=t.bottom+r&&t.top<=e.bottom+r},n.math.Box.prototype.ceil=function(){return this.top=Math.ceil(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this.left=Math.ceil(this.left),this},n.math.Box.prototype.floor=function(){return this.top=Math.floor(this.top),this.right=Math.floor(this.right),this.bottom=Math.floor(this.bottom),this.left=Math.floor(this.left),this},n.math.Box.prototype.round=function(){return this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this.left=Math.round(this.left),this},n.math.Box.prototype.translate=function(e,t){return e instanceof n.math.Coordinate?(this.left+=e.x,this.right+=e.x,this.top+=e.y,this.bottom+=e.y):(this.left+=e,this.right+=e,n.isNumber(t)&&(this.top+=t,this.bottom+=t)),this},n.math.Box.prototype.scale=function(e,t){var r=n.isNumber(t)?t:e;return this.left*=e,this.right*=e,this.top*=r,this.bottom*=r,this},n.provide("goog.math.Rect"),n.require("goog.math.Box"),n.require("goog.math.Coordinate"),n.require("goog.math.Size"),n.math.Rect=function(e,t,r,n){this.left=e,this.top=t,this.width=r,this.height=n},n.math.Rect.prototype.clone=function(){return new n.math.Rect(this.left,this.top,this.width,this.height)},n.math.Rect.prototype.toBox=function(){var e=this.left+this.width,t=this.top+this.height;return new n.math.Box(this.top,e,t,this.left)},n.math.Rect.createFromBox=function(e){return new n.math.Rect(e.left,e.top,e.right-e.left,e.bottom-e.top)},n.DEBUG&&(n.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"}),n.math.Rect.equals=function(e,t){return e==t||!(!e||!t)&&(e.left==t.left&&e.width==t.width&&e.top==t.top&&e.height==t.height)},n.math.Rect.prototype.intersection=function(e){var t=Math.max(this.left,e.left),r=Math.min(this.left+this.width,e.left+e.width);if(t<=r){var n=Math.max(this.top,e.top),i=Math.min(this.top+this.height,e.top+e.height);if(n<=i)return this.left=t,this.top=n,this.width=r-t,this.height=i-n,!0}return!1},n.math.Rect.intersection=function(e,t){var r=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width);if(r<=i){var o=Math.max(e.top,t.top),s=Math.min(e.top+e.height,t.top+t.height);if(o<=s)return new n.math.Rect(r,o,i-r,s-o)}return null},n.math.Rect.intersects=function(e,t){return e.left<=t.left+t.width&&t.left<=e.left+e.width&&e.top<=t.top+t.height&&t.top<=e.top+e.height},n.math.Rect.prototype.intersects=function(e){return n.math.Rect.intersects(this,e)},n.math.Rect.difference=function(e,t){var r=n.math.Rect.intersection(e,t);if(!r||!r.height||!r.width)return[e.clone()];var i=[],o=e.top,s=e.height,a=e.left+e.width,l=e.top+e.height,h=t.left+t.width,p=t.top+t.height;return t.top>e.top&&(i.push(new n.math.Rect(e.left,e.top,e.width,t.top-e.top)),o=t.top,s-=t.top-e.top),p<l&&(i.push(new n.math.Rect(e.left,p,e.width,l-p)),s=p-o),t.left>e.left&&i.push(new n.math.Rect(e.left,o,t.left-e.left,s)),h<a&&i.push(new n.math.Rect(h,o,a-h,s)),i},n.math.Rect.prototype.difference=function(e){return n.math.Rect.difference(this,e)},n.math.Rect.prototype.boundingRect=function(e){var t=Math.max(this.left+this.width,e.left+e.width),r=Math.max(this.top+this.height,e.top+e.height);this.left=Math.min(this.left,e.left),this.top=Math.min(this.top,e.top),this.width=t-this.left,this.height=r-this.top},n.math.Rect.boundingRect=function(e,t){if(!e||!t)return null;var r=e.clone();return r.boundingRect(t),r},n.math.Rect.prototype.contains=function(e){return e instanceof n.math.Rect?this.left<=e.left&&this.left+this.width>=e.left+e.width&&this.top<=e.top&&this.top+this.height>=e.top+e.height:e.x>=this.left&&e.x<=this.left+this.width&&e.y>=this.top&&e.y<=this.top+this.height},n.math.Rect.prototype.squaredDistance=function(e){var t=e.x<this.left?this.left-e.x:Math.max(e.x-(this.left+this.width),0),r=e.y<this.top?this.top-e.y:Math.max(e.y-(this.top+this.height),0);return t*t+r*r},n.math.Rect.prototype.distance=function(e){return Math.sqrt(this.squaredDistance(e))},n.math.Rect.prototype.getSize=function(){return new n.math.Size(this.width,this.height)},n.math.Rect.prototype.getTopLeft=function(){return new n.math.Coordinate(this.left,this.top)},n.math.Rect.prototype.getCenter=function(){return new n.math.Coordinate(this.left+this.width/2,this.top+this.height/2)},n.math.Rect.prototype.getBottomRight=function(){return new n.math.Coordinate(this.left+this.width,this.top+this.height)},n.math.Rect.prototype.ceil=function(){return this.left=Math.ceil(this.left),this.top=Math.ceil(this.top),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},n.math.Rect.prototype.floor=function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},n.math.Rect.prototype.round=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.width=Math.round(this.width),this.height=Math.round(this.height),this},n.math.Rect.prototype.translate=function(e,t){return e instanceof n.math.Coordinate?(this.left+=e.x,this.top+=e.y):(this.left+=e,n.isNumber(t)&&(this.top+=t)),this},n.math.Rect.prototype.scale=function(e,t){var r=n.isNumber(t)?t:e;return this.left*=e,this.width*=e,this.top*=r,this.height*=r,this},n.provide("goog.dom.vendor"),n.require("goog.string");n.require("goog.userAgent"),n.dom.vendor.getVendorJsPrefix=function(){return n.userAgent.WEBKIT?"Webkit":n.userAgent.GECKO?"Moz":n.userAgent.IE?"ms":n.userAgent.OPERA?"O":null},n.dom.vendor.getVendorPrefix=function(){return n.userAgent.WEBKIT?"-webkit":n.userAgent.GECKO?"-moz":n.userAgent.IE?"-ms":n.userAgent.OPERA?"-o":null},n.dom.vendor.getPrefixedPropertyName=function(e,t){if(t&&e in t)return e;var r=n.dom.vendor.getVendorJsPrefix();if(r){r=r.toLowerCase();var i=r+n.string.toTitleCase(e);return!n.isDef(t)||i in t?i:null}return null},n.dom.vendor.getPrefixedEventType=function(e){return((n.dom.vendor.getVendorJsPrefix()||"")+e).toLowerCase()},n.provide("goog.style"),n.require("goog.array"),n.require("goog.asserts"),n.require("goog.dom"),n.require("goog.dom.NodeType"),n.require("goog.dom.vendor"),n.require("goog.math.Box"),n.require("goog.math.Coordinate"),n.require("goog.math.Rect"),n.require("goog.math.Size"),n.require("goog.object"),n.require("goog.string"),n.require("goog.userAgent"),n.define("goog.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS",!1),n.style.setStyle=function(e,t,r){n.isString(t)?n.style.setStyle_(e,r,t):n.object.forEach(t,n.partial(n.style.setStyle_,e))},n.style.setStyle_=function(e,t,r){var i=n.style.getVendorJsStyleName_(e,r);i&&(e.style[i]=t)},n.style.getVendorJsStyleName_=function(e,t){var r=n.string.toCamelCase(t);if(void 0===e.style[r]){var i=n.dom.vendor.getVendorJsPrefix()+n.string.toTitleCase(r);if(void 0!==e.style[i])return i}return r},n.style.getVendorStyleName_=function(e,t){var r=n.string.toCamelCase(t);if(void 0===e.style[r]){var i=n.dom.vendor.getVendorJsPrefix()+n.string.toTitleCase(r);if(void 0!==e.style[i])return n.dom.vendor.getVendorPrefix()+"-"+t}return t},n.style.getStyle=function(e,t){var r=e.style[n.string.toCamelCase(t)];return void 0!==r?r:e.style[n.style.getVendorJsStyleName_(e,t)]||""},n.style.getComputedStyle=function(e,t){var r=n.dom.getOwnerDocument(e);if(r.defaultView&&r.defaultView.getComputedStyle){var i=r.defaultView.getComputedStyle(e,null);if(i)return i[t]||i.getPropertyValue(t)||""}return""},n.style.getCascadedStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:null},n.style.getStyle_=function(e,t){return n.style.getComputedStyle(e,t)||n.style.getCascadedStyle(e,t)||e.style&&e.style[t]},n.style.getComputedBoxSizing=function(e){return n.style.getStyle_(e,"boxSizing")||n.style.getStyle_(e,"MozBoxSizing")||n.style.getStyle_(e,"WebkitBoxSizing")||null},n.style.getComputedPosition=function(e){return n.style.getStyle_(e,"position")},n.style.getBackgroundColor=function(e){return n.style.getStyle_(e,"backgroundColor")},n.style.getComputedOverflowX=function(e){return n.style.getStyle_(e,"overflowX")},n.style.getComputedOverflowY=function(e){return n.style.getStyle_(e,"overflowY")},n.style.getComputedZIndex=function(e){return n.style.getStyle_(e,"zIndex")},n.style.getComputedTextAlign=function(e){return n.style.getStyle_(e,"textAlign")},n.style.getComputedCursor=function(e){return n.style.getStyle_(e,"cursor")},n.style.getComputedTransform=function(e){var t=n.style.getVendorStyleName_(e,"transform");return n.style.getStyle_(e,t)||n.style.getStyle_(e,"transform")},n.style.setPosition=function(e,t,r){var i,o,s=n.userAgent.GECKO&&(n.userAgent.MAC||n.userAgent.X11)&&n.userAgent.isVersionOrHigher("1.9");t instanceof n.math.Coordinate?(i=t.x,o=t.y):(i=t,o=r),e.style.left=n.style.getPixelStyleValue_(i,s),e.style.top=n.style.getPixelStyleValue_(o,s)},n.style.getPosition=function(e){return new n.math.Coordinate(e.offsetLeft,e.offsetTop)},n.style.getClientViewportElement=function(e){var t;return t=e?n.dom.getOwnerDocument(e):n.dom.getDocument(),!n.userAgent.IE||n.userAgent.isDocumentModeOrHigher(9)||n.dom.getDomHelper(t).isCss1CompatMode()?t.documentElement:t.body},n.style.getViewportPageOffset=function(e){var t=e.body,r=e.documentElement,i=t.scrollLeft||r.scrollLeft,o=t.scrollTop||r.scrollTop;return new n.math.Coordinate(i,o)},n.style.getBoundingClientRect_=function(e){var t;try{t=e.getBoundingClientRect()}catch(e){return{left:0,top:0,right:0,bottom:0}}if(n.userAgent.IE&&e.ownerDocument.body){var r=e.ownerDocument;t.left-=r.documentElement.clientLeft+r.body.clientLeft,t.top-=r.documentElement.clientTop+r.body.clientTop}return t},n.style.getOffsetParent=function(e){if(n.userAgent.IE&&!n.userAgent.isDocumentModeOrHigher(8))return e.offsetParent;for(var t=n.dom.getOwnerDocument(e),r=n.style.getStyle_(e,"position"),i="fixed"==r||"absolute"==r,o=e.parentNode;o&&o!=t;o=o.parentNode)if(r=n.style.getStyle_(o,"position"),!(i=i&&"static"==r&&o!=t.documentElement&&o!=t.body)&&(o.scrollWidth>o.clientWidth||o.scrollHeight>o.clientHeight||"fixed"==r||"absolute"==r||"relative"==r))return o;return null},n.style.getVisibleRectForElement=function(e){for(var t=new n.math.Box(0,1/0,1/0,0),r=n.dom.getDomHelper(e),i=r.getDocument().body,o=r.getDocument().documentElement,s=r.getDocumentScrollElement(),a=e;a=n.style.getOffsetParent(a);)if(!(n.userAgent.IE&&0==a.clientWidth||n.userAgent.WEBKIT&&0==a.clientHeight&&a==i||a==i||a==o||"visible"==n.style.getStyle_(a,"overflow"))){var l=n.style.getPageOffset(a),h=n.style.getClientLeftTop(a);l.x+=h.x,l.y+=h.y,t.top=Math.max(t.top,l.y),t.right=Math.min(t.right,l.x+a.clientWidth),t.bottom=Math.min(t.bottom,l.y+a.clientHeight),t.left=Math.max(t.left,l.x)}var p=s.scrollLeft,g=s.scrollTop;t.left=Math.max(t.left,p),t.top=Math.max(t.top,g);var u=r.getViewportSize();return t.right=Math.min(t.right,p+u.width),t.bottom=Math.min(t.bottom,g+u.height),t.top>=0&&t.left>=0&&t.bottom>t.top&&t.right>t.left?t:null},n.style.getContainerOffsetToScrollInto=function(e,t,r){var i=n.style.getPageOffset(e),o=n.style.getPageOffset(t),s=n.style.getBorderBox(t),a=i.x-o.x-s.left,l=i.y-o.y-s.top,h=t.clientWidth-e.offsetWidth,p=t.clientHeight-e.offsetHeight,g=t.scrollLeft,u=t.scrollTop;return r?(g+=a-h/2,u+=l-p/2):(g+=Math.min(a,Math.max(a-h,0)),u+=Math.min(l,Math.max(l-p,0))),new n.math.Coordinate(g,u)},n.style.scrollIntoContainerView=function(e,t,r){var i=n.style.getContainerOffsetToScrollInto(e,t,r);t.scrollLeft=i.x,t.scrollTop=i.y},n.style.getClientLeftTop=function(e){if(n.userAgent.GECKO&&!n.userAgent.isVersionOrHigher("1.9")){var t=parseFloat(n.style.getComputedStyle(e,"borderLeftWidth"));if(n.style.isRightToLeft(e)){t+=e.offsetWidth-e.clientWidth-t-parseFloat(n.style.getComputedStyle(e,"borderRightWidth"))}return new n.math.Coordinate(t,parseFloat(n.style.getComputedStyle(e,"borderTopWidth")))}return new n.math.Coordinate(e.clientLeft,e.clientTop)},n.style.getPageOffset=function(e){var t,r=n.dom.getOwnerDocument(e),i=n.style.getStyle_(e,"position");n.asserts.assertObject(e,"Parameter is required");var o=!n.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS&&n.userAgent.GECKO&&r.getBoxObjectFor&&!e.getBoundingClientRect&&"absolute"==i&&(t=r.getBoxObjectFor(e))&&(t.screenX<0||t.screenY<0),s=new n.math.Coordinate(0,0),a=n.style.getClientViewportElement(r);if(e==a)return s;if(n.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS||e.getBoundingClientRect){t=n.style.getBoundingClientRect_(e);var l=n.dom.getDomHelper(r).getDocumentScroll();s.x=t.left+l.x,s.y=t.top+l.y}else if(r.getBoxObjectFor&&!o){t=r.getBoxObjectFor(e);var h=r.getBoxObjectFor(a);s.x=t.screenX-h.screenX,s.y=t.screenY-h.screenY}else{var p=e;do{if(s.x+=p.offsetLeft,s.y+=p.offsetTop,p!=e&&(s.x+=p.clientLeft||0,s.y+=p.clientTop||0),n.userAgent.WEBKIT&&"fixed"==n.style.getComputedPosition(p)){s.x+=r.body.scrollLeft,s.y+=r.body.scrollTop;break}p=p.offsetParent}while(p&&p!=e);for((n.userAgent.OPERA||n.userAgent.WEBKIT&&"absolute"==i)&&(s.y-=r.body.offsetTop),p=e;(p=n.style.getOffsetParent(p))&&p!=r.body&&p!=a;)s.x-=p.scrollLeft,n.userAgent.OPERA&&"TR"==p.tagName||(s.y-=p.scrollTop)}return s},n.style.getPageOffsetLeft=function(e){return n.style.getPageOffset(e).x},n.style.getPageOffsetTop=function(e){return n.style.getPageOffset(e).y},n.style.getFramedPageOffset=function(e,t){var r=new n.math.Coordinate(0,0),i=n.dom.getWindow(n.dom.getOwnerDocument(e)),o=e;do{var s=i==t?n.style.getPageOffset(o):n.style.getClientPositionForElement_(n.asserts.assert(o));r.x+=s.x,r.y+=s.y}while(i&&i!=t&&(o=i.frameElement)&&(i=i.parent));return r},n.style.translateRectForAnotherFrame=function(e,t,r){if(t.getDocument()!=r.getDocument()){var i=t.getDocument().body,o=n.style.getFramedPageOffset(i,r.getWindow());o=n.math.Coordinate.difference(o,n.style.getPageOffset(i)),n.userAgent.IE&&!t.isCss1CompatMode()&&(o=n.math.Coordinate.difference(o,t.getDocumentScroll())),e.left+=o.x,e.top+=o.y}},n.style.getRelativePosition=function(e,t){var r=n.style.getClientPosition(e),i=n.style.getClientPosition(t);return new n.math.Coordinate(r.x-i.x,r.y-i.y)},n.style.getClientPositionForElement_=function(e){var t;if(n.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS||e.getBoundingClientRect){var r=n.style.getBoundingClientRect_(e);t=new n.math.Coordinate(r.left,r.top)}else{var i=n.dom.getDomHelper(e).getDocumentScroll(),o=n.style.getPageOffset(e);t=new n.math.Coordinate(o.x-i.x,o.y-i.y)}return n.userAgent.GECKO&&!n.userAgent.isVersionOrHigher(12)?n.math.Coordinate.sum(t,n.style.getCssTranslation(e)):t},n.style.getClientPosition=function(e){if(n.asserts.assert(e),e.nodeType==n.dom.NodeType.ELEMENT)return n.style.getClientPositionForElement_(e);var t=n.isFunction(e.getBrowserEvent),r=e,i=e;return e.targetTouches?i=e.targetTouches[0]:t&&r.getBrowserEvent().targetTouches&&(i=r.getBrowserEvent().targetTouches[0]),new n.math.Coordinate(i.clientX,i.clientY)},n.style.setPageOffset=function(e,t,r){var i=n.style.getPageOffset(e);t instanceof n.math.Coordinate&&(r=t.y,t=t.x);var o=t-i.x,s=r-i.y;n.style.setPosition(e,e.offsetLeft+o,e.offsetTop+s)},n.style.setSize=function(e,t,r){var i;if(t instanceof n.math.Size)i=t.height,t=t.width;else{if(void 0==r)throw Error("missing height argument");i=r}n.style.setWidth(e,t),n.style.setHeight(e,i)},n.style.getPixelStyleValue_=function(e,t){return"number"==typeof e&&(e=(t?Math.round(e):e)+"px"),e},n.style.setHeight=function(e,t){e.style.height=n.style.getPixelStyleValue_(t,!0)},n.style.setWidth=function(e,t){e.style.width=n.style.getPixelStyleValue_(t,!0)},n.style.getSize=function(e){return n.style.evaluateWithTemporaryDisplay_(n.style.getSizeWithDisplay_,e)},n.style.evaluateWithTemporaryDisplay_=function(e,t){if("none"!=n.style.getStyle_(t,"display"))return e(t);var r=t.style,i=r.display,o=r.visibility,s=r.position;r.visibility="hidden",r.position="absolute",r.display="inline";var a=e(t);return r.display=i,r.position=s,r.visibility=o,a},n.style.getSizeWithDisplay_=function(e){var t=e.offsetWidth,r=e.offsetHeight,i=n.userAgent.WEBKIT&&!t&&!r;if((!n.isDef(t)||i)&&e.getBoundingClientRect){var o=n.style.getBoundingClientRect_(e);return new n.math.Size(o.right-o.left,o.bottom-o.top)}return new n.math.Size(t,r)},n.style.getTransformedSize=function(e){if(!e.getBoundingClientRect)return null;var t=n.style.evaluateWithTemporaryDisplay_(n.style.getBoundingClientRect_,e);return new n.math.Size(t.right-t.left,t.bottom-t.top)},n.style.getBounds=function(e){var t=n.style.getPageOffset(e),r=n.style.getSize(e);return new n.math.Rect(t.x,t.y,r.width,r.height)},n.style.toCamelCase=function(e){return n.string.toCamelCase(String(e))},n.style.toSelectorCase=function(e){return n.string.toSelectorCase(e)},n.style.getOpacity=function(e){var t=e.style,r="";if("opacity"in t)r=t.opacity;else if("MozOpacity"in t)r=t.MozOpacity;else if("filter"in t){var n=t.filter.match(/alpha\(opacity=([\d.]+)\)/);n&&(r=String(n[1]/100))}return""==r?r:Number(r)},n.style.setOpacity=function(e,t){var r=e.style;"opacity"in r?r.opacity=t:"MozOpacity"in r?r.MozOpacity=t:"filter"in r&&(r.filter=""===t?"":"alpha(opacity="+100*t+")")},n.style.setTransparentBackgroundImage=function(e,t){var r=e.style;n.userAgent.IE&&!n.userAgent.isVersionOrHigher("8")?r.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+t+'", sizingMethod="crop")':(r.backgroundImage="url("+t+")",r.backgroundPosition="top left",r.backgroundRepeat="no-repeat")},n.style.clearTransparentBackgroundImage=function(e){var t=e.style;"filter"in t?t.filter="":t.backgroundImage="none"},n.style.showElement=function(e,t){n.style.setElementShown(e,t)},n.style.setElementShown=function(e,t){e.style.display=t?"":"none"},n.style.isElementShown=function(e){return"none"!=e.style.display},n.style.installStyles=function(e,t){var r=n.dom.getDomHelper(t),i=null,o=r.getDocument();if(n.userAgent.IE&&o.createStyleSheet)i=o.createStyleSheet(),n.style.setStyles(i,e);else{var s=r.getElementsByTagNameAndClass("head")[0];if(!s){var a=r.getElementsByTagNameAndClass("body")[0];s=r.createDom("head"),a.parentNode.insertBefore(s,a)}i=r.createDom("style"),n.style.setStyles(i,e),r.appendChild(s,i)}return i},n.style.uninstallStyles=function(e){var t=e.ownerNode||e.owningElement||e;n.dom.removeNode(t)},n.style.setStyles=function(e,t){n.userAgent.IE&&n.isDef(e.cssText)?e.cssText=t:e.innerHTML=t},n.style.setPreWrap=function(e){var t=e.style;n.userAgent.IE&&!n.userAgent.isVersionOrHigher("8")?(t.whiteSpace="pre",t.wordWrap="break-word"):n.userAgent.GECKO?t.whiteSpace="-moz-pre-wrap":t.whiteSpace="pre-wrap"},n.style.setInlineBlock=function(e){var t=e.style;t.position="relative",n.userAgent.IE&&!n.userAgent.isVersionOrHigher("8")?(t.zoom="1",t.display="inline"):n.userAgent.GECKO?t.display=n.userAgent.isVersionOrHigher("1.9a")?"inline-block":"-moz-inline-box":t.display="inline-block"},n.style.isRightToLeft=function(e){return"rtl"==n.style.getStyle_(e,"direction")},n.style.unselectableStyle_=n.userAgent.GECKO?"MozUserSelect":n.userAgent.WEBKIT?"WebkitUserSelect":null,n.style.isUnselectable=function(e){return n.style.unselectableStyle_?"none"==e.style[n.style.unselectableStyle_].toLowerCase():!(!n.userAgent.IE&&!n.userAgent.OPERA)&&"on"==e.getAttribute("unselectable")},n.style.setUnselectable=function(e,t,r){var i=r?null:e.getElementsByTagName("*"),o=n.style.unselectableStyle_;if(o){var s=t?"none":"";if(e.style[o]=s,i)for(var a,l=0;a=i[l];l++)a.style[o]=s}else if(n.userAgent.IE||n.userAgent.OPERA){var s=t?"on":"";if(e.setAttribute("unselectable",s),i)for(var a,l=0;a=i[l];l++)a.setAttribute("unselectable",s)}},n.style.getBorderBoxSize=function(e){return new n.math.Size(e.offsetWidth,e.offsetHeight)},n.style.setBorderBoxSize=function(e,t){var r=n.dom.getOwnerDocument(e),i=n.dom.getDomHelper(r).isCss1CompatMode();if(!n.userAgent.IE||i&&n.userAgent.isVersionOrHigher("8"))n.style.setBoxSizingSize_(e,t,"border-box");else{var o=e.style;if(i){var s=n.style.getPaddingBox(e),a=n.style.getBorderBox(e);o.pixelWidth=t.width-a.left-s.left-s.right-a.right,o.pixelHeight=t.height-a.top-s.top-s.bottom-a.bottom}else o.pixelWidth=t.width,o.pixelHeight=t.height}},n.style.getContentBoxSize=function(e){var t=n.dom.getOwnerDocument(e),r=n.userAgent.IE&&e.currentStyle;if(r&&n.dom.getDomHelper(t).isCss1CompatMode()&&"auto"!=r.width&&"auto"!=r.height&&!r.boxSizing){var i=n.style.getIePixelValue_(e,r.width,"width","pixelWidth"),o=n.style.getIePixelValue_(e,r.height,"height","pixelHeight");return new n.math.Size(i,o)}var s=n.style.getBorderBoxSize(e),a=n.style.getPaddingBox(e),l=n.style.getBorderBox(e);return new n.math.Size(s.width-l.left-a.left-a.right-l.right,s.height-l.top-a.top-a.bottom-l.bottom)},n.style.setContentBoxSize=function(e,t){var r=n.dom.getOwnerDocument(e),i=n.dom.getDomHelper(r).isCss1CompatMode();if(!n.userAgent.IE||i&&n.userAgent.isVersionOrHigher("8"))n.style.setBoxSizingSize_(e,t,"content-box");else{var o=e.style;if(i)o.pixelWidth=t.width,o.pixelHeight=t.height;else{var s=n.style.getPaddingBox(e),a=n.style.getBorderBox(e);o.pixelWidth=t.width+a.left+s.left+s.right+a.right,o.pixelHeight=t.height+a.top+s.top+s.bottom+a.bottom}}},n.style.setBoxSizingSize_=function(e,t,r){var i=e.style;n.userAgent.GECKO?i.MozBoxSizing=r:n.userAgent.WEBKIT?i.WebkitBoxSizing=r:i.boxSizing=r,i.width=Math.max(t.width,0)+"px",i.height=Math.max(t.height,0)+"px"},n.style.getIePixelValue_=function(e,t,r,n){if(/^\d+px?$/.test(t))return parseInt(t,10);var i=e.style[r],o=e.runtimeStyle[r];e.runtimeStyle[r]=e.currentStyle[r],e.style[r]=t;var s=e.style[n];return e.style[r]=i,e.runtimeStyle[r]=o,s},n.style.getIePixelDistance_=function(e,t){var r=n.style.getCascadedStyle(e,t);return r?n.style.getIePixelValue_(e,r,"left","pixelLeft"):0},n.style.getBox_=function(e,t){if(n.userAgent.IE){var r=n.style.getIePixelDistance_(e,t+"Left"),i=n.style.getIePixelDistance_(e,t+"Right"),o=n.style.getIePixelDistance_(e,t+"Top"),s=n.style.getIePixelDistance_(e,t+"Bottom");return new n.math.Box(o,i,s,r)}var r=n.style.getComputedStyle(e,t+"Left"),i=n.style.getComputedStyle(e,t+"Right"),o=n.style.getComputedStyle(e,t+"Top"),s=n.style.getComputedStyle(e,t+"Bottom");return new n.math.Box(parseFloat(o),parseFloat(i),parseFloat(s),parseFloat(r))},n.style.getPaddingBox=function(e){return n.style.getBox_(e,"padding")},n.style.getMarginBox=function(e){return n.style.getBox_(e,"margin")},n.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6},n.style.getIePixelBorder_=function(e,t){if("none"==n.style.getCascadedStyle(e,t+"Style"))return 0;var r=n.style.getCascadedStyle(e,t+"Width");return r in n.style.ieBorderWidthKeywords_?n.style.ieBorderWidthKeywords_[r]:n.style.getIePixelValue_(e,r,"left","pixelLeft")},n.style.getBorderBox=function(e){if(n.userAgent.IE&&!n.userAgent.isDocumentModeOrHigher(9)){var t=n.style.getIePixelBorder_(e,"borderLeft"),r=n.style.getIePixelBorder_(e,"borderRight"),i=n.style.getIePixelBorder_(e,"borderTop"),o=n.style.getIePixelBorder_(e,"borderBottom");return new n.math.Box(i,r,o,t)}var t=n.style.getComputedStyle(e,"borderLeftWidth"),r=n.style.getComputedStyle(e,"borderRightWidth"),i=n.style.getComputedStyle(e,"borderTopWidth"),o=n.style.getComputedStyle(e,"borderBottomWidth");return new n.math.Box(parseFloat(i),parseFloat(r),parseFloat(o),parseFloat(t))},n.style.getFontFamily=function(e){var t=n.dom.getOwnerDocument(e),r="";if(t.body.createTextRange&&n.dom.contains(t,e)){var i=t.body.createTextRange();i.moveToElementText(e);try{r=i.queryCommandValue("FontName")}catch(e){r=""}}r||(r=n.style.getStyle_(e,"fontFamily"));var o=r.split(",");return o.length>1&&(r=o[0]),n.string.stripQuotes(r,"\"'")},n.style.lengthUnitRegex_=/[^\d]+$/,n.style.getLengthUnits=function(e){var t=e.match(n.style.lengthUnitRegex_);return t&&t[0]||null},n.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,in:1,mm:1,pc:1,pt:1},n.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1},n.style.getFontSize=function(e){var t=n.style.getStyle_(e,"fontSize"),r=n.style.getLengthUnits(t);if(t&&"px"==r)return parseInt(t,10);if(n.userAgent.IE){if(r in n.style.ABSOLUTE_CSS_LENGTH_UNITS_)return n.style.getIePixelValue_(e,t,"left","pixelLeft");if(e.parentNode&&e.parentNode.nodeType==n.dom.NodeType.ELEMENT&&r in n.style.CONVERTIBLE_RELATIVE_CSS_UNITS_){var i=e.parentNode,o=n.style.getStyle_(i,"fontSize");return n.style.getIePixelValue_(i,t==o?"1em":t,"left","pixelLeft")}}var s=n.dom.createDom("span",{style:"visibility:hidden;position:absolute;line-height:0;padding:0;margin:0;border:0;height:1em;"});return n.dom.appendChild(e,s),t=s.offsetHeight,n.dom.removeNode(s),t},n.style.parseStyleAttribute=function(e){var t={};return n.array.forEach(e.split(/\s*;\s*/),function(e){var r=e.split(/\s*:\s*/);2==r.length&&(t[n.string.toCamelCase(r[0].toLowerCase())]=r[1])}),t},n.style.toStyleAttribute=function(e){var t=[];return n.object.forEach(e,function(e,r){t.push(n.string.toSelectorCase(r),":",e,";")}),t.join("")},n.style.setFloat=function(e,t){e.style[n.userAgent.IE?"styleFloat":"cssFloat"]=t},n.style.getFloat=function(e){return e.style[n.userAgent.IE?"styleFloat":"cssFloat"]||""},n.style.getScrollbarWidth=function(e){var t=n.dom.createElement("div");e&&(t.className=e),t.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px";var r=n.dom.createElement("div");n.style.setSize(r,"200px","200px"),t.appendChild(r),n.dom.appendChild(n.dom.getDocument().body,t);var i=t.offsetWidth-t.clientWidth;return n.dom.removeNode(t),i},n.style.MATRIX_TRANSLATION_REGEX_=new RegExp("matrix\\([0-9\\.\\-]+, [0-9\\.\\-]+, [0-9\\.\\-]+, [0-9\\.\\-]+, ([0-9\\.\\-]+)p?x?, ([0-9\\.\\-]+)p?x?\\)"),n.style.getCssTranslation=function(e){var t=n.style.getComputedTransform(e);if(!t)return new n.math.Coordinate(0,0);var r=t.match(n.style.MATRIX_TRANSLATION_REGEX_);return r?new n.math.Coordinate(parseFloat(r[1]),parseFloat(r[2])):new n.math.Coordinate(0,0)},n.provide("xrx.vml"),n.require("goog.dom.DomHelper"),n.require("goog.style"),xrx.vml=function(){},xrx.vml.browserEnabled=!1,xrx.vml.initVmlRendering=function(){xrx.vml.browserEnabled||(n.style.installStyles(".xrx-vml{behavior:url(#default#VML);display:inline-block}"),xrx.vml.browserEnabled=!0)},xrx.vml.createFillAndCo=function(e){var t=document.createElement("xrxvml:fill"),r=document.createElement("xrxvml:stroke"),i=document.createElement("xrxvml:skew");t.setAttribute("class","xrx-vml"),r.setAttribute("class","xrx-vml"),i.setAttribute("class","xrx-vml"),n.dom.appendChild(e,t),n.dom.appendChild(e,r),n.dom.appendChild(e,i)},xrx.vml.createElement=function(e,t){var r;return!document.namespaces.xrxvml&&document.namespaces.add("xrxvml","urn:schemas-microsoft-com:vml"),r=document.createElement("xrxvml:"+e),r.setAttribute("class","xrx-vml"),!1!==t&&xrx.vml.createFillAndCo(r),r},xrx.vml.setPath=function(e,t,r){for(var n="m ",i=0,o=t.length;i<o;i++)n+=t[i][0]+","+t[i][1],0!==i&&i!==o-1&&(n+=", "),0===i&&(n+=" l ");r&&(n+=" x "),n+=" e",e.path=n},n.provide("xrx.engine.Element"),n.require("goog.Disposable"),n.require("xrx.engine"),xrx.engine.Element=function(){n.base(this)},n.inherits(xrx.engine.Element,n.Disposable),xrx.engine.Element.prototype.startDrawing=function(){},xrx.engine.Element.prototype.finishDrawing=function(){},xrx.engine.Element.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.vml.Element"),n.require("xrx.engine.Element"),n.require("xrx.vml"),xrx.vml.Element=function(e){n.base(this),this.element_=e},n.inherits(xrx.vml.Element,xrx.engine.Element),xrx.vml.Element.prototype.getElement=function(){return this.element_},xrx.vml.Element.prototype.applyTransform=function(e){if(e){var t=e.m00_+","+e.m10_+","+e.m01_+","+e.m11_+","+e.m02_+","+e.m12_;console.log(t),this.element_.setAttribute("matrix",t)}},n.provide("xrx.vml.Stylable"),n.require("goog.dom.DomHelper"),n.require("xrx.vml.Element"),n.require("xrx.engine"),xrx.vml.Stylable=function(e){n.base(this,e);var t=n.dom.getChildren(e);this.fill_=t[0],this.stroke_=t[1],this.skew_=t[2]},n.inherits(xrx.vml.Stylable,xrx.vml.Element),xrx.vml.Stylable.prototype.strokeAndFill_=function(e,t,r,n){void 0!==e&&this.setFillColor(e),void 0!==t&&this.setFillOpacity(t),void 0!==r&&this.setStrokeColor(r),void 0!==n&&this.setStrokeWidth(n)},xrx.vml.Stylable.prototype.setStrokeWidth=function(e){this.stroke_.weight=""+e},xrx.vml.Stylable.prototype.setStrokeColor=function(e){this.stroke_.color=""+e},xrx.vml.Stylable.prototype.setFillColor=function(e){this.fill_.color=""+e},xrx.vml.Stylable.prototype.setFillOpacity=function(e){this.fill_.opacity=""+e},n.provide("xrx.vml.Rect"),n.require("goog.style"),n.require("xrx.vml"),n.require("xrx.vml.Stylable"),xrx.vml.Rect=function(e){n.base(this,e)},n.inherits(xrx.vml.Rect,xrx.vml.Stylable),xrx.vml.Rect.prototype.setX=function(e){this.element_.style.left=e+"px"},xrx.vml.Rect.prototype.setY=function(e){this.element_.style.top=e+"px"},xrx.vml.Rect.prototype.setWidth=function(e){this.element_.style.width=e+"px"},xrx.vml.Rect.prototype.setHeight=function(e){this.element_.style.height=e+"px"},xrx.vml.Rect.prototype.draw=function(e,t,r,n,i,o,s,a){void 0!==e&&this.setX(e),void 0!==t&&this.setY(t),void 0!==r&&this.setWidth(r),void 0!==n&&this.setHeight(n),this.strokeAndFill_(i,o,s,a)},xrx.vml.Rect.create=function(e){var t=xrx.vml.createElement("rect");return t.style.position="absolute",new xrx.vml.Rect(t)},n.provide("xrx.canvas"),xrx.canvas=function(){},n.provide("xrx.canvas.Element"),n.require("xrx.canvas"),n.require("xrx.engine.Element"),xrx.canvas.Element=function(e){n.base(this),this.canvas_=e,this.context_=this.canvas_.getElement().getContext("2d")},n.inherits(xrx.canvas.Element,xrx.engine.Element),xrx.canvas.Element.prototype.getCanvas=function(){return this.canvas_},xrx.canvas.Element.prototype.getContext=function(){return this.context_},xrx.canvas.Element.prototype.applyTransform=function(e){e&&this.context_.setTransform(e.m00_,e.m10_,e.m01_,e.m11_,e.m02_,e.m12_)},xrx.canvas.Element.prototype.disposeInternal=function(){this.canvas_.dispose(),this.context_=null,n.base(this,"disposeInternal")},n.provide("xrx.canvas.Stylable"),n.require("xrx.canvas.Element"),n.require("xrx.engine"),xrx.canvas.Stylable=function(e){n.base(this,e)},n.inherits(xrx.canvas.Stylable,xrx.canvas.Element),xrx.canvas.Stylable.prototype.strokeAndFill_=function(e,t,r,n){this.context_.fillStyle=e,this.context_.globalAlpha=t,this.context_.fill(),this.context_.globalAlpha=1,this.context_.strokeStyle=r,this.context_.lineWidth=n,n>0&&this.context_.stroke()},xrx.canvas.Stylable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.canvas.Image"),n.require("xrx.canvas.Stylable"),xrx.canvas.Image=function(e){n.base(this,e)},n.inherits(xrx.canvas.Image,xrx.canvas.Stylable),xrx.canvas.Image.prototype.draw=function(e){e&&this.context_.drawImage(e,0,0,e.width,e.height)},xrx.canvas.Image.create=function(e){return new xrx.canvas.Image(e)},xrx.canvas.Image.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.canvas.Circle"),n.require("xrx.canvas.Stylable"),xrx.canvas.Circle=function(e){n.base(this,e)},n.inherits(xrx.canvas.Circle,xrx.canvas.Stylable),xrx.canvas.Circle.prototype.draw=function(e,t,r,n,i,o,s){this.context_.beginPath(),this.context_.arc(e,t,r,0,2*Math.PI),this.strokeAndFill_(n,i,o,s)},xrx.canvas.Circle.create=function(e){return new xrx.canvas.Circle(e)},xrx.canvas.Circle.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.vml.Polyline"),n.require("xrx.vml"),n.require("xrx.vml.Stylable"),xrx.vml.Polyline=function(e){n.base(this,e)},n.inherits(xrx.vml.Polyline,xrx.vml.Stylable),xrx.vml.Polyline.prototype.setCoords=function(e){xrx.vml.setPath(this.element_,e)},xrx.vml.Polyline.prototype.draw=function(e,t,r,n,i){void 0!==e&&this.setCoords(e),this.strokeAndFill_(t,r,n,i)},xrx.vml.Polyline.create=function(e){var t=xrx.vml.createElement("shape");return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.width=e.getWidth()+"px",t.style.height=e.getHeight()+"px",new xrx.vml.Polyline(t)},n.provide("xrx.vml.Ellipse"),n.require("xrx.vml.Stylable"),xrx.vml.Ellipse=function(e){n.base(this,e),this.rx_,this.ry_},n.inherits(xrx.vml.Ellipse,xrx.vml.Stylable),xrx.vml.Ellipse.prototype.setCenter=function(e,t){var r=e-this.rx_,n=t-this.ry_;void 0!==e&&(this.element_.style.left=r+"px"),void 0!==t&&(this.element_.style.top=n+"px")};xrx.vml.Ellipse.prototype.setRadiusX=function(e){this.rx_=e,this.element_.style.width=2*this.rx_+"px"},xrx.vml.Ellipse.prototype.setRadiusY=function(e){this.ry_=e,this.element_.style.height=2*this.ry_+"px"},xrx.vml.Ellipse.prototype.draw=function(e,t,r,n,i,o,s,a){void 0!==r&&this.setRadiusX(r),void 0!==n&&this.setRadiusY(n),this.setCenter(e,t),this.strokeAndFill_(i,o,s,a)},xrx.vml.Ellipse.create=function(e){var t=xrx.vml.createElement("oval");return t.style.position="absolute",new xrx.vml.Ellipse(t)},n.provide("xrx.canvas.Polygon"),n.require("xrx.canvas.Stylable"),xrx.canvas.Polygon=function(e){n.base(this,e)},n.inherits(xrx.canvas.Polygon,xrx.canvas.Stylable),xrx.canvas.Polygon.prototype.drawPath_=function(e){if(e[0]){this.context_.beginPath(),this.context_.moveTo(e[0][0],e[0][1]);for(var t=1,r=e.length;t<r;t++)this.context_.lineTo(e[t][0],e[t][1]);this.context_.lineTo(e[0][0],e[0][1]),this.context_.closePath()}},xrx.canvas.Polygon.prototype.draw=function(e,t,r,n,i){this.drawPath_(e),this.strokeAndFill_(t,r,n,i)},xrx.canvas.Polygon.create=function(e){return new xrx.canvas.Polygon(e)},xrx.canvas.Polygon.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.canvas.Container"),n.require("xrx.canvas.Element"),xrx.canvas.Container=function(e){n.base(this,e),this.childs_=[]},n.inherits(xrx.canvas.Container,xrx.canvas.Element),xrx.canvas.Container.prototype.addChild=function(e){this.childs_.push(e)},xrx.canvas.Container.prototype.getChildren=function(){return this.childs_},xrx.canvas.Container.prototype.removeChildren=function(){this.childs_=[]},xrx.canvas.Container.prototype.removeChildAt=function(e){this.childs_.splice(e,1)},xrx.canvas.Container.prototype.disposeInternal=function(){for(var e;e=this.childs_.pop();)e.dispose();this.childs_=null,n.base(this,"disposeInternal")},n.provide("xrx.canvas.Canvas"),n.require("goog.dom.DomHelper"),n.require("xrx.canvas.Container"),xrx.canvas.Canvas=function(e){this.element_=e,this.width_=0,this.height_=0,n.base(this,this)},n.inherits(xrx.canvas.Canvas,xrx.canvas.Container),xrx.canvas.Canvas.prototype.getElement=function(){return this.element_},xrx.canvas.Canvas.prototype.getEventTarget=function(){return this.element_},xrx.canvas.Canvas.prototype.getWidth=function(){return this.width_},xrx.canvas.Canvas.prototype.setWidth=function(e){this.width_=e,this.element_.setAttribute("width",e)},xrx.canvas.Canvas.prototype.getHeight=function(){return this.height_},xrx.canvas.Canvas.prototype.setHeight=function(e){this.height_=e,this.element_.setAttribute("height",e)},xrx.canvas.Canvas.prototype.startDrawing=function(){this.context_.save(),this.context_.clearRect(0,0,this.width_,this.height_),this.context_.beginPath()},xrx.canvas.Canvas.prototype.finishDrawing=function(){this.context_.closePath(),this.context_.restore()},xrx.canvas.Canvas.create=function(e){var t=n.dom.createElement("canvas");return new xrx.canvas.Canvas(t)},xrx.canvas.Canvas.prototype.disposeInternal=function(){n.dom.removeNode(this.element_),this.element_=null,n.base(this,"disposeInternal")},n.provide("xrx.canvas.Group"),n.require("xrx.canvas.Container"),xrx.canvas.Group=function(e){n.base(this,e)},n.inherits(xrx.canvas.Group,xrx.canvas.Container),xrx.canvas.Group.create=function(e){return new xrx.canvas.Group(e)},xrx.canvas.Group.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.svg"),n.provide("xrx.svg.Namespace"),xrx.svg=function(){},xrx.svg.Namespace={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},xrx.svg.isSupported=function(){return!!document.createElementNS&&!!document.createElementNS(xrx.svg.Namespace.svg,"svg").createSVGRect},xrx.svg.setCoords=function(e,t){for(var r="",n=0,i=t.length;n<i;n++)r+=Math.round(t[n][0])+","+Math.round(t[n][1])+" ";e.setAttribute("points",r)},n.provide("xrx.svg.Element"),n.require("xrx.engine.Element"),xrx.svg.Element=function(e){n.base(this),this.element_=e},n.inherits(xrx.svg.Element,xrx.engine.Element),xrx.svg.Element.prototype.getElement=function(){return this.element_},xrx.svg.Element.prototype.applyTransform=function(e){if(e){var t="matrix("+e.m00_+","+e.m10_+","+e.m01_+","+e.m11_+","+e.m02_+","+e.m12_+")";this.element_.setAttribute("transform",t)}},xrx.svg.Element.prototype.disposeInternal=function(){n.dom.removeNode(this.element_),this.element_.style=null,this.element_=null,n.base(this,"disposeInternal")},n.provide("xrx.svg.Stylable"),n.require("xrx.svg.Element"),n.require("xrx.engine"),xrx.svg.Stylable=function(e){n.base(this,e)},n.inherits(xrx.svg.Stylable,xrx.svg.Element),xrx.svg.Stylable.prototype.strokeAndFill_=function(e,t,r,n){void 0!==e&&this.setFillColor(e),void 0!==t&&this.setFillOpacity(t),void 0!==r&&this.setStrokeColor(r),void 0!==n&&this.setStrokeWidth(n)},xrx.svg.Stylable.prototype.setStrokeWidth=function(e){this.element_.setAttribute("stroke-width",Math.round(e))},xrx.svg.Stylable.prototype.setStrokeColor=function(e){this.element_.setAttribute("stroke",e),this.element_.setAttribute("stroke-color",e)},xrx.svg.Stylable.prototype.setFillColor=function(e){this.element_.setAttribute("fill",e)},xrx.svg.Stylable.prototype.setFillOpacity=function(e){this.element_.setAttribute("fill-opacity",e)},xrx.svg.Stylable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.svg.Line"),n.require("xrx.svg"),n.require("xrx.svg.Stylable"),xrx.svg.Line=function(e){n.base(this,e)},n.inherits(xrx.svg.Line,xrx.svg.Stylable),xrx.svg.Line.prototype.setCoords=function(e,t,r,n){void 0!==e&&this.element_.setAttribute("x1",e),void 0!==t&&this.element_.setAttribute("y1",t),void 0!==r&&this.element_.setAttribute("x2",r),void 0!==n&&this.element_.setAttribute("y2",n)},xrx.svg.Line.prototype.draw=function(e,t,r,n,i,o){this.setCoords(e,t,r,n),this.strokeAndFill_(void 0,void 0,i,o)},xrx.svg.Line.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"line");return new xrx.svg.Line(t)},xrx.svg.Line.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.canvas.Rect"),n.require("xrx.canvas.Stylable"),xrx.canvas.Rect=function(e){n.base(this,e)},n.inherits(xrx.canvas.Rect,xrx.canvas.Stylable),xrx.canvas.Rect.prototype.drawPath_=function(e,t,r,n){this.context_.beginPath(),this.context_.moveTo(e,t),this.context_.lineTo(e+r,t),this.context_.lineTo(e+r,t+n),this.context_.lineTo(e,t+n),this.context_.closePath()},xrx.canvas.Rect.prototype.draw=function(e,t,r,n,i,o,s,a){this.drawPath_(e,t,r,n),this.strokeAndFill_(i,o,s,a)},xrx.canvas.Rect.create=function(e){return new xrx.canvas.Rect(e)},xrx.canvas.Rect.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.canvas.Polyline"),n.require("xrx.canvas.Stylable"),xrx.canvas.Polyline=function(e){n.base(this,e)},n.inherits(xrx.canvas.Polyline,xrx.canvas.Stylable),xrx.canvas.Polyline.prototype.drawPath_=function(e){this.context_.beginPath(),this.context_.moveTo(e[0][0],e[0][1]);for(var t=1,r=e.length;t<r;t++)this.context_.lineTo(e[t][0],e[t][1])},xrx.canvas.Polyline.prototype.draw=function(e,t,r,n,i){this.drawPath_(e),this.strokeAndFill_(t,r,n,i)},xrx.canvas.Polyline.create=function(e){return new xrx.canvas.Polyline(e)},xrx.canvas.Polyline.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.vml.Image"),n.require("goog.dom.DomHelper"),n.require("goog.style"),n.require("xrx.vml"),n.require("xrx.vml.Stylable"),xrx.vml.Image=function(e){n.base(this,e)},n.inherits(xrx.vml.Image,xrx.vml.Stylable),xrx.vml.Image.prototype.setImage=function(e){var t=n.style.getSize(e);this.element_.src=e.src,this.element_.style.width=t.width+"px",this.element_.style.height=t.height+"px"},xrx.vml.Image.prototype.draw=function(e){void 0!==e&&this.setImage(e)},xrx.vml.Image.create=function(e){var t=xrx.vml.createElement("image",!1);return t.setAttribute("class","xrx-vml"),t.setAttribute("src","about:blank"),t.style.position="absolute",t.style.left="0px",t.style.top="0px",new xrx.vml.Image(t)},n.provide("xrx.svg.Container"),n.require("goog.dom.DomHelper"),n.require("xrx.svg.Element"),xrx.svg.Container=function(e){n.base(this,e),this.childs_=[]},n.inherits(xrx.svg.Container,xrx.svg.Element),xrx.svg.Container.prototype.addChild=function(e){this.childs_.push(e),n.dom.append(this.element_,e.getElement())},xrx.svg.Container.prototype.getChildren=function(){return this.childs_},xrx.svg.Container.prototype.removeChildren=function(){n.dom.removeChildren(this.element_),this.childs_=[]},xrx.svg.Container.prototype.removeChildAt=function(e){var t=this.childs_[e];n.dom.removeNode(t.getElement()),this.childs_.splice(e,1)},xrx.svg.Container.prototype.disposeInternal=function(){for(var e;e=this.childs_.pop();)e.dispose();this.childs_=null,n.base(this,"disposeInternal")},n.provide("xrx.svg.Canvas"),n.require("goog.dom.DomHelper"),n.require("goog.style"),n.require("xrx.svg.Namespace"),n.require("xrx.svg.Container"),xrx.svg.Canvas=function(e){n.base(this,e),this.width_=0,this.height_=0},n.inherits(xrx.svg.Canvas,xrx.svg.Container),xrx.svg.Canvas.prototype.getEventTarget=function(){return this.element_},xrx.svg.Canvas.prototype.getWidth=function(){return this.width_},xrx.svg.Canvas.prototype.setWidth=function(e){this.width_=e,this.element_.setAttribute("width",e)},xrx.svg.Canvas.prototype.getHeight=function(){return this.height_},xrx.svg.Canvas.prototype.setHeight=function(e){this.height_=e,this.element_.setAttribute("height",e)},xrx.svg.Canvas.prototype.startDrawing=function(){},xrx.svg.Canvas.prototype.finishDrawing=function(){},xrx.svg.Canvas.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"svg");return n.style.setStyle(t,"overflow","hidden"),new xrx.svg.Canvas(t)},xrx.svg.Canvas.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.canvas.Line"),n.require("xrx.canvas.Stylable"),xrx.canvas.Line=function(e){n.base(this,e)},n.inherits(xrx.canvas.Line,xrx.canvas.Stylable),xrx.canvas.Line.prototype.drawPath_=function(e,t,r,n){this.context_.beginPath(),this.context_.moveTo(e,t),this.context_.lineTo(r,n)},xrx.canvas.Line.prototype.draw=function(e,t,r,n,i,o){this.drawPath_(e,t,r,n),this.strokeAndFill_(void 0,void 0,i,o)},xrx.canvas.Line.create=function(e){return new xrx.canvas.Line(e)},xrx.canvas.Line.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.svg.Polygon"),n.require("xrx.svg"),n.require("xrx.svg.Stylable"),xrx.svg.Polygon=function(e){n.base(this,e)},n.inherits(xrx.svg.Polygon,xrx.svg.Stylable),xrx.svg.Polygon.prototype.setCoords=function(e){xrx.svg.setCoords(this.element_,e)},xrx.svg.Polygon.prototype.draw=function(e,t,r,n,i){void 0!==e&&this.setCoords(e),this.strokeAndFill_(t,r,n,i)},xrx.svg.Polygon.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"polygon");return new xrx.svg.Polygon(t)},xrx.svg.Polygon.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.svg.Circle"),n.require("xrx.svg"),n.require("xrx.svg.Stylable"),xrx.svg.Circle=function(e){n.base(this,e)},n.inherits(xrx.svg.Circle,xrx.svg.Stylable),xrx.svg.Circle.prototype.setCenter=function(e,t){void 0!==e&&this.element_.setAttribute("cx",e),void 0!==t&&this.element_.setAttribute("cy",t)},xrx.svg.Circle.prototype.setRadius=function(e){this.element_.setAttribute("r",e)},xrx.svg.Circle.prototype.draw=function(e,t,r,n,i,o,s){this.setCenter(e,t),void 0!==r&&this.setRadius(r),this.strokeAndFill_(n,i,o,s)},xrx.svg.Circle.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"circle");return new xrx.svg.Circle(t)},xrx.svg.Circle.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.canvas.Ellipse"),n.require("xrx.canvas.Stylable"),xrx.canvas.Ellipse=function(e){n.base(this,e)},n.inherits(xrx.canvas.Ellipse,xrx.canvas.Stylable),xrx.canvas.Ellipse.prototype.draw=function(e,t,r,n,i,o,s,a){if(this.context_.ellipse)this.context_.beginPath(),this.context_.ellipse(e,t,r,n,0,0,2*Math.PI,!0),this.context_.closePath();else for(var l,h,p=0;p<=2*Math.PI;p+=.01)l=e+r*Math.sin(p),h=t-n*Math.cos(p),0===p?this.context_.moveTo(l,h):this.context_.lineTo(l,h);this.strokeAndFill_(i,o,s,a)},xrx.canvas.Ellipse.create=function(e){return new xrx.canvas.Ellipse(e)},xrx.canvas.Ellipse.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.svg.Ellipse"),n.require("xrx.svg"),n.require("xrx.svg.Stylable"),xrx.svg.Ellipse=function(e){n.base(this,e)},n.inherits(xrx.svg.Ellipse,xrx.svg.Stylable),xrx.svg.Ellipse.prototype.setCenter=function(e,t){void 0!==e&&this.element_.setAttribute("cx",e),void 0!==t&&this.element_.setAttribute("cy",t)},xrx.svg.Ellipse.prototype.setRadiusX=function(e){this.element_.setAttribute("rx",e)},xrx.svg.Ellipse.prototype.setRadiusY=function(e){this.element_.setAttribute("ry",e)},xrx.svg.Ellipse.prototype.draw=function(e,t,r,n,i,o,s,a){this.setCenter(e,t),void 0!==r&&this.setRadiusX(r),void 0!==n&&this.setRadiusY(n),this.strokeAndFill_(i,o,s,a)},xrx.svg.Ellipse.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"ellipse");return new xrx.svg.Ellipse(t)},xrx.svg.Ellipse.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.vml.Container"),n.require("goog.dom.DomHelper"),n.require("xrx.vml.Element"),xrx.vml.Container=function(e){n.base(this,e),this.childs_=[]},n.inherits(xrx.vml.Container,xrx.vml.Element),xrx.vml.Container.prototype.addChild=function(e){this.childs_.push(e),this.element_.appendChild(e.getElement())},xrx.vml.Container.prototype.getChildren=function(){return this.childs_},xrx.vml.Container.prototype.removeChildren=function(){n.dom.removeChildren(this.element_),this.childs_=[]},xrx.vml.Container.prototype.removeChildAt=function(e){var t=this.childs_[e];n.dom.removeNode(t.getElement()),this.childs_.splice(e,1)},n.provide("xrx.vml.Canvas"),n.require("goog.dom.DomHelper"),n.require("goog.style"),n.require("xrx.vml"),n.require("xrx.vml.Container"),xrx.vml.Canvas=function(e){n.base(this,e),this.width_=0,this.height_=0},n.inherits(xrx.vml.Canvas,xrx.vml.Container),xrx.vml.Canvas.prototype.getEventTarget=function(){return this.element_},xrx.vml.Canvas.prototype.getWidth=function(){return this.width_},xrx.vml.Canvas.prototype.setWidth=function(e){this.width_=e,this.element_.parentElement.style.width=e+"px",this.element_.style.width=e+"px",this.element_.coordorigin="0, 0",this.element_.coordsize=this.width_+", "+this.height_},xrx.vml.Canvas.prototype.getHeight=function(){return this.height_},xrx.vml.Canvas.prototype.setHeight=function(e){this.height_=e,this.element_.parentElement.style.height=e+"px",this.element_.style.height=e+"px",this.element_.coordorigin="0, 0",this.element_.coordsize=this.width_+", "+this.height_},xrx.vml.Canvas.prototype.startDrawing=function(){},xrx.vml.Canvas.prototype.finishDrawing=function(){},xrx.vml.Canvas.create=function(e){xrx.vml.initVmlRendering();var t=n.dom.createElement("div");t.style.display="inline-block",t.style.position="relative",t.style.overflow="hidden",t.style.width="100px",t.style.height="100px";var r=xrx.vml.createElement("group",!1);return n.dom.appendChild(t,r),n.dom.appendChild(e,t),r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.width="100px",r.style.height="100px",new xrx.vml.Canvas(r)},n.provide("xrx.vml.Polygon"),n.require("xrx.vml"),n.require("xrx.vml.Stylable"),xrx.vml.Polygon=function(e){n.base(this,e)};n.inherits(xrx.vml.Polygon,xrx.vml.Stylable),xrx.vml.Polygon.prototype.setCoords=function(e){xrx.vml.setPath(this.element_,e,!0)},xrx.vml.Polygon.prototype.draw=function(e,t,r,n,i){void 0!==e&&this.setCoords(e),this.strokeAndFill_(t,r,n,i)},xrx.vml.Polygon.create=function(e){var t=xrx.vml.createElement("shape");return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.width=e.getWidth()+"px",t.style.height=e.getHeight()+"px",new xrx.vml.Polygon(t)},n.provide("xrx.svg.Group"),n.require("goog.dom.DomHelper"),n.require("xrx.svg"),n.require("xrx.svg.Container"),xrx.svg.Group=function(e){n.base(this,e)},n.inherits(xrx.svg.Group,xrx.svg.Container),xrx.svg.Group.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"g");return new xrx.svg.Group(t)},xrx.svg.Group.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.vml.Group"),n.require("goog.dom.DomHelper"),n.require("xrx.vml"),n.require("xrx.vml.Container"),xrx.vml.Group=function(e){n.base(this,e)},n.inherits(xrx.vml.Group,xrx.vml.Container),xrx.vml.Group.create=function(e){var t=xrx.vml.createElement("group",!1);return t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.width=e.getWidth()+"px",t.style.height=e.getHeight()+"px",new xrx.vml.Group(t)},n.provide("xrx.svg.Image"),n.require("xrx.svg"),n.require("xrx.svg.Stylable"),xrx.svg.Image=function(e){n.base(this,e)},n.inherits(xrx.svg.Image,xrx.svg.Stylable),xrx.svg.Image.prototype.setWidth=function(e){this.element_.setAttribute("width",e)},xrx.svg.Image.prototype.setHeight=function(e){this.element_.setAttribute("height",e)},xrx.svg.Image.prototype.setImage=function(e){this.element_.setAttributeNS(xrx.svg.Namespace.xlink,"xlink:href",e.src)},xrx.svg.Image.prototype.draw=function(e){void 0!==e&&this.setImage(e)},xrx.svg.Image.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"image");return new xrx.svg.Image(t)},xrx.svg.Image.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.vml.Circle"),n.require("goog.style"),n.require("xrx.vml"),n.require("xrx.vml.Stylable"),xrx.vml.Circle=function(e){n.base(this,e),this.r_},n.inherits(xrx.vml.Circle,xrx.vml.Stylable),xrx.vml.Circle.prototype.setCenter=function(e,t,r){var n=e-this.r_,i=t-this.r_;void 0!==e&&(this.element_.style.left=n+"px"),void 0!==t&&(this.element_.style.top=i+"px")},xrx.vml.Circle.prototype.setRadius=function(e){this.r_=e;var t=2*this.r_;this.element_.style.width=t+"px",this.element_.style.height=t+"px"},xrx.vml.Circle.prototype.draw=function(e,t,r,n,i,o,s){void 0!==r&&this.setRadius(r),this.setCenter(e,t,r),this.strokeAndFill_(n,i,o,s)},xrx.vml.Circle.create=function(e){var t=xrx.vml.createElement("oval");return t.style.position="absolute",new xrx.vml.Circle(t)},n.provide("xrx.svg.Rect"),n.require("xrx.svg"),n.require("xrx.svg.Stylable"),xrx.svg.Rect=function(e){n.base(this,e)},n.inherits(xrx.svg.Rect,xrx.svg.Stylable),xrx.svg.Rect.prototype.setX=function(e){this.element_.setAttribute("x",e)},xrx.svg.Rect.prototype.setY=function(e){this.element_.setAttribute("y",e)},xrx.svg.Rect.prototype.setWidth=function(e){this.element_.setAttribute("width",e)},xrx.svg.Rect.prototype.setHeight=function(e){this.element_.setAttribute("height",e)},xrx.svg.Rect.prototype.draw=function(e,t,r,n,i,o,s,a){void 0!==e&&this.setX(e),void 0!==t&&this.setY(t),void 0!==r&&this.setWidth(r),void 0!==n&&this.setHeight(n),this.strokeAndFill_(i,o,s,a)},xrx.svg.Rect.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"rect");return new xrx.svg.Rect(t)},xrx.svg.Rect.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.svg.Polyline"),n.require("xrx.svg"),n.require("xrx.svg.Stylable"),xrx.svg.Polyline=function(e){n.base(this,e)},n.inherits(xrx.svg.Polyline,xrx.svg.Stylable),xrx.svg.Polyline.prototype.setCoords=function(e){xrx.svg.setCoords(this.element_,e)},xrx.svg.Polyline.prototype.draw=function(e,t,r,n,i){void 0!==e&&this.setCoords(e),this.strokeAndFill_(t,r,n,i)},xrx.svg.Polyline.create=function(e){var t=document.createElementNS(xrx.svg.Namespace.svg,"polyline");return new xrx.svg.Polyline(t)},xrx.svg.Polyline.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.vml.Line"),n.require("xrx.vml"),n.require("xrx.vml.Stylable"),xrx.vml.Line=function(e){n.base(this,e)},n.inherits(xrx.vml.Line,xrx.vml.Stylable),xrx.vml.Line.prototype.setCoords=function(e){xrx.vml.setPath(this.element_,e,!1)},xrx.vml.Line.prototype.draw=function(e,t,r,n,i,o){this.setCoords([[e,t],[r,n]]),this.strokeAndFill_(void 0,void 0,i,o)},xrx.vml.Line.create=function(e){var t=xrx.vml.createElement("shape");return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.width=e.getWidth()+"px",t.style.height=e.getHeight()+"px",new xrx.vml.Line(t)},n.provide("xrx.engine.Engines"),n.require("xrx.canvas"),n.require("xrx.canvas.Canvas"),n.require("xrx.canvas.Circle"),n.require("xrx.canvas.Element"),n.require("xrx.canvas.Ellipse"),n.require("xrx.canvas.Group"),n.require("xrx.canvas.Image"),n.require("xrx.canvas.Line"),n.require("xrx.canvas.Polyline"),n.require("xrx.canvas.Polygon"),n.require("xrx.canvas.Rect"),n.require("xrx.svg"),n.require("xrx.svg.Canvas"),n.require("xrx.svg.Circle"),n.require("xrx.svg.Element"),n.require("xrx.svg.Ellipse"),n.require("xrx.svg.Group"),n.require("xrx.svg.Image"),n.require("xrx.svg.Line"),n.require("xrx.svg.Polyline"),n.require("xrx.svg.Polygon"),n.require("xrx.svg.Rect"),n.require("xrx.vml"),n.require("xrx.vml.Canvas"),n.require("xrx.vml.Circle"),n.require("xrx.vml.Element"),n.require("xrx.vml.Ellipse"),n.require("xrx.vml.Group"),n.require("xrx.vml.Image"),n.require("xrx.vml.Line"),n.require("xrx.vml.Polygon"),n.require("xrx.vml.Polyline"),n.require("xrx.vml.Rect"),xrx.engine.Engines=function(){},n.provide("xrx.shape.Shape"),n.require("xrx.engine.Engines"),n.require("xrx.shape.RenderStylable"),n.require("xrx.shape"),xrx.shape.Shape=function(e){n.base(this,e),this.drawing_=e,this.creatable_,this.hoverable_,this.modifiable_,this.selectable_,this.isModifiable_=!0},n.inherits(xrx.shape.Shape,xrx.shape.RenderStylable),xrx.shape.Shape.prototype.getDrawing=function(){return this.drawing_},xrx.shape.Shape.prototype.getCreatable=n.abstractMethod,xrx.shape.Shape.prototype.getHoverable=n.abstractMethod,xrx.shape.Shape.prototype.getModifiable=n.abstractMethod,xrx.shape.Shape.prototype.getSelectable=n.abstractMethod,xrx.shape.Shape.prototype.setModifiable=function(e){this.isModifiable_=!1!==e},xrx.shape.Shape.prototype.isModifiable=function(){return this.isModifiable_},xrx.shape.Shape.prototype.disposeInternal=function(){this.drawing_.dispose(),this.drawing_=null,n.dispose(this.hoverable_),this.hoverable_=null,n.dispose(this.selectable_),this.selectable_=null,n.dispose(this.modifiable_),this.modifiable_=null,n.dispose(this.creatable_),this.creatable_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.Geometry"),n.require("goog.object"),n.require("xrx.shape.Shape"),xrx.shape.Geometry=function(e,t){n.base(this,e),this.geometry_=t,this.zoomFactor_=1,this.ctm_},n.inherits(xrx.shape.Geometry,xrx.shape.Shape),xrx.shape.Geometry.prototype.setZoomFactor=function(e){this.zoomFactor_=e},xrx.shape.Geometry.prototype.getGeometry=function(){return this.geometry_},xrx.shape.Geometry.prototype.setCTM=function(e){this.ctm_=e},xrx.shape.Geometry.prototype.getCoordsCopy=function(){for(var e=this.getCoords(),t=e.length,r=new Array(t),n=0;n<t;n++)r[n]=new Array(2),r[n][0]=e[n][0],r[n][1]=e[n][1];return r},xrx.shape.Geometry.prototype.disposeInternal=function(){n.dispose(this.geometry_),this.geometry_=null,n.dispose(this.ctm_),this.ctm_=null,n.base(this,"disposeInternal")},n.provide("xrx.geometry"),xrx.geometry=function(){},xrx.geometry.addCoordsX=function(e,t){for(var r=0,n=e.length;r<n;r++)e[r][0]+=t},xrx.geometry.addCoordsY=function(e,t){for(var r=0,n=e.length;r<n;r++)e[r][1]+=t},xrx.geometry.getBBox=function(e){for(var t,r,n={x:e[0][0],y:e[0][1],x2:e[0][0],y2:e[0][1],width:0,height:0},i=1,o=e.length;i<o;i++)t=e[i][0],r=e[i][1],t<n.x&&(n.x=t),r<n.y&&(n.y=r),t>n.x2&&(n.x2=t),r>n.y2&&(n.y2=r);return n.width=n.x2-n.x,n.height=n.y2-n.y,n},n.provide("xrx.geometry.Geometry"),n.require("goog.Disposable"),xrx.geometry.Geometry=function(){n.base(this)},n.inherits(xrx.geometry.Geometry,n.Disposable),xrx.geometry.Geometry.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.geometry.Group"),n.require("xrx.geometry"),n.require("xrx.geometry.Geometry"),xrx.geometry.Group=function(){n.base(this),this.childs_=[]},n.inherits(xrx.geometry.Group,xrx.geometry.Geometry),xrx.geometry.Group.prototype.addChild=function(e){this.childs_.push(e)},xrx.geometry.Group.prototype.containsPoint=function(e){for(var t=0,r=this.childs_.length;t<r;t++)if(this.childs_[t].containsPoint(e))return!0;return!1},n.provide("xrx.shape.Container"),n.require("xrx.shape.Geometry"),n.require("xrx.geometry.Group"),xrx.shape.Container=function(e){n.base(this,e,new xrx.geometry.Group),this.childs_=[]},n.inherits(xrx.shape.Container,xrx.shape.Geometry),xrx.shape.Container.prototype.getChildren=function(){return this.childs_},xrx.shape.Container.prototype.getChild=function(e){return this.childs_[e]},xrx.shape.Container.prototype.addChildren=function(e){n.isArray(e)||(e=[e]);for(var t=0,r=e.length;t<r;t++)this.childs_.push(e[t]),this.engineElement_.addChild(e[t].getEngineElement())},xrx.shape.Container.prototype.removeChildren=function(){this.childs_=[],this.engineElement_.removeChildren()},xrx.shape.Container.prototype.removeChildAt=function(e){this.childs_.splice(e,1),this.engineElement_.removeChildAt(e)},xrx.shape.Container.prototype.disposeInternal=function(){for(var e;e=this.childs_.pop();)e.dispose(),e=null;this.childs_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.Group"),n.require("xrx.shape.Container"),xrx.shape.Group=function(e){n.base(this,e),this.engineElement_=this.drawing_.getEngine().createGroup()},n.inherits(xrx.shape.Group,xrx.shape.Container),xrx.shape.Group.prototype.draw=function(){this.startDrawing_();for(var e=this.getChildren(),t=0,r=e.length;t<r;t++)e[t].draw();this.finishDrawing_()},xrx.shape.Group.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.drawing.Layer"),n.require("goog.Disposable"),n.require("xrx.shape.Group"),xrx.drawing.Layer=function(e){n.base(this),this.drawing_=e,this.locked_=!1,this.group_,this.shapes_=[],this.create_()},n.inherits(xrx.drawing.Layer,n.Disposable),xrx.drawing.Layer.prototype.getDrawing=function(){return this.drawing_},xrx.drawing.Layer.prototype.setLocked=function(e){this.locked_=!0===e},xrx.drawing.Layer.prototype.isLocked=function(){return this.locked_},xrx.drawing.Layer.prototype.getGroup=function(){return this.group_},xrx.drawing.Layer.prototype.getShapes=function(){return this.shapes_},xrx.drawing.Layer.prototype.draw=function(){for(var e=0,t=this.shapes_.length;e<t;e++)this.shapes_[e].draw(this.drawing_.getViewbox().getZoomValue())},xrx.drawing.Layer.prototype.addShapes=function(e){n.isArray(e)||(e=[e]);for(var t=0,r=e.length;t<r;t++)this.shapes_.push(e[t]);this.group_.addChildren(e)},xrx.drawing.Layer.prototype.removeShapes=function(){this.shapes_=[],this.group_.removeChildren()},xrx.drawing.Layer.prototype.removeShape=function(e){for(var t=0,r=this.shapes_.length;t<r;t++)if(this.shapes_[t]===e){this.group_.removeChildAt(t),this.shapes_.splice(t,1);break}},xrx.drawing.Layer.prototype.create_=function(){this.group_=new xrx.shape.Group(this.drawing_)},xrx.drawing.Layer.prototype.disposeInternal=function(){this.drawing_.dispose(),this.drawing_=null,this.group_.dispose(),this.group_=null;for(var e;e=this.shapes_.pop();)e.dispose(),e=null;this.shapes_=null,n.base(this,"disposeInternal")},n.provide("xrx.drawing.LayerShapeCreate"),n.require("xrx.drawing.Layer"),xrx.drawing.LayerShapeCreate=function(e){n.base(this,e)},n.inherits(xrx.drawing.LayerShapeCreate,xrx.drawing.Layer),xrx.drawing.LayerShapeCreate.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.drawing.LayerShape"),n.require("xrx.drawing.Layer"),xrx.drawing.LayerShape=function(e){n.base(this,e)},n.inherits(xrx.drawing.LayerShape,xrx.drawing.Layer),xrx.drawing.LayerShape.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("goog.events.EventId"),n.events.EventId=function(e){this.id=e},n.events.EventId.prototype.toString=function(){return this.id},n.provide("goog.events.Listenable"),n.provide("goog.events.ListenableKey"),n.require("goog.events.EventId"),n.events.Listenable=function(){},n.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1e6*Math.random()|0),n.events.Listenable.addImplementation=function(e){e.prototype[n.events.Listenable.IMPLEMENTED_BY_PROP]=!0},n.events.Listenable.isImplementedBy=function(e){return!(!e||!e[n.events.Listenable.IMPLEMENTED_BY_PROP])},n.events.Listenable.prototype.listen,n.events.Listenable.prototype.listenOnce;n.events.Listenable.prototype.unlisten,n.events.Listenable.prototype.unlistenByKey,n.events.Listenable.prototype.dispatchEvent,n.events.Listenable.prototype.removeAllListeners,n.events.Listenable.prototype.getParentEventTarget,n.events.Listenable.prototype.fireListeners,n.events.Listenable.prototype.getListeners,n.events.Listenable.prototype.getListener,n.events.Listenable.prototype.hasListener,n.events.ListenableKey=function(){},n.events.ListenableKey.counter_=0,n.events.ListenableKey.reserveKey=function(){return++n.events.ListenableKey.counter_},n.events.ListenableKey.prototype.src,n.events.ListenableKey.prototype.type,n.events.ListenableKey.prototype.listener,n.events.ListenableKey.prototype.capture,n.events.ListenableKey.prototype.handler,n.events.ListenableKey.prototype.key,n.provide("goog.events.Listener"),n.require("goog.events.ListenableKey"),n.events.Listener=function(e,t,r,i,o,s){n.events.Listener.ENABLE_MONITORING&&(this.creationStack=(new Error).stack),this.listener=e,this.proxy=t,this.src=r,this.type=i,this.capture=!!o,this.handler=s,this.key=n.events.ListenableKey.reserveKey(),this.callOnce=!1,this.removed=!1},n.define("goog.events.Listener.ENABLE_MONITORING",!1),n.events.Listener.prototype.creationStack,n.events.Listener.prototype.markAsRemoved=function(){this.removed=!0,this.listener=null,this.proxy=null,this.src=null,this.handler=null},n.provide("goog.events.ListenerMap"),n.require("goog.array"),n.require("goog.events.Listener"),n.require("goog.object"),n.events.ListenerMap=function(e){this.src=e,this.listeners={},this.typeCount_=0},n.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_},n.events.ListenerMap.prototype.getListenerCount=function(){var e=0;for(var t in this.listeners)e+=this.listeners[t].length;return e},n.events.ListenerMap.prototype.add=function(e,t,r,i,o){var s=e.toString(),a=this.listeners[s];a||(a=this.listeners[s]=[],this.typeCount_++);var l,h=n.events.ListenerMap.findListenerIndex_(a,t,i,o);return h>-1?(l=a[h],r||(l.callOnce=!1)):(l=new n.events.Listener(t,null,this.src,s,!!i,o),l.callOnce=r,a.push(l)),l},n.events.ListenerMap.prototype.remove=function(e,t,r,i){var o=e.toString();if(!(o in this.listeners))return!1;var s=this.listeners[o],a=n.events.ListenerMap.findListenerIndex_(s,t,r,i);if(a>-1){return s[a].markAsRemoved(),n.array.removeAt(s,a),0==s.length&&(delete this.listeners[o],this.typeCount_--),!0}return!1},n.events.ListenerMap.prototype.removeByKey=function(e){var t=e.type;if(!(t in this.listeners))return!1;var r=n.array.remove(this.listeners[t],e);return r&&(e.markAsRemoved(),0==this.listeners[t].length&&(delete this.listeners[t],this.typeCount_--)),r},n.events.ListenerMap.prototype.removeAll=function(e){var t=e&&e.toString(),r=0;for(var n in this.listeners)if(!t||n==t){for(var i=this.listeners[n],o=0;o<i.length;o++)++r,i[o].markAsRemoved();delete this.listeners[n],this.typeCount_--}return r},n.events.ListenerMap.prototype.getListeners=function(e,t){var r=this.listeners[e.toString()],n=[];if(r)for(var i=0;i<r.length;++i){var o=r[i];o.capture==t&&n.push(o)}return n},n.events.ListenerMap.prototype.getListener=function(e,t,r,i){var o=this.listeners[e.toString()],s=-1;return o&&(s=n.events.ListenerMap.findListenerIndex_(o,t,r,i)),s>-1?o[s]:null},n.events.ListenerMap.prototype.hasListener=function(e,t){var r=n.isDef(e),i=r?e.toString():"",o=n.isDef(t);return n.object.some(this.listeners,function(e,n){for(var s=0;s<e.length;++s)if(!(r&&e[s].type!=i||o&&e[s].capture!=t))return!0;return!1})},n.events.ListenerMap.findListenerIndex_=function(e,t,r,n){for(var i=0;i<e.length;++i){var o=e[i];if(!o.removed&&o.listener==t&&o.capture==!!r&&o.handler==n)return i}return-1},n.provide("goog.events.BrowserFeature"),n.require("goog.userAgent"),n.events.BrowserFeature={HAS_W3C_BUTTON:!n.userAgent.IE||n.userAgent.isDocumentModeOrHigher(9),HAS_W3C_EVENT_SUPPORT:!n.userAgent.IE||n.userAgent.isDocumentModeOrHigher(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:n.userAgent.IE&&!n.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!n.userAgent.WEBKIT||n.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:n.userAgent.GECKO&&n.userAgent.isVersionOrHigher("1.9b")||n.userAgent.IE&&n.userAgent.isVersionOrHigher("8")||n.userAgent.OPERA&&n.userAgent.isVersionOrHigher("9.5")||n.userAgent.WEBKIT&&n.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:n.userAgent.GECKO&&!n.userAgent.isVersionOrHigher("8")||n.userAgent.IE&&!n.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart"in n.global||!!(n.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!n.global.navigator||!n.global.navigator.msMaxTouchPoints)},n.provide("goog.debug.EntryPointMonitor"),n.provide("goog.debug.entryPointRegistry"),n.require("goog.asserts"),n.debug.EntryPointMonitor=function(){},n.debug.EntryPointMonitor.prototype.wrap,n.debug.EntryPointMonitor.prototype.unwrap,n.debug.entryPointRegistry.refList_=[],n.debug.entryPointRegistry.monitors_=[],n.debug.entryPointRegistry.monitorsMayExist_=!1,n.debug.entryPointRegistry.register=function(e){if(n.debug.entryPointRegistry.refList_[n.debug.entryPointRegistry.refList_.length]=e,n.debug.entryPointRegistry.monitorsMayExist_)for(var t=n.debug.entryPointRegistry.monitors_,r=0;r<t.length;r++)e(n.bind(t[r].wrap,t[r]))},n.debug.entryPointRegistry.monitorAll=function(e){n.debug.entryPointRegistry.monitorsMayExist_=!0;for(var t=n.bind(e.wrap,e),r=0;r<n.debug.entryPointRegistry.refList_.length;r++)n.debug.entryPointRegistry.refList_[r](t);n.debug.entryPointRegistry.monitors_.push(e)},n.debug.entryPointRegistry.unmonitorAllIfPossible=function(e){var t=n.debug.entryPointRegistry.monitors_;n.asserts.assert(e==t[t.length-1],"Only the most recent monitor can be unwrapped.");for(var r=n.bind(e.unwrap,e),i=0;i<n.debug.entryPointRegistry.refList_.length;i++)n.debug.entryPointRegistry.refList_[i](r);t.length--},n.provide("goog.events.EventType"),n.require("goog.userAgent"),n.events.getVendorPrefixedName_=function(e){return n.userAgent.WEBKIT?"webkit"+e:n.userAgent.OPERA?"o"+e.toLowerCase():e.toLowerCase()},n.events.EventType={CLICK:"click",RIGHTCLICK:"rightclick",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTSTART:"selectstart",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:n.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:n.userAgent.IE?"focusout":"DOMFocusOut",CHANGE:"change",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONSOLEMESSAGE:"consolemessage",CONTEXTMENU:"contextmenu",DOMCONTENTLOADED:"DOMContentLoaded",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",ORIENTATIONCHANGE:"orientationchange",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",ANIMATIONSTART:n.events.getVendorPrefixedName_("AnimationStart"),ANIMATIONEND:n.events.getVendorPrefixedName_("AnimationEnd"),ANIMATIONITERATION:n.events.getVendorPrefixedName_("AnimationIteration"),TRANSITIONEND:n.events.getVendorPrefixedName_("TransitionEnd"),POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERCANCEL:"pointercancel",POINTERMOVE:"pointermove",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERENTER:"MSPointerEnter",MSPOINTERHOVER:"MSPointerHover",MSPOINTERLEAVE:"MSPointerLeave",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROUT:"MSPointerOut",MSPOINTEROVER:"MSPointerOver",MSPOINTERUP:"MSPointerUp",TEXTINPUT:"textinput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",EXIT:"exit",LOADABORT:"loadabort",LOADCOMMIT:"loadcommit",LOADREDIRECT:"loadredirect",LOADSTART:"loadstart",LOADSTOP:"loadstop",RESPONSIVE:"responsive",SIZECHANGED:"sizechanged",UNRESPONSIVE:"unresponsive",VISIBILITYCHANGE:"visibilitychange",STORAGE:"storage",DOMSUBTREEMODIFIED:"DOMSubtreeModified",DOMNODEINSERTED:"DOMNodeInserted",DOMNODEREMOVED:"DOMNodeRemoved",DOMNODEREMOVEDFROMDOCUMENT:"DOMNodeRemovedFromDocument",DOMNODEINSERTEDINTODOCUMENT:"DOMNodeInsertedIntoDocument",DOMATTRMODIFIED:"DOMAttrModified",DOMCHARACTERDATAMODIFIED:"DOMCharacterDataModified"},n.provide("goog.events.Event"),n.provide("goog.events.EventLike"),n.require("goog.Disposable"),n.require("goog.events.EventId"),n.events.EventLike,n.events.Event=function(e,t){this.type=e instanceof n.events.EventId?String(e):e,this.target=t,this.currentTarget=this.target,this.propagationStopped_=!1,this.defaultPrevented=!1,this.returnValue_=!0},n.events.Event.prototype.disposeInternal=function(){},n.events.Event.prototype.dispose=function(){},n.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0},n.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0,this.returnValue_=!1},n.events.Event.stopPropagation=function(e){e.stopPropagation()},n.events.Event.preventDefault=function(e){e.preventDefault()},n.provide("goog.reflect"),n.reflect.object=function(e,t){return t},n.reflect.sinkValue=function(e){return n.reflect.sinkValue[" "](e),e},n.reflect.sinkValue[" "]=n.nullFunction,n.reflect.canAccessProperty=function(e,t){try{return n.reflect.sinkValue(e[t]),!0}catch(e){}return!1},n.provide("goog.events.BrowserEvent"),n.provide("goog.events.BrowserEvent.MouseButton"),n.require("goog.events.BrowserFeature"),n.require("goog.events.Event"),n.require("goog.events.EventType"),n.require("goog.reflect"),n.require("goog.userAgent"),n.events.BrowserEvent=function(e,t){n.events.BrowserEvent.base(this,"constructor",e?e.type:""),this.target=null,this.currentTarget=null,this.relatedTarget=null,this.offsetX=0,this.offsetY=0,this.clientX=0,this.clientY=0,this.screenX=0,this.screenY=0,this.button=0,this.keyCode=0,this.charCode=0,this.ctrlKey=!1,this.altKey=!1,this.shiftKey=!1,this.metaKey=!1,this.state=null,this.platformModifierKey=!1,this.event_=null,e&&this.init(e,t)},n.inherits(n.events.BrowserEvent,n.events.Event),n.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2},n.events.BrowserEvent.IEButtonMap=[1,4,2],n.events.BrowserEvent.prototype.init=function(e,t){var r=this.type=e.type;this.target=e.target||e.srcElement,this.currentTarget=t;var i=e.relatedTarget;i?n.userAgent.GECKO&&(n.reflect.canAccessProperty(i,"nodeName")||(i=null)):r==n.events.EventType.MOUSEOVER?i=e.fromElement:r==n.events.EventType.MOUSEOUT&&(i=e.toElement),this.relatedTarget=i,this.offsetX=n.userAgent.WEBKIT||void 0!==e.offsetX?e.offsetX:e.layerX,this.offsetY=n.userAgent.WEBKIT||void 0!==e.offsetY?e.offsetY:e.layerY,this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0,this.button=e.button,this.keyCode=e.keyCode||0,this.charCode=e.charCode||("keypress"==r?e.keyCode:0),this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.platformModifierKey=n.userAgent.MAC?e.metaKey:e.ctrlKey,this.state=e.state,this.event_=e,e.defaultPrevented&&this.preventDefault()},n.events.BrowserEvent.prototype.isButton=function(e){return n.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==e:"click"==this.type?e==n.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&n.events.BrowserEvent.IEButtonMap[e])},n.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(n.events.BrowserEvent.MouseButton.LEFT)&&!(n.userAgent.WEBKIT&&n.userAgent.MAC&&this.ctrlKey)},n.events.BrowserEvent.prototype.stopPropagation=function(){n.events.BrowserEvent.superClass_.stopPropagation.call(this),this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0},n.events.BrowserEvent.prototype.preventDefault=function(){n.events.BrowserEvent.superClass_.preventDefault.call(this);var e=this.event_;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,n.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{(e.ctrlKey||e.keyCode>=112&&e.keyCode<=123)&&(e.keyCode=-1)}catch(e){}},n.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_},n.events.BrowserEvent.prototype.disposeInternal=function(){},n.provide("goog.events"),n.provide("goog.events.CaptureSimulationMode"),n.provide("goog.events.Key"),n.provide("goog.events.ListenableType"),n.require("goog.asserts"),n.require("goog.debug.entryPointRegistry"),n.require("goog.events.BrowserEvent"),n.require("goog.events.BrowserFeature"),n.require("goog.events.Listenable"),n.require("goog.events.ListenerMap"),n.events.Key,n.events.ListenableType,n.events.listeners_={},n.events.LISTENER_MAP_PROP_="closure_lm_"+(1e6*Math.random()|0),n.events.onString_="on",n.events.onStringMap_={},n.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2},n.define("goog.events.CAPTURE_SIMULATION_MODE",2),n.events.listenerCountEstimate_=0,n.events.listen=function(e,t,r,i,o){if(n.isArray(t)){for(var s=0;s<t.length;s++)n.events.listen(e,t[s],r,i,o);return null}return r=n.events.wrapListener(r),n.events.Listenable.isImplementedBy(e)?e.listen(t,r,i,o):n.events.listen_(e,t,r,!1,i,o)},n.events.listen_=function(e,t,r,i,o,s){if(!t)throw Error("Invalid event type");var a=!!o;if(a&&!n.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){if(n.events.CAPTURE_SIMULATION_MODE==n.events.CaptureSimulationMode.OFF_AND_FAIL)return n.asserts.fail("Can not register capture listener in IE8-."),null;if(n.events.CAPTURE_SIMULATION_MODE==n.events.CaptureSimulationMode.OFF_AND_SILENT)return null}var l=n.events.getListenerMap_(e);l||(e[n.events.LISTENER_MAP_PROP_]=l=new n.events.ListenerMap(e));var h=l.add(t,r,i,o,s);if(h.proxy)return h;var p=n.events.getProxy();return h.proxy=p,p.src=e,p.listener=h,e.addEventListener?e.addEventListener(t.toString(),p,a):e.attachEvent(n.events.getOnString_(t.toString()),p),n.events.listenerCountEstimate_++,h},n.events.getProxy=function(){var e=n.events.handleBrowserEvent_,t=n.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(r){return e.call(t.src,t.listener,r)}:function(r){var n=e.call(t.src,t.listener,r);if(!n)return n};return t},n.events.listenOnce=function(e,t,r,i,o){if(n.isArray(t)){for(var s=0;s<t.length;s++)n.events.listenOnce(e,t[s],r,i,o);return null}return r=n.events.wrapListener(r),n.events.Listenable.isImplementedBy(e)?e.listenOnce(t,r,i,o):n.events.listen_(e,t,r,!0,i,o)},n.events.listenWithWrapper=function(e,t,r,n,i){t.listen(e,r,n,i)},n.events.unlisten=function(e,t,r,i,o){if(n.isArray(t)){for(var s=0;s<t.length;s++)n.events.unlisten(e,t[s],r,i,o);return null}if(r=n.events.wrapListener(r),n.events.Listenable.isImplementedBy(e))return e.unlisten(t,r,i,o);if(!e)return!1;var a=!!i,l=n.events.getListenerMap_(e);if(l){var h=l.getListener(t,r,a,o);if(h)return n.events.unlistenByKey(h)}return!1},n.events.unlistenByKey=function(e){if(n.isNumber(e))return!1;var t=e;if(!t||t.removed)return!1;var r=t.src;if(n.events.Listenable.isImplementedBy(r))return r.unlistenByKey(t);var i=t.type,o=t.proxy;r.removeEventListener?r.removeEventListener(i,o,t.capture):r.detachEvent&&r.detachEvent(n.events.getOnString_(i),o),n.events.listenerCountEstimate_--;var s=n.events.getListenerMap_(r);return s?(s.removeByKey(t),0==s.getTypeCount()&&(s.src=null,r[n.events.LISTENER_MAP_PROP_]=null)):t.markAsRemoved(),!0},n.events.unlistenWithWrapper=function(e,t,r,n,i){t.unlisten(e,r,n,i)},n.events.removeAll=function(e,t){if(!e)return 0;if(n.events.Listenable.isImplementedBy(e))return e.removeAllListeners(t);var r=n.events.getListenerMap_(e);if(!r)return 0;var i=0,o=t&&t.toString();for(var s in r.listeners)if(!o||s==o)for(var a=r.listeners[s].concat(),l=0;l<a.length;++l)n.events.unlistenByKey(a[l])&&++i;return i},n.events.removeAllNativeListeners=function(){return n.events.listenerCountEstimate_=0,0},n.events.getListeners=function(e,t,r){if(n.events.Listenable.isImplementedBy(e))return e.getListeners(t,r);if(!e)return[];var i=n.events.getListenerMap_(e);return i?i.getListeners(t,r):[]},n.events.getListener=function(e,t,r,i,o){t=t,r=n.events.wrapListener(r);var s=!!i;if(n.events.Listenable.isImplementedBy(e))return e.getListener(t,r,s,o);if(!e)return null;var a=n.events.getListenerMap_(e);return a?a.getListener(t,r,s,o):null},n.events.hasListener=function(e,t,r){if(n.events.Listenable.isImplementedBy(e))return e.hasListener(t,r);var i=n.events.getListenerMap_(e);return!!i&&i.hasListener(t,r)},n.events.expose=function(e){var t=[];for(var r in e)e[r]&&e[r].id?t.push(r+" = "+e[r]+" ("+e[r].id+")"):t.push(r+" = "+e[r]);return t.join("\n")},n.events.getOnString_=function(e){return e in n.events.onStringMap_?n.events.onStringMap_[e]:n.events.onStringMap_[e]=n.events.onString_+e},n.events.fireListeners=function(e,t,r,i){return n.events.Listenable.isImplementedBy(e)?e.fireListeners(t,r,i):n.events.fireListeners_(e,t,r,i)},n.events.fireListeners_=function(e,t,r,i){var o=1,s=n.events.getListenerMap_(e);if(s){var a=s.listeners[t.toString()];if(a){a=a.concat();for(var l=0;l<a.length;l++){var h=a[l];h&&h.capture==r&&!h.removed&&(o&=!1!==n.events.fireListener(h,i))}}}return Boolean(o)},n.events.fireListener=function(e,t){var r=e.listener,i=e.handler||e.src;return e.callOnce&&n.events.unlistenByKey(e),r.call(i,t)},n.events.getTotalListenerCount=function(){return n.events.listenerCountEstimate_},n.events.dispatchEvent=function(e,t){return n.asserts.assert(n.events.Listenable.isImplementedBy(e),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance."),e.dispatchEvent(t)},n.events.protectBrowserEventEntryPoint=function(e){n.events.handleBrowserEvent_=e.protectEntryPoint(n.events.handleBrowserEvent_)},n.events.handleBrowserEvent_=function(e,t){if(e.removed)return!0;if(!n.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var r=t||n.getObjectByName("window.event"),i=new n.events.BrowserEvent(r,this),o=!0;if(n.events.CAPTURE_SIMULATION_MODE==n.events.CaptureSimulationMode.ON){if(!n.events.isMarkedIeEvent_(r)){n.events.markIeEvent_(r);for(var s=[],a=i.currentTarget;a;a=a.parentNode)s.push(a);for(var l=e.type,h=s.length-1;!i.propagationStopped_&&h>=0;h--)i.currentTarget=s[h],o&=n.events.fireListeners_(s[h],l,!0,i);for(var h=0;!i.propagationStopped_&&h<s.length;h++)i.currentTarget=s[h],o&=n.events.fireListeners_(s[h],l,!1,i)}}else o=n.events.fireListener(e,i);return o}return n.events.fireListener(e,new n.events.BrowserEvent(t,this))},n.events.markIeEvent_=function(e){var t=!1;if(0==e.keyCode)try{return void(e.keyCode=-1)}catch(e){t=!0}(t||void 0==e.returnValue)&&(e.returnValue=!0)},n.events.isMarkedIeEvent_=function(e){return e.keyCode<0||void 0!=e.returnValue},n.events.uniqueIdCounter_=0,n.events.getUniqueId=function(e){return e+"_"+n.events.uniqueIdCounter_++},n.events.getListenerMap_=function(e){var t=e[n.events.LISTENER_MAP_PROP_];return t instanceof n.events.ListenerMap?t:null},n.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1e9*Math.random()>>>0),n.events.wrapListener=function(e){return n.asserts.assert(e,"Listener can not be null."),n.isFunction(e)?e:(n.asserts.assert(e.handleEvent,"An object listener must have handleEvent method."),e[n.events.LISTENER_WRAPPER_PROP_]||(e[n.events.LISTENER_WRAPPER_PROP_]=function(t){return e.handleEvent(t)}))},n.debug.entryPointRegistry.register(function(e){n.events.handleBrowserEvent_=e(n.events.handleBrowserEvent_)}),n.provide("goog.events.EventHandler"),n.require("goog.Disposable"),n.require("goog.events"),n.require("goog.object"),n.events.EventHandler=function(e){n.Disposable.call(this),this.handler_=e,this.keys_={}},n.inherits(n.events.EventHandler,n.Disposable),n.events.EventHandler.typeArray_=[],n.events.EventHandler.prototype.listen=function(e,t,r,n){return this.listen_(e,t,r,n)},n.events.EventHandler.prototype.listenWithScope=function(e,t,r,n,i){return this.listen_(e,t,r,n,i)},n.events.EventHandler.prototype.listen_=function(e,t,r,i,o){n.isArray(t)||(t&&(n.events.EventHandler.typeArray_[0]=t.toString()),t=n.events.EventHandler.typeArray_);for(var s=0;s<t.length;s++){var a=n.events.listen(e,t[s],r||this.handleEvent,i||!1,o||this.handler_||this);if(!a)return this;var l=a.key;this.keys_[l]=a}return this},n.events.EventHandler.prototype.listenOnce=function(e,t,r,n){return this.listenOnce_(e,t,r,n)},n.events.EventHandler.prototype.listenOnceWithScope=function(e,t,r,n,i){return this.listenOnce_(e,t,r,n,i)},n.events.EventHandler.prototype.listenOnce_=function(e,t,r,i,o){if(n.isArray(t))for(var s=0;s<t.length;s++)this.listenOnce_(e,t[s],r,i,o);else{var a=n.events.listenOnce(e,t,r||this.handleEvent,i,o||this.handler_||this);if(!a)return this;var l=a.key;this.keys_[l]=a}return this},n.events.EventHandler.prototype.listenWithWrapper=function(e,t,r,n){return this.listenWithWrapper_(e,t,r,n)},n.events.EventHandler.prototype.listenWithWrapperAndScope=function(e,t,r,n,i){return this.listenWithWrapper_(e,t,r,n,i)},n.events.EventHandler.prototype.listenWithWrapper_=function(e,t,r,n,i){return t.listen(e,r,n,i||this.handler_||this,this),this},n.events.EventHandler.prototype.getListenerCount=function(){var e=0;for(var t in this.keys_)Object.prototype.hasOwnProperty.call(this.keys_,t)&&e++;return e},n.events.EventHandler.prototype.unlisten=function(e,t,r,i,o){if(n.isArray(t))for(var s=0;s<t.length;s++)this.unlisten(e,t[s],r,i,o);else{var a=n.events.getListener(e,t,r||this.handleEvent,i,o||this.handler_||this);a&&(n.events.unlistenByKey(a),delete this.keys_[a.key])}return this},n.events.EventHandler.prototype.unlistenWithWrapper=function(e,t,r,n,i){return t.unlisten(e,r,n,i||this.handler_||this,this),this},n.events.EventHandler.prototype.removeAll=function(){n.object.forEach(this.keys_,n.events.unlistenByKey),this.keys_={}},n.events.EventHandler.prototype.disposeInternal=function(){n.events.EventHandler.superClass_.disposeInternal.call(this),this.removeAll()},n.events.EventHandler.prototype.handleEvent=function(e){throw Error("EventHandler.handleEvent not implemented")},n.provide("goog.style.bidi"),n.require("goog.dom"),n.require("goog.style"),n.require("goog.userAgent"),n.style.bidi.getScrollLeft=function(e){var t=n.style.isRightToLeft(e);if(t&&n.userAgent.GECKO)return-e.scrollLeft;if(t&&(!n.userAgent.IE||!n.userAgent.isVersionOrHigher("8"))){return"visible"==n.style.getComputedOverflowX(e)?e.scrollLeft:e.scrollWidth-e.clientWidth-e.scrollLeft}return e.scrollLeft},n.style.bidi.getOffsetStart=function(e){var t=e.offsetLeft,r=e.offsetParent;if(r||"fixed"!=n.style.getComputedPosition(e)||(r=n.dom.getOwnerDocument(e).documentElement),!r)return t;if(n.userAgent.GECKO){var i=n.style.getBorderBox(r);t+=i.left}else if(n.userAgent.isDocumentModeOrHigher(8)){var i=n.style.getBorderBox(r);t-=i.left}if(n.style.isRightToLeft(r)){var o=t+e.offsetWidth;return r.clientWidth-o}return t},n.style.bidi.setScrollOffset=function(e,t){t=Math.max(t,0),n.style.isRightToLeft(e)?n.userAgent.GECKO?e.scrollLeft=-t:n.userAgent.IE&&n.userAgent.isVersionOrHigher("8")?e.scrollLeft=t:e.scrollLeft=e.scrollWidth-t-e.clientWidth:e.scrollLeft=t},n.style.bidi.setPosition=function(e,t,r,i){n.isNull(r)||(e.style.top=r+"px"),i?(e.style.right=t+"px",e.style.left=""):(e.style.left=t+"px",e.style.right="")},n.provide("goog.events.EventTarget"),n.require("goog.Disposable"),n.require("goog.asserts"),n.require("goog.events"),n.require("goog.events.Event"),n.require("goog.events.Listenable"),n.require("goog.events.ListenerMap"),n.require("goog.object"),n.events.EventTarget=function(){n.Disposable.call(this),this.eventTargetListeners_=new n.events.ListenerMap(this),this.actualEventTarget_=this},n.inherits(n.events.EventTarget,n.Disposable),n.events.Listenable.addImplementation(n.events.EventTarget),n.events.EventTarget.MAX_ANCESTORS_=1e3,n.events.EventTarget.prototype.parentEventTarget_=null,n.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_},n.events.EventTarget.prototype.setParentEventTarget=function(e){this.parentEventTarget_=e},n.events.EventTarget.prototype.addEventListener=function(e,t,r,i){n.events.listen(this,e,t,r,i)},n.events.EventTarget.prototype.removeEventListener=function(e,t,r,i){n.events.unlisten(this,e,t,r,i)},n.events.EventTarget.prototype.dispatchEvent=function(e){this.assertInitialized_();var t,r=this.getParentEventTarget();if(r){t=[];for(var i=1;r;r=r.getParentEventTarget())t.push(r),n.asserts.assert(++i<n.events.EventTarget.MAX_ANCESTORS_,"infinite loop")}return n.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,e,t)},n.events.EventTarget.prototype.disposeInternal=function(){n.events.EventTarget.superClass_.disposeInternal.call(this),this.removeAllListeners(),this.parentEventTarget_=null},n.events.EventTarget.prototype.listen=function(e,t,r,n){return this.assertInitialized_(),this.eventTargetListeners_.add(String(e),t,!1,r,n)},n.events.EventTarget.prototype.listenOnce=function(e,t,r,n){return this.eventTargetListeners_.add(String(e),t,!0,r,n)},n.events.EventTarget.prototype.unlisten=function(e,t,r,n){return this.eventTargetListeners_.remove(String(e),t,r,n)},n.events.EventTarget.prototype.unlistenByKey=function(e){return this.eventTargetListeners_.removeByKey(e)},n.events.EventTarget.prototype.removeAllListeners=function(e){return this.eventTargetListeners_?this.eventTargetListeners_.removeAll(e):0},n.events.EventTarget.prototype.fireListeners=function(e,t,r){var n=this.eventTargetListeners_.listeners[String(e)];if(!n)return!0;n=n.concat();for(var i=!0,o=0;o<n.length;++o){var s=n[o];if(s&&!s.removed&&s.capture==t){var a=s.listener,l=s.handler||s.src;s.callOnce&&this.unlistenByKey(s),i=!1!==a.call(l,r)&&i}}return i&&0!=r.returnValue_},n.events.EventTarget.prototype.getListeners=function(e,t){return this.eventTargetListeners_.getListeners(String(e),t)},n.events.EventTarget.prototype.getListener=function(e,t,r,n){return this.eventTargetListeners_.getListener(String(e),t,r,n)},n.events.EventTarget.prototype.hasListener=function(e,t){var r=n.isDef(e)?String(e):void 0;return this.eventTargetListeners_.hasListener(r,t)};n.events.EventTarget.prototype.setTargetForTesting=function(e){this.actualEventTarget_=e},n.events.EventTarget.prototype.assertInitialized_=function(){n.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")},n.events.EventTarget.dispatchEventInternal_=function(e,t,r){var i=t.type||t;if(n.isString(t))t=new n.events.Event(t,e);else if(t instanceof n.events.Event)t.target=t.target||e;else{var o=t;t=new n.events.Event(i,e),n.object.extend(t,o)}var s,a=!0;if(r)for(var l=r.length-1;!t.propagationStopped_&&l>=0;l--)s=t.currentTarget=r[l],a=s.fireListeners(i,!0,t)&&a;if(t.propagationStopped_||(s=t.currentTarget=e,a=s.fireListeners(i,!0,t)&&a,t.propagationStopped_||(a=s.fireListeners(i,!1,t)&&a)),r)for(l=0;!t.propagationStopped_&&l<r.length;l++)s=t.currentTarget=r[l],a=s.fireListeners(i,!1,t)&&a;return a},n.provide("goog.fx.DragEvent"),n.provide("goog.fx.Dragger"),n.provide("goog.fx.Dragger.EventType"),n.require("goog.dom"),n.require("goog.events"),n.require("goog.events.Event"),n.require("goog.events.EventHandler"),n.require("goog.events.EventTarget"),n.require("goog.events.EventType"),n.require("goog.math.Coordinate"),n.require("goog.math.Rect"),n.require("goog.style"),n.require("goog.style.bidi"),n.require("goog.userAgent"),n.fx.Dragger=function(e,t,r){n.events.EventTarget.call(this),this.target=e,this.handle=t||e,this.limits=r||new n.math.Rect(NaN,NaN,NaN,NaN),this.document_=n.dom.getOwnerDocument(e),this.eventHandler_=new n.events.EventHandler(this),this.registerDisposable(this.eventHandler_),n.events.listen(this.handle,[n.events.EventType.TOUCHSTART,n.events.EventType.MOUSEDOWN],this.startDrag,!1,this)},n.inherits(n.fx.Dragger,n.events.EventTarget),n.fx.Dragger.HAS_SET_CAPTURE_=n.userAgent.IE||n.userAgent.GECKO&&n.userAgent.isVersionOrHigher("1.9.3"),n.fx.Dragger.cloneNode=function(e){for(var t=e.cloneNode(!0),r=e.getElementsByTagName("textarea"),i=t.getElementsByTagName("textarea"),o=0;o<r.length;o++)i[o].value=r[o].value;switch(e.tagName.toLowerCase()){case"tr":return n.dom.createDom("table",null,n.dom.createDom("tbody",null,t));case"td":case"th":return n.dom.createDom("table",null,n.dom.createDom("tbody",null,n.dom.createDom("tr",null,t)));case"textarea":t.value=e.value;default:return t}},n.fx.Dragger.EventType={EARLY_CANCEL:"earlycancel",START:"start",BEFOREDRAG:"beforedrag",DRAG:"drag",END:"end"},n.fx.Dragger.prototype.target,n.fx.Dragger.prototype.handle,n.fx.Dragger.prototype.limits,n.fx.Dragger.prototype.rightToLeft_,n.fx.Dragger.prototype.clientX=0,n.fx.Dragger.prototype.clientY=0,n.fx.Dragger.prototype.screenX=0,n.fx.Dragger.prototype.screenY=0,n.fx.Dragger.prototype.startX=0,n.fx.Dragger.prototype.startY=0,n.fx.Dragger.prototype.deltaX=0,n.fx.Dragger.prototype.deltaY=0,n.fx.Dragger.prototype.pageScroll,n.fx.Dragger.prototype.enabled_=!0,n.fx.Dragger.prototype.dragging_=!1,n.fx.Dragger.prototype.hysteresisDistanceSquared_=0,n.fx.Dragger.prototype.mouseDownTime_=0,n.fx.Dragger.prototype.document_,n.fx.Dragger.prototype.scrollTarget_,n.fx.Dragger.prototype.ieDragStartCancellingOn_=!1,n.fx.Dragger.prototype.useRightPositioningForRtl_=!1,n.fx.Dragger.prototype.enableRightPositioningForRtl=function(e){this.useRightPositioningForRtl_=e},n.fx.Dragger.prototype.getHandler=function(){return this.eventHandler_},n.fx.Dragger.prototype.setLimits=function(e){this.limits=e||new n.math.Rect(NaN,NaN,NaN,NaN)},n.fx.Dragger.prototype.setHysteresis=function(e){this.hysteresisDistanceSquared_=Math.pow(e,2)},n.fx.Dragger.prototype.getHysteresis=function(){return Math.sqrt(this.hysteresisDistanceSquared_)},n.fx.Dragger.prototype.setScrollTarget=function(e){this.scrollTarget_=e},n.fx.Dragger.prototype.setCancelIeDragStart=function(e){this.ieDragStartCancellingOn_=e},n.fx.Dragger.prototype.getEnabled=function(){return this.enabled_},n.fx.Dragger.prototype.setEnabled=function(e){this.enabled_=e},n.fx.Dragger.prototype.disposeInternal=function(){n.fx.Dragger.superClass_.disposeInternal.call(this),n.events.unlisten(this.handle,[n.events.EventType.TOUCHSTART,n.events.EventType.MOUSEDOWN],this.startDrag,!1,this),this.cleanUpAfterDragging_(),this.target=null,this.handle=null},n.fx.Dragger.prototype.isRightToLeft_=function(){return n.isDef(this.rightToLeft_)||(this.rightToLeft_=n.style.isRightToLeft(this.target)),this.rightToLeft_},n.fx.Dragger.prototype.startDrag=function(e){var t=e.type==n.events.EventType.MOUSEDOWN;if(!this.enabled_||this.dragging_||t&&!e.isMouseActionButton())this.dispatchEvent(n.fx.Dragger.EventType.EARLY_CANCEL);else{if(this.maybeReinitTouchEvent_(e),0==this.hysteresisDistanceSquared_){if(!this.fireDragStart_(e))return;this.dragging_=!0,e.preventDefault()}else e.preventDefault();this.setupDragHandlers(),this.clientX=this.startX=e.clientX,this.clientY=this.startY=e.clientY,this.screenX=e.screenX,this.screenY=e.screenY,this.computeInitialPosition(),this.pageScroll=n.dom.getDomHelper(this.document_).getDocumentScroll(),this.mouseDownTime_=n.now()}},n.fx.Dragger.prototype.setupDragHandlers=function(){var e=this.document_,t=e.documentElement,r=!n.fx.Dragger.HAS_SET_CAPTURE_;this.eventHandler_.listen(e,[n.events.EventType.TOUCHMOVE,n.events.EventType.MOUSEMOVE],this.handleMove_,r),this.eventHandler_.listen(e,[n.events.EventType.TOUCHEND,n.events.EventType.MOUSEUP],this.endDrag,r),n.fx.Dragger.HAS_SET_CAPTURE_?(t.setCapture(!1),this.eventHandler_.listen(t,n.events.EventType.LOSECAPTURE,this.endDrag)):this.eventHandler_.listen(n.dom.getWindow(e),n.events.EventType.BLUR,this.endDrag),n.userAgent.IE&&this.ieDragStartCancellingOn_&&this.eventHandler_.listen(e,n.events.EventType.DRAGSTART,n.events.Event.preventDefault),this.scrollTarget_&&this.eventHandler_.listen(this.scrollTarget_,n.events.EventType.SCROLL,this.onScroll_,r)},n.fx.Dragger.prototype.fireDragStart_=function(e){return this.dispatchEvent(new n.fx.DragEvent(n.fx.Dragger.EventType.START,this,e.clientX,e.clientY,e))},n.fx.Dragger.prototype.cleanUpAfterDragging_=function(){this.eventHandler_.removeAll(),n.fx.Dragger.HAS_SET_CAPTURE_&&this.document_.releaseCapture()},n.fx.Dragger.prototype.endDrag=function(e,t){if(this.cleanUpAfterDragging_(),this.dragging_){this.maybeReinitTouchEvent_(e),this.dragging_=!1;var r=this.limitX(this.deltaX),i=this.limitY(this.deltaY),o=t||e.type==n.events.EventType.TOUCHCANCEL;this.dispatchEvent(new n.fx.DragEvent(n.fx.Dragger.EventType.END,this,e.clientX,e.clientY,e,r,i,o))}else this.dispatchEvent(n.fx.Dragger.EventType.EARLY_CANCEL)},n.fx.Dragger.prototype.endDragCancel=function(e){this.endDrag(e,!0)},n.fx.Dragger.prototype.maybeReinitTouchEvent_=function(e){var t=e.type;t==n.events.EventType.TOUCHSTART||t==n.events.EventType.TOUCHMOVE?e.init(e.getBrowserEvent().targetTouches[0],e.currentTarget):t!=n.events.EventType.TOUCHEND&&t!=n.events.EventType.TOUCHCANCEL||e.init(e.getBrowserEvent().changedTouches[0],e.currentTarget)},n.fx.Dragger.prototype.handleMove_=function(e){if(this.enabled_){this.maybeReinitTouchEvent_(e);var t=this.useRightPositioningForRtl_&&this.isRightToLeft_()?-1:1,r=t*(e.clientX-this.clientX),i=e.clientY-this.clientY;if(this.clientX=e.clientX,this.clientY=e.clientY,this.screenX=e.screenX,this.screenY=e.screenY,!this.dragging_){var o=this.startX-this.clientX,s=this.startY-this.clientY;if(o*o+s*s>this.hysteresisDistanceSquared_){if(!this.fireDragStart_(e))return void(this.isDisposed()||this.endDrag(e));this.dragging_=!0}}var a=this.calculatePosition_(r,i),l=a.x,h=a.y;if(this.dragging_){this.dispatchEvent(new n.fx.DragEvent(n.fx.Dragger.EventType.BEFOREDRAG,this,e.clientX,e.clientY,e,l,h))&&(this.doDrag(e,l,h,!1),e.preventDefault())}}},n.fx.Dragger.prototype.calculatePosition_=function(e,t){var r=n.dom.getDomHelper(this.document_).getDocumentScroll();e+=r.x-this.pageScroll.x,t+=r.y-this.pageScroll.y,this.pageScroll=r,this.deltaX+=e,this.deltaY+=t;var i=this.limitX(this.deltaX),o=this.limitY(this.deltaY);return new n.math.Coordinate(i,o)},n.fx.Dragger.prototype.onScroll_=function(e){var t=this.calculatePosition_(0,0);e.clientX=this.clientX,e.clientY=this.clientY,this.doDrag(e,t.x,t.y,!0)},n.fx.Dragger.prototype.doDrag=function(e,t,r,i){this.defaultAction(t,r),this.dispatchEvent(new n.fx.DragEvent(n.fx.Dragger.EventType.DRAG,this,e.clientX,e.clientY,e,t,r))},n.fx.Dragger.prototype.limitX=function(e){var t=this.limits,r=isNaN(t.left)?null:t.left,n=isNaN(t.width)?0:t.width,i=null!=r?r+n:1/0,o=null!=r?r:-1/0;return Math.min(i,Math.max(o,e))},n.fx.Dragger.prototype.limitY=function(e){var t=this.limits,r=isNaN(t.top)?null:t.top,n=isNaN(t.height)?0:t.height,i=null!=r?r+n:1/0,o=null!=r?r:-1/0;return Math.min(i,Math.max(o,e))},n.fx.Dragger.prototype.computeInitialPosition=function(){this.deltaX=this.useRightPositioningForRtl_?n.style.bidi.getOffsetStart(this.target):this.target.offsetLeft,this.deltaY=this.target.offsetTop},n.fx.Dragger.prototype.defaultAction=function(e,t){this.useRightPositioningForRtl_&&this.isRightToLeft_()?this.target.style.right=e+"px":this.target.style.left=e+"px",this.target.style.top=t+"px"},n.fx.Dragger.prototype.isDragging=function(){return this.dragging_},n.fx.DragEvent=function(e,t,r,i,o,s,a,l){n.events.Event.call(this,e),this.clientX=r,this.clientY=i,this.browserEvent=o,this.left=n.isDef(s)?s:t.deltaX,this.top=n.isDef(a)?a:t.deltaY,this.dragger=t,this.dragCanceled=!!l},n.inherits(n.fx.DragEvent,n.events.Event),n.provide("goog.math.AffineTransform"),n.require("goog.math"),n.math.AffineTransform=function(e,t,r,n,i,o){if(6==arguments.length)this.setTransform(e,t,r,n,i,o);else{if(0!=arguments.length)throw Error("Insufficient matrix parameters");this.m00_=this.m11_=1,this.m10_=this.m01_=this.m02_=this.m12_=0}},n.math.AffineTransform.prototype.isIdentity=function(){return 1==this.m00_&&0==this.m10_&&0==this.m01_&&1==this.m11_&&0==this.m02_&&0==this.m12_},n.math.AffineTransform.prototype.clone=function(){return new n.math.AffineTransform(this.m00_,this.m10_,this.m01_,this.m11_,this.m02_,this.m12_)},n.math.AffineTransform.prototype.setTransform=function(e,t,r,i,o,s){if(!(n.isNumber(e)&&n.isNumber(t)&&n.isNumber(r)&&n.isNumber(i)&&n.isNumber(o)&&n.isNumber(s)))throw Error("Invalid transform parameters");return this.m00_=e,this.m10_=t,this.m01_=r,this.m11_=i,this.m02_=o,this.m12_=s,this},n.math.AffineTransform.prototype.copyFrom=function(e){return this.m00_=e.m00_,this.m10_=e.m10_,this.m01_=e.m01_,this.m11_=e.m11_,this.m02_=e.m02_,this.m12_=e.m12_,this},n.math.AffineTransform.prototype.scale=function(e,t){return this.m00_*=e,this.m10_*=e,this.m01_*=t,this.m11_*=t,this},n.math.AffineTransform.prototype.preScale=function(e,t){return this.m00_*=e,this.m01_*=e,this.m02_*=e,this.m10_*=t,this.m11_*=t,this.m12_*=t,this},n.math.AffineTransform.prototype.translate=function(e,t){return this.m02_+=e*this.m00_+t*this.m01_,this.m12_+=e*this.m10_+t*this.m11_,this},n.math.AffineTransform.prototype.preTranslate=function(e,t){return this.m02_+=e,this.m12_+=t,this},n.math.AffineTransform.prototype.rotate=function(e,t,r){return this.concatenate(n.math.AffineTransform.getRotateInstance(e,t,r))},n.math.AffineTransform.prototype.preRotate=function(e,t,r){return this.preConcatenate(n.math.AffineTransform.getRotateInstance(e,t,r))},n.math.AffineTransform.prototype.shear=function(e,t){var r=this.m00_,n=this.m10_;return this.m00_+=t*this.m01_,this.m10_+=t*this.m11_,this.m01_+=e*r,this.m11_+=e*n,this},n.math.AffineTransform.prototype.preShear=function(e,t){var r=this.m00_,n=this.m01_,i=this.m02_;return this.m00_+=e*this.m10_,this.m01_+=e*this.m11_,this.m02_+=e*this.m12_,this.m10_+=t*r,this.m11_+=t*n,this.m12_+=t*i,this},n.math.AffineTransform.prototype.toString=function(){return"matrix("+[this.m00_,this.m10_,this.m01_,this.m11_,this.m02_,this.m12_].join(",")+")"},n.math.AffineTransform.prototype.getScaleX=function(){return this.m00_},n.math.AffineTransform.prototype.getScaleY=function(){return this.m11_},n.math.AffineTransform.prototype.getTranslateX=function(){return this.m02_},n.math.AffineTransform.prototype.getTranslateY=function(){return this.m12_},n.math.AffineTransform.prototype.getShearX=function(){return this.m01_},n.math.AffineTransform.prototype.getShearY=function(){return this.m10_},n.math.AffineTransform.prototype.concatenate=function(e){var t=this.m00_,r=this.m01_;return this.m00_=e.m00_*t+e.m10_*r,this.m01_=e.m01_*t+e.m11_*r,this.m02_+=e.m02_*t+e.m12_*r,t=this.m10_,r=this.m11_,this.m10_=e.m00_*t+e.m10_*r,this.m11_=e.m01_*t+e.m11_*r,this.m12_+=e.m02_*t+e.m12_*r,this},n.math.AffineTransform.prototype.preConcatenate=function(e){var t=this.m00_,r=this.m10_;return this.m00_=e.m00_*t+e.m01_*r,this.m10_=e.m10_*t+e.m11_*r,t=this.m01_,r=this.m11_,this.m01_=e.m00_*t+e.m01_*r,this.m11_=e.m10_*t+e.m11_*r,t=this.m02_,r=this.m12_,this.m02_=e.m00_*t+e.m01_*r+e.m02_,this.m12_=e.m10_*t+e.m11_*r+e.m12_,this},n.math.AffineTransform.prototype.transform=function(e,t,r,n,i){for(var o=t,s=n,a=t+2*i;o<a;){var l=e[o++],h=e[o++];r[s++]=l*this.m00_+h*this.m01_+this.m02_,r[s++]=l*this.m10_+h*this.m11_+this.m12_}},n.math.AffineTransform.prototype.getDeterminant=function(){return this.m00_*this.m11_-this.m01_*this.m10_},n.math.AffineTransform.prototype.isInvertible=function(){var e=this.getDeterminant();return n.math.isFiniteNumber(e)&&n.math.isFiniteNumber(this.m02_)&&n.math.isFiniteNumber(this.m12_)&&0!=e},n.math.AffineTransform.prototype.createInverse=function(){var e=this.getDeterminant();return new n.math.AffineTransform(this.m11_/e,-this.m10_/e,-this.m01_/e,this.m00_/e,(this.m01_*this.m12_-this.m11_*this.m02_)/e,(this.m10_*this.m02_-this.m00_*this.m12_)/e)},n.math.AffineTransform.getScaleInstance=function(e,t){return(new n.math.AffineTransform).setToScale(e,t)},n.math.AffineTransform.getTranslateInstance=function(e,t){return(new n.math.AffineTransform).setToTranslation(e,t)},n.math.AffineTransform.getShearInstance=function(e,t){return(new n.math.AffineTransform).setToShear(e,t)},n.math.AffineTransform.getRotateInstance=function(e,t,r){return(new n.math.AffineTransform).setToRotation(e,t,r)},n.math.AffineTransform.prototype.setToScale=function(e,t){return this.setTransform(e,0,0,t,0,0)},n.math.AffineTransform.prototype.setToTranslation=function(e,t){return this.setTransform(1,0,0,1,e,t)},n.math.AffineTransform.prototype.setToShear=function(e,t){return this.setTransform(1,t,e,1,0,0)},n.math.AffineTransform.prototype.setToRotation=function(e,t,r){var n=Math.cos(e),i=Math.sin(e);return this.setTransform(n,i,-i,n,t-t*n+r*i,r-t*i-r*n)},n.math.AffineTransform.prototype.equals=function(e){return this==e||!!e&&(this.m00_==e.m00_&&this.m01_==e.m01_&&this.m02_==e.m02_&&this.m10_==e.m10_&&this.m11_==e.m11_&&this.m12_==e.m12_)},n.provide("xrx.drawing.tool.Tool"),xrx.drawing.tool.Tool=function(e,t,r){this.drawing_=e,this.isActive_=!1,this.element_=t,this.canvas_=r},xrx.drawing.tool.Tool.prototype.isActive=function(){return this.isActive_},xrx.drawing.tool.Tool.prototype.getCanvas=function(){return this.canvas_},n.provide("xrx.drawing.tool.Magnifier"),n.require("goog.dom.DomHelper"),n.require("goog.events"),n.require("goog.events.EventType"),n.require("goog.fx.Dragger"),n.require("goog.math.AffineTransform"),n.require("goog.math.Rect"),n.require("goog.style"),n.require("xrx.canvas"),n.require("xrx.drawing.tool.Tool"),n.require("xrx.engine.Engines"),n.require("xrx.svg"),n.require("xrx.vml"),xrx.drawing.tool.Magnifier=function(e,t,r,i,o){n.base(this,e,t,r),this.group_=i,this.image_=o,this.width_=110,this.height_=100,this.ctm_=new n.math.AffineTransform},n.inherits(xrx.drawing.tool.Magnifier,xrx.drawing.tool.Tool),xrx.drawing.tool.Magnifier.prototype.hide=function(){n.style.setStyle(this.element_,"display","none"),this.isActive_=!1},xrx.drawing.tool.Magnifier.prototype.show=function(){n.style.setStyle(this.element_,"display","block"),this.isActive_=!0},xrx.drawing.tool.Magnifier.prototype.reset=function(){var e=this.canvas_;e.setWidth(this.width_),e.setHeight(this.height_),n.style.setStyle(this.element_,"position","absolute"),n.style.setStyle(this.element_,"display","block"),n.style.setStyle(this.element_,"z-index","1001"),n.style.setStyle(this.element_,"left","50px"),n.style.setStyle(this.element_,"top","50px"),n.style.setStyle(this.element_,"border","solid black 4px"),this.group_.draw()},xrx.drawing.tool.Magnifier.prototype.handleDrag_=function(e,t){var r,n=[t.deltaX+this.width_/2,t.deltaY],i=new Array(2),o=this.drawing_.getViewbox().getCTM(),s=this.drawing_.getEngine();if(o.createInverse().transform(n,0,i,0,1),r=this.ctm_.createInverse().translate(-i[0],-i[1]),s.typeOf(xrx.engine.CANVAS)){var a=this.canvas_.getElement(),l=a.getContext("2d");l.save(),l.fillStyle="white",l.fillRect(0,0,a.width,a.height),l.beginPath(),xrx.canvas.setTransform_(l,r),this.group_.draw(),l.closePath(),l.restore()}else if(s.typeOf(xrx.engine.SVG))xrx.svg.render(this.group_.getElement(),r);else{if(!s.typeOf(xrx.engine.VML))throw Error("Unknown engine.");xrx.vml.render(this.group_.getRaphael(),r)}},xrx.drawing.tool.Magnifier.prototype.registerDrag_=function(){var e=n.style.getSize(this.drawing_.getElement()),t=new n.math.Rect(0,0,e.width,e.height),r=new n.fx.Dragger(this.element_,this.element_,t);n.events.listen(r,n.events.EventType.DRAG,function(e){this.handleDrag_(e,r)},!1,this)},xrx.drawing.tool.Magnifier.create=function(e){var t=e.getGraphics(),r=e.getLayerBackground().getImage(),i=n.dom.createElement("div"),o=t.Canvas.create(e.getElement()),s=t.Group.create(o),a=t.Image.create(r.getImage(),o),l=new xrx.drawing.tool.Magnifier(e,i,o,s,a);return n.dom.appendChild(i,o.getElement()),o.addChild(s),s.addChildren(a),n.dom.appendChild(e.getElement(),i),l.reset(),l.registerDrag_(),l},n.provide("xrx.drawing.LayerTool"),n.require("xrx.drawing.Layer"),n.require("xrx.drawing.tool.Magnifier"),xrx.drawing.LayerTool=function(e){n.base(this,e),this.magnifier_},n.inherits(xrx.drawing.LayerTool,xrx.drawing.Layer),xrx.drawing.LayerTool.prototype.toggleMagnifier=function(){this.magnifier_||(this.magnifier_=xrx.drawing.tool.Magnifier.create(this.drawing_)),this.magnifier_.isActive()?this.magnifier_.hide():this.magnifier_.show()},xrx.drawing.LayerTool.prototype.disposeInternal=function(){this.magnifier_=null,n.base(this,"disposeInternal")},n.provide("goog.events.MouseWheelEvent"),n.provide("goog.events.MouseWheelHandler"),n.provide("goog.events.MouseWheelHandler.EventType"),n.require("goog.dom"),n.require("goog.events"),n.require("goog.events.BrowserEvent"),n.require("goog.events.EventTarget"),n.require("goog.math"),n.require("goog.style"),n.require("goog.userAgent"),n.events.MouseWheelHandler=function(e,t){n.events.EventTarget.call(this),this.element_=e;var r=n.dom.isElement(this.element_)?this.element_:this.element_?this.element_.body:null;this.isRtl_=!!r&&n.style.isRightToLeft(r);var i=n.userAgent.GECKO?"DOMMouseScroll":"mousewheel";this.listenKey_=n.events.listen(this.element_,i,this,t)},n.inherits(n.events.MouseWheelHandler,n.events.EventTarget),n.events.MouseWheelHandler.EventType={MOUSEWHEEL:"mousewheel"},n.events.MouseWheelHandler.prototype.maxDeltaX_,n.events.MouseWheelHandler.prototype.maxDeltaY_,n.events.MouseWheelHandler.prototype.setMaxDeltaX=function(e){this.maxDeltaX_=e},n.events.MouseWheelHandler.prototype.setMaxDeltaY=function(e){this.maxDeltaY_=e},n.events.MouseWheelHandler.prototype.handleEvent=function(e){var t=0,r=0,i=0,o=e.getBrowserEvent();if("mousewheel"==o.type){var s=1;(n.userAgent.IE||n.userAgent.WEBKIT&&(n.userAgent.WINDOWS||n.userAgent.isVersionOrHigher("532.0")))&&(s=40),i=n.events.MouseWheelHandler.smartScale_(-o.wheelDelta,s),n.isDef(o.wheelDeltaX)?(t=n.events.MouseWheelHandler.smartScale_(-o.wheelDeltaX,s),r=n.events.MouseWheelHandler.smartScale_(-o.wheelDeltaY,s)):r=i}else i=o.detail,i>100?i=3:i<-100&&(i=-3),n.isDef(o.axis)&&o.axis===o.HORIZONTAL_AXIS?t=i:r=i;n.isNumber(this.maxDeltaX_)&&(t=n.math.clamp(t,-this.maxDeltaX_,this.maxDeltaX_)),n.isNumber(this.maxDeltaY_)&&(r=n.math.clamp(r,-this.maxDeltaY_,this.maxDeltaY_)),this.isRtl_&&(t=-t);var a=new n.events.MouseWheelEvent(i,o,t,r);this.dispatchEvent(a)},n.events.MouseWheelHandler.smartScale_=function(e,t){return n.userAgent.WEBKIT&&(n.userAgent.MAC||n.userAgent.LINUX)&&e%t!=0?e:e/t},n.events.MouseWheelHandler.prototype.disposeInternal=function(){n.events.MouseWheelHandler.superClass_.disposeInternal.call(this),n.events.unlistenByKey(this.listenKey_),this.listenKey_=null},n.events.MouseWheelEvent=function(e,t,r,i){n.events.BrowserEvent.call(this,t),this.type=n.events.MouseWheelHandler.EventType.MOUSEWHEEL,this.detail=e,this.deltaX=r,this.deltaY=i},n.inherits(n.events.MouseWheelEvent,n.events.BrowserEvent),n.provide("goog.Timer"),n.require("goog.events.EventTarget"),n.Timer=function(e,t){n.events.EventTarget.call(this),this.interval_=e||1,this.timerObject_=t||n.Timer.defaultTimerObject,this.boundTick_=n.bind(this.tick_,this),this.last_=n.now()},n.inherits(n.Timer,n.events.EventTarget),n.Timer.MAX_TIMEOUT_=2147483647,n.Timer.prototype.enabled=!1,n.Timer.defaultTimerObject=n.global,n.Timer.intervalScale=.8,n.Timer.prototype.timer_=null,n.Timer.prototype.getInterval=function(){return this.interval_},n.Timer.prototype.setInterval=function(e){this.interval_=e,this.timer_&&this.enabled?(this.stop(),this.start()):this.timer_&&this.stop()},n.Timer.prototype.tick_=function(){if(this.enabled){var e=n.now()-this.last_;if(e>0&&e<this.interval_*n.Timer.intervalScale)return void(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_-e));this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null),this.dispatchTick(),this.enabled&&(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=n.now())}},n.Timer.prototype.dispatchTick=function(){this.dispatchEvent(n.Timer.TICK)},n.Timer.prototype.start=function(){this.enabled=!0,this.timer_||(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=n.now())},n.Timer.prototype.stop=function(){this.enabled=!1,this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null)},n.Timer.prototype.disposeInternal=function(){n.Timer.superClass_.disposeInternal.call(this),this.stop(),delete this.timerObject_},n.Timer.TICK="tick",n.Timer.callOnce=function(e,t,r){if(n.isFunction(e))r&&(e=n.bind(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=n.bind(e.handleEvent,e)}return t>n.Timer.MAX_TIMEOUT_?-1:n.Timer.defaultTimerObject.setTimeout(e,t||0)},n.Timer.clear=function(e){n.Timer.defaultTimerObject.clearTimeout(e)},n.provide("xrx.event.Type"),n.require("goog.events"),n.require("goog.events.EventType"),n.require("goog.events.MouseWheelHandler"),n.require("goog.userAgent"),xrx.event.Type=function(){},xrx.event.Type.CLICK=n.userAgent.MOBILE?n.events.EventType.TOUCHSTART:n.events.EventType.CLICK,xrx.event.Type.DBLCLICK=n.events.EventType.DBLCLICK,xrx.event.Type.DOWN=n.userAgent.MOBILE?n.events.EventType.TOUCHSTART:n.events.EventType.MOUSEDOWN,xrx.event.Type.IN=n.events.EventType.MOUSEOVER,xrx.event.Type.INPUT=function(){return n.userAgent.IE&&!n.userAgent.isVersionOrHigher(9)?n.events.EventType.PROPERTYCHANGE:n.userAgent.IE&&n.userAgent.isVersionOrHigher(9)&&!n.userAgent.isVersionOrHigher(10)?n.events.EventType.KEYUP:n.events.EventType.INPUT}(),xrx.event.Type.MOVE=n.userAgent.MOBILE?n.events.EventType.TOUCHMOVE:n.events.EventType.MOUSEMOVE,xrx.event.Type.OUT=n.events.EventType.MOUSEOUT,xrx.event.Type.UP=n.userAgent.MOBILE?n.events.EventType.TOUCHEND:n.events.EventType.MOUSEUP,xrx.event.Type.WHEEL=n.events.MouseWheelHandler.EventType.MOUSEWHEEL,n.provide("xrx.drawing.Cursor"),n.require("goog.Disposable"),xrx.drawing.Cursor=function(e){n.base(this),this.drawing_=e,this.point=null,this.pointTransformed_=null,this.shape_=null,this.shapes_=null,this.event_=null};n.inherits(xrx.drawing.Cursor,n.Disposable),xrx.drawing.Cursor.prototype.getPoint=function(){return null===this.point_&&this.calculatePoint_(),this.point_},xrx.drawing.Cursor.prototype.getPointTransformed=function(){return null===this.pointTransformed_&&this.calculatePointTransformed_(),this.pointTransformed_},xrx.drawing.Cursor.prototype.getShape=function(){return null===this.shape_&&this.calculateShape_(),this.shape_},xrx.drawing.Cursor.prototype.getShapes=function(){return null===this.shapes_&&this.calculateShapes_(),this.shapes_},xrx.drawing.Cursor.prototype.calculatePoint_=function(){this.point_=this.drawing_.getOffsetPoint(this.event_)},xrx.drawing.Cursor.prototype.calculatePointTransformed_=function(){null===this.point_&&this.calculatePoint_(),this.pointTransformed_=this.drawing_.getViewbox().getCTM().transformPoint(this.point_)},xrx.drawing.Cursor.prototype.calculateShape_=function(){null===this.pointTransformed_&&this.calculatePointTransformed_(),this.shape_=this.drawing_.getShapeSelected(this.pointTransformed_)},xrx.drawing.Cursor.prototype.calculateShapes_=function(){null===this.pointTransformed_&&this.calculatePointTransformed_(),this.shapes_=this.drawing_.getShapesSelected(this.pointTransformed_)},xrx.drawing.Cursor.prototype.init=function(e){this.point_=null,this.pointTransformed_=null,this.shape_=null,this.shapes_=null,this.event_=e},n.provide("xrx.event.Handler"),xrx.event.Handler={CLICK:"handleClick",DBLCLICK:"handleDblClick",DOWN:"handleDown",IN:"handleIn",INPUT:"handleInput",MOVE:"handleMove",OUT:"handleOut",UP:"handleUp",WHEEL:"handleWheel"},n.provide("xrx.geometry.Rect"),n.require("xrx.geometry"),n.require("xrx.geometry.Geometry"),n.require("goog.math.Box"),xrx.geometry.Rect=function(){n.base(this),this.x=0,this.y=0,this.width=0,this.height=0},n.inherits(xrx.geometry.Rect,xrx.geometry.Geometry),xrx.geometry.Rect.prototype.getBox=function(){return new n.math.Box(this.y,this.x+this.width,this.y+this.height,this.x)},xrx.geometry.Rect.prototype.containsPoint=function(e){return e[0]>=this.x&&e[1]>=this.y&&e[0]<=this.x+this.width&&e[1]<=this.y+this.height},xrx.geometry.Rect.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.shape.Image"),n.require("xrx.geometry.Rect"),n.require("xrx.shape.Geometry"),xrx.shape.Image=function(e){n.base(this,e,new xrx.geometry.Rect),this.engineElement_=this.drawing_.getEngine().createImage(),this.image_},n.inherits(xrx.shape.Image,xrx.shape.Geometry),xrx.shape.Image.prototype.getImage=function(){return this.image_},xrx.shape.Image.prototype.setImage=function(e){this.image_=e,this.geometry_.width=e.naturalWidth,this.geometry_.height=e.naturalHeight},xrx.shape.Image.prototype.getHeight=function(){return this.geometry_.height},xrx.shape.Image.prototype.getWidth=function(){return this.geometry_.width},xrx.shape.Image.prototype.draw=function(){this.startDrawing_(),this.image_&&this.engineElement_.draw(this.image_),this.finishDrawing_()},xrx.shape.Image.prototype.disposeInternal=function(){this.image_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.Modifiable"),n.require("xrx.shape.Style"),xrx.shape.Modifiable=function(e){n.base(this),this.shape_=e,this.dragger_=[],this.store_=new xrx.shape.Style,this.store_.setStyle(this.shape_),this.setStyle(this.shape_)},n.inherits(xrx.shape.Modifiable,xrx.shape.Style),xrx.shape.Modifiable.prototype.selectOn=function(){this.store_.setStyle(this.shape_),this.shape_.setStyle(this)},xrx.shape.Modifiable.prototype.selectOff=function(){this.shape_.setStyle(this.store_)},xrx.shape.Modifiable.prototype.setCoords=n.abstractMethod,xrx.shape.Modifiable.prototype.setCoordAt=n.abstractMethod,xrx.shape.Modifiable.prototype.move=n.abstractMethod,xrx.shape.Modifiable.prototype.getShape=function(){return this.shape_},xrx.shape.Modifiable.prototype.getDragger=function(){return this.dragger_},xrx.shape.Modifiable.prototype.setDragger=function(e){this.dragger_=e},xrx.shape.Modifiable.prototype.disposeInternal=function(){var e;for(this.shape_.dispose(),this.shape_=null;e=this.dragger_.pop();)e.dispose(),e=null;this.dragger_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.Hoverable"),n.require("xrx.shape.Style"),xrx.shape.Hoverable=function(e){n.base(this),this.shape_=e,this.store_=new xrx.shape.Style},n.inherits(xrx.shape.Hoverable,xrx.shape.Style),xrx.shape.Hoverable.prototype.hoverOn=function(){this.store_.setStyle(this.shape_),this.shape_.setStyle(this)},xrx.shape.Hoverable.prototype.hoverOff=function(){this.shape_.setStyle(this.store_)},xrx.shape.Hoverable.prototype.disposeInternal=function(){this.shape_.dispose(),this.shape_=null,this.store_.dispose(),this.store_=null,n.base(this,"disposeInternal")},n.provide("xrx.geometry.Ellipse"),n.require("xrx.geometry"),n.require("xrx.geometry.Geometry"),xrx.geometry.Ellipse=function(){n.base(this),this.cx=0,this.cy=0,this.rx=0,this.ry=0},n.inherits(xrx.geometry.Ellipse,xrx.geometry.Geometry),xrx.geometry.Ellipse.prototype.containsPoint=function(e){return(e[0]-this.cx)*(e[0]-this.cx)/(this.rx*this.rx)+(e[1]-this.cy)*(e[1]-this.cy)/(this.ry*this.ry)<=1},xrx.geometry.Ellipse.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.shape.Creatable"),xrx.shape.Creatable=function(e,t){this.target_=e,this.preview_=t},xrx.shape.Creatable.prototype.getTarget=function(){return this.target_},xrx.shape.Creatable.prototype.getPreview=function(){return this.preview_},xrx.shape.Creatable.prototype.setStyle=function(e){this.preview_.setStyle(e)},xrx.shape.Creatable.prototype.setFillColor=function(e){this.preview_.setFillColor(e)},xrx.shape.Creatable.prototype.setFillOpacity=function(e){this.preview_.setFillOpacity(e)},xrx.shape.Creatable.prototype.setStrokeColor=function(e){this.preview_.setStrokeColor(e)},xrx.shape.Creatable.prototype.setStrokeWidth=function(e){this.preview_.setStrokeWidth(e)},n.provide("xrx.shape.Selectable"),n.require("xrx.shape.Style"),xrx.shape.Selectable=function(e){n.base(this),this.shape_=e,this.store_=new xrx.shape.Style},n.inherits(xrx.shape.Selectable,xrx.shape.Style),xrx.shape.Selectable.prototype.selectOn=function(){this.store_.setStyle(this.shape_),this.shape_.setStyle(this)},xrx.shape.Selectable.prototype.selectOff=function(){this.shape_.setStyle(this.store_)},xrx.shape.Selectable.prototype.disposeInternal=function(){this.shape_.dispose(),this.shape_=null,this.store_.dispose(),this.store_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.Ellipse"),n.provide("xrx.shape.EllipseCreatable"),n.provide("xrx.shape.EllipseHoverable"),n.provide("xrx.shape.EllipseModifiable"),n.provide("xrx.shape.EllipseSelectable"),n.require("xrx.geometry.Ellipse"),n.require("xrx.shape.Creatable"),n.require("xrx.shape.Geometry"),n.require("xrx.shape.Hoverable"),n.require("xrx.shape.Modifiable"),n.require("xrx.shape.Selectable"),xrx.shape.Ellipse=function(e){n.base(this,e,new xrx.geometry.Ellipse),this.engineElement_=this.drawing_.getEngine().createEllipse()},n.inherits(xrx.shape.Ellipse,xrx.shape.Geometry),xrx.shape.Ellipse.prototype.getCenter=function(){return[this.geometry_.cx,this.geometry_.cy]},xrx.shape.Ellipse.prototype.setCenter=function(e,t){this.geometry_.cx=e,this.geometry_.cy=t},xrx.shape.Ellipse.prototype.getRadiusX=function(){return this.geometry_.rx},xrx.shape.Ellipse.prototype.setRadiusX=function(e){this.geometry_.rx=e},xrx.shape.Ellipse.prototype.getRadiusY=function(){return this.geometry_.ry},xrx.shape.Ellipse.prototype.setRadiusY=function(e){this.geometry_.ry=e},xrx.shape.Ellipse.prototype.getCoords=function(){return[this.getCenter()]},xrx.shape.Ellipse.prototype.setCoords=function(e){this.setCenter(e[0][0],e[0][1])},xrx.shape.Ellipse.prototype.draw=function(){this.startDrawing_();var e=this.getCenter();this.engineElement_.draw(e[0],e[1],this.getRadiusX(),this.getRadiusY(),this.getRenderingFillColor(),this.getRenderingFillOpacity(),this.getRenderingStrokeColor(),this.getRenderingStrokeWidth()),this.finishDrawing_()},xrx.shape.Ellipse.prototype.getHoverable=function(){return this.hoverable_||(this.hoverable_=new xrx.shape.EllipseHoverable(this)),this.hoverable_},xrx.shape.Ellipse.prototype.getSelectable=function(){return this.selectable_||(this.selectable_=new xrx.shape.EllipseSelectable(this)),this.selectable_},xrx.shape.Ellipse.prototype.getModifiable=function(){return this.modifiable_||(this.modifiable_=new xrx.shape.EllipseModifiable(this)),this.modifiable_},xrx.shape.Ellipse.prototype.getCreatable=function(){return this.creatable_||(this.creatable_=new xrx.shape.EllipseCreatable(this)),this.creatable_},xrx.shape.Ellipse.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.EllipseHoverable=function(e){n.base(this,e)},n.inherits(xrx.shape.EllipseHoverable,xrx.shape.Hoverable),xrx.shape.EllipseHoverable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.EllipseSelectable=function(e){n.base(this,e)},n.inherits(xrx.shape.EllipseSelectable,xrx.shape.Selectable),xrx.shape.EllipseSelectable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.EllipseModifiable=function(e){n.base(this,e),this.init_()},n.inherits(xrx.shape.EllipseModifiable,xrx.shape.Modifiable),xrx.shape.EllipseModifiable.prototype.setCoords=function(e){this.shape_.setCoords(e),this.dragger_[0].setCoordX(e[0][0]+this.shape_.getRadiusX()),this.dragger_[0].setCoordY(e[0][1]),this.dragger_[1].setCoordX(e[0][0]),this.dragger_[1].setCoordY(e[0][1]+this.shape_.getRadiusY())},xrx.shape.EllipseModifiable.prototype.setCoordAt=function(e,t){0===e?(this.dragger_[0].setCoordX(t[0]),this.shape_.setRadiusX(Math.abs(t[0]-this.shape_.getCenter()[0]))):(this.dragger_[1].setCoordY(t[1]),this.shape_.setRadiusY(Math.abs(t[1]-this.shape_.getCenter()[1])))},xrx.shape.EllipseModifiable.prototype.move=function(e,t){var r=this.shape_.getCoordsCopy();r[0][0]+=e,r[0][1]+=t,this.setCoords(r)},xrx.shape.EllipseModifiable.prototype.init_=function(){var e=this.shape_.getCenter(),t=this.shape_.getRadiusX(),r=this.shape_.getRadiusY(),n=new xrx.shape.Dragger(this,0);n.setCoords([[e[0]+t,e[1]]]);var i=new xrx.shape.Dragger(this,1);i.setCoords([[e[0],e[1]+r]]),this.setDragger([n,i])},xrx.shape.EllipseModifiable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.EllipseCreatable=function(e){n.base(this,e,new xrx.shape.Ellipse(e.getDrawing())),this.point_=new Array(2)},n.inherits(xrx.shape.EllipseCreatable,xrx.shape.Creatable),xrx.shape.EllipseCreatable.prototype.getCoords=function(){return this.helper_.getCoords()},xrx.shape.EllipseCreatable.prototype.handleDown=function(e,t){var r=t.getPointTransformed();this.point_[0]=r[0],this.point_[1]=r[1],this.preview_.setCenter(r[0],r[1]),this.preview_.setRadiusX(0),this.preview_.setRadiusY(0),this.target_.getDrawing().handleShapeCreate([this.preview_])},xrx.shape.EllipseCreatable.prototype.handleMove=function(e,t){var r=t.getPointTransformed(),n=r[0]-this.point_[0],i=r[1]-this.point_[1];this.preview_.setCenter(r[0]-n/2,r[1]-i/2),this.preview_.setRadiusX(Math.abs(n/2)),this.preview_.setRadiusY(Math.abs(i/2))},xrx.shape.EllipseCreatable.prototype.handleUp=function(e,t){var r=new xrx.shape.Ellipse(this.target_.getDrawing()),n=this.preview_.getCenter();r.setStyle(this.target_),r.setCenter(n[0],n[1]),r.setRadiusX(this.preview_.getRadiusX()),r.setRadiusY(this.preview_.getRadiusY()),this.target_.getDrawing().handleShapeCreated(r)},xrx.shape.EllipseCreatable.prototype.disposeInternal=function(){this.point_=null,n.base(this,"disposeInternal")},n.provide("xrx.geometry.Line"),n.require("xrx.geometry"),n.require("xrx.geometry.Geometry"),xrx.geometry.Line=function(){n.base(this),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.arr_=[[this.x1,this.y1],[this.x2,this.y2]]},n.inherits(xrx.geometry.Line,xrx.geometry.Geometry),xrx.geometry.Line.containsPoint=function(e,t){var r,n,i,o,s=e[0][0],a=e[0][1],l=e[1][0],h=e[1][1];if(s<l?(r=s,n=l):(r=l,n=s),a<h?(i=a,o=h):(i=h,o=a),t[0]<r-7||t[0]>n+7||t[1]<i-7||t[1]>o+7)return!1;if(Math.abs(s-l)<7)return Math.abs(t[0]-s)<7;if(Math.abs(a-h)<7)return Math.abs(t[1]-a)<7;var p=(h-a)/(l-s),g=a-p*s;return Math.abs(t[1]-(p*t[0]+g))<7},xrx.geometry.Line.prototype.containsPoint=function(e){return this.arr_[0][0]=this.x1,this.arr_[0][1]=this.y1,this.arr_[1][0]=this.x2,this.arr_[1][1]=this.y2,xrx.geometry.Line.containsPoint(this.arr_,e)},xrx.geometry.Line.prototype.disposeInternal=function(){this.arr_=null,n.base(this,"disposeInternal")},n.provide("xrx.geometry.Polyline"),n.require("xrx.geometry"),n.require("xrx.geometry.Geometry"),n.require("xrx.geometry.Line"),xrx.geometry.Polyline=function(e){if(n.base(this),this.coords=void 0===e?[]:new Array(e),void 0!==e)for(var t=0;t<e;t++)this.coords[t]=new Array(2)},n.inherits(xrx.geometry.Polyline,xrx.geometry.Geometry),xrx.geometry.Polyline.prototype.containsPoint=function(e){for(var t=!1,r=0,n=this.coords.length-1;r<n&&!0!==(t=xrx.geometry.Line.containsPoint([this.coords[r],this.coords[r+1]],e));r++);return t},xrx.geometry.Polyline.prototype.disposeInternal=function(){this.coords=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.PathLike"),xrx.shape.PathLike=function(e,t){n.base(this,e,t)},n.inherits(xrx.shape.PathLike,xrx.shape.Geometry),xrx.shape.PathLike.prototype.setCoords=function(e){this.geometry_.coords=e},xrx.shape.PathLike.prototype.getCoords=function(e){return this.geometry_.coords},xrx.shape.PathLike.prototype.setCoordAt=function(e,t){this.geometry_.coords[e][0]=t[0],this.geometry_.coords[e][1]=t[1]},xrx.shape.PathLike.prototype.setCoordXAt=function(e,t){this.geometry_.coords[e][0]=t},xrx.shape.PathLike.prototype.setCoordYAt=function(e,t){this.geometry_.coords[e][1]=t},xrx.shape.PathLike.prototype.setLastCoord=function(e){var t=this.geometry_.coords.length-1;this.geometry_.coords[t][0]=e[0],this.geometry_.coords[t][1]=e[1]},xrx.shape.PathLike.prototype.appendCoord=function(e){this.geometry_.coords.push(e)},xrx.shape.PathLike.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.shape.Polyline"),n.provide("xrx.shape.PolylineCreatable"),n.provide("xrx.shape.PolylineHoverable"),n.provide("xrx.shape.PolylineModifiable"),n.provide("xrx.shape.PolylineSelectable"),n.require("goog.array"),n.require("xrx.geometry.Polyline"),n.require("xrx.shape.PathLike"),n.require("xrx.shape.Hoverable"),n.require("xrx.shape.Modifiable"),n.require("xrx.shape.PathLike"),n.require("xrx.shape.Selectable"),xrx.shape.Polyline=function(e){n.base(this,e,new xrx.geometry.Polyline),this.engineElement_=this.drawing_.getEngine().createPolyline()},n.inherits(xrx.shape.Polyline,xrx.shape.PathLike),xrx.shape.Polyline.prototype.draw=function(){this.startDrawing_(),this.engineElement_.draw(this.getCoords(),this.getRenderingFillColor(),0,this.getRenderingStrokeColor(),this.getRenderingStrokeWidth()),this.finishDrawing_()},xrx.shape.Polyline.prototype.getHoverable=function(){return this.hoverable_||(this.hoverable_=new xrx.shape.PolylineHoverable(this)),this.hoverable_},xrx.shape.Polyline.prototype.getSelectable=function(){return this.selectable_||(this.selectable_=new xrx.shape.PolylineSelectable(this)),this.selectable_},xrx.shape.Polyline.prototype.getModifiable=function(e){return this.modifiable_||(this.modifiable_=new xrx.shape.PolylineModifiable(this)),this.modifiable_},xrx.shape.Polyline.prototype.getCreatable=function(){return this.creatable_||(this.creatable_=new xrx.shape.PolylineCreatable(this)),this.creatable_},xrx.shape.Polyline.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.PolylineHoverable=function(e){n.base(this,e)},n.inherits(xrx.shape.PolylineHoverable,xrx.shape.Hoverable),xrx.shape.PolylineHoverable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.PolylineSelectable=function(e){n.base(this,e)},n.inherits(xrx.shape.PolylineSelectable,xrx.shape.Selectable),xrx.shape.PolylineSelectable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.PolylineModifiable=function(e,t){n.base(this,e,t),this.init_()},n.inherits(xrx.shape.PolylineModifiable,xrx.shape.Modifiable),xrx.shape.PolylineModifiable.prototype.setCoords=function(e,t){for(var r=0,n=this.dragger_.length;r<n;r++)r!==t&&(this.dragger_[r].setCoordX(e[r][0]),this.dragger_[r].setCoordY(e[r][1]));this.shape_.setCoords(e)},xrx.shape.PolylineModifiable.prototype.setCoordAt=function(e,t){this.dragger_[e].setCoordX(t[0]),this.dragger_[e].setCoordY(t[1]),this.shape_.setCoordXAt(e,t[0]),this.shape_.setCoordYAt(e,t[1])},xrx.shape.PolylineModifiable.prototype.init_=function(){for(var e,t=this.shape_.getCoords(),r=[],n=0,i=t.length;n<i;n++)e=new xrx.shape.Dragger(this,n),e.setCoords([t[n]]),r.push(e);this.setDragger(r)},xrx.shape.PolylineModifiable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.PolylineModifiable.prototype.move=function(e,t){for(var r=this.shape_.getCoordsCopy(),n=0,i=r.length;n<i;n++)r[n][0]+=e,r[n][1]+=t;this.setCoords(r)},xrx.shape.PolylineCreatable=function(e){n.base(this,e,new xrx.shape.Polyline(e.getDrawing())),this.close_,this.count_=0},n.inherits(xrx.shape.PolylineCreatable,xrx.shape.Creatable),xrx.shape.PolylineCreatable.prototype.getCoords=function(){return this.preview_.getCoords()},xrx.shape.PolylineCreatable.prototype.handleDown=function(e,t){var r=t.getShape(),i=t.getPointTransformed();0===this.count_?(this.preview_.setCoords([i,n.array.clone(i)]),this.count_+=1,this.target_.getDrawing().handleShapeCreate([this.preview_])):this.close_&&r===this.close_&&1===this.count_||this.preview_.setLastCoord(i)},xrx.shape.PolylineCreatable.prototype.handleMove=function(e,t){var r=t.getShape(),n=t.getPointTransformed();0!==this.count_&&(this.preview_.setLastCoord(n),this.close_&&r===this.close_?(this.close_.setStrokeColor("red"),this.close_.setStrokeWidth(3)):this.close_&&(this.close_.setStrokeColor("black"),this.close_.setStrokeWidth(1)))},xrx.shape.PolylineCreatable.prototype.handleUp=function(e,t){var r=t.getShape(),n=t.getPointTransformed();if(this.close_&&r===this.close_){var i=new xrx.shape.Polyline(this.target_.getDrawing());i.setStyle(this.target_),i.setCoords(this.preview_.getCoordsCopy().splice(0,this.count_)),this.target_.getDrawing().handleShapeCreated(i),this.close_=null,this.count_=0}else this.preview_.appendCoord(n),1===this.count_&&(this.close_=new xrx.shape.Dragger(this.target_.getModifiable(),0),this.target_.getDrawing().handleShapeCreate([this.close_])),this.close_.setCoords([n]),this.count_+=1},xrx.shape.PolylineCreatable.prototype.disposeInternal=function(){this.close_.dispose(),this.close_=null,n.base(this,"disposeInternal")},n.provide("xrx.geometry.Path"),n.require("xrx.geometry"),n.require("xrx.geometry.Geometry"),xrx.geometry.Path=function(e){if(n.base(this),this.coords=void 0===e?[]:new Array(e),void 0!==e)for(var t=0;t<e;t++)this.coords[t]=new Array(2)},n.inherits(xrx.geometry.Path,xrx.geometry.Geometry),xrx.geometry.Path.prototype.containsPoint=function(e){for(var t,r,n=e[0],i=e[1],o=this.coords,s=!1,a=0,l=o.length-1;a<o.length;l=a++)t=o[a][0],yi=o[a][1],r=o[l][0],yj=o[l][1],yi>i!=yj>i&&n<(r-t)*(i-yi)/(yj-yi)+t&&(s=!s);return s},xrx.geometry.Path.prototype.disposeInternal=function(){this.coords=null,n.base(this,"disposeInternal")},n.provide("xrx.geometry.Circle"),n.require("xrx.geometry"),n.require("xrx.geometry.Geometry"),xrx.geometry.Circle=function(){n.base(this),this.cx=0,this.cy=0,this.r=0};n.inherits(xrx.geometry.Circle,xrx.geometry.Geometry),xrx.geometry.Circle.prototype.containsPoint=function(e){return(this.cx-e[0])*(this.cx-e[0])+(this.cy-e[1])*(this.cy-e[1])<=this.r*this.r},xrx.geometry.Circle.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.shape.Circle"),n.provide("xrx.shape.CircleCreatable"),n.provide("xrx.shape.CircleHoverable"),n.provide("xrx.shape.CircleModifiable"),n.provide("xrx.shape.CircleSelectable"),n.require("xrx.geometry.Circle"),n.require("xrx.shape.Creatable"),n.require("xrx.shape.Geometry"),n.require("xrx.shape.Hoverable"),n.require("xrx.shape.Modifiable"),n.require("xrx.shape.Selectable"),xrx.shape.Circle=function(e){n.base(this,e,new xrx.geometry.Circle),this.engineElement_=this.drawing_.getEngine().createCircle()},n.inherits(xrx.shape.Circle,xrx.shape.Geometry),xrx.shape.Circle.prototype.getCenter=function(){return[this.geometry_.cx,this.geometry_.cy]},xrx.shape.Circle.prototype.setCenter=function(e,t){this.geometry_.cx=e,this.geometry_.cy=t},xrx.shape.Circle.prototype.getRadius=function(){return this.geometry_.r},xrx.shape.Circle.prototype.setRadius=function(e){this.geometry_.r=e},xrx.shape.Circle.prototype.getCoords=function(){return[this.getCenter()]},xrx.shape.Circle.prototype.setCoords=function(e){this.setCenter(e[0][0],e[0][1])},xrx.shape.Circle.prototype.setCoordX=function(e){this.geometry_.cx=e},xrx.shape.Circle.prototype.setCoordY=function(e){this.geometry_.cy=e},xrx.shape.Circle.prototype.draw=function(){this.startDrawing_();var e=this.getCenter();this.engineElement_.draw(e[0],e[1],this.getRadius(),this.getRenderingFillColor(),this.getRenderingFillOpacity(),this.getRenderingStrokeColor(),this.getRenderingStrokeWidth()),this.finishDrawing_()},xrx.shape.Circle.prototype.getHoverable=function(){return this.hoverable_||(this.hoverable_=new xrx.shape.CircleHoverable(this)),this.hoverable_},xrx.shape.Circle.prototype.getSelectable=function(){return this.selectable_||(this.selectable_=new xrx.shape.CircleSelectable(this)),this.selectable_},xrx.shape.Circle.prototype.getModifiable=function(){return this.modifiable_||(this.modifiable_=new xrx.shape.CircleModifiable(this)),this.modifiable_},xrx.shape.Circle.prototype.getCreatable=function(){return this.creatable_||(this.creatable_=new xrx.shape.CircleCreatable(this)),this.creatable_},xrx.shape.Circle.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.CircleHoverable=function(e){n.base(this,e)},n.inherits(xrx.shape.CircleHoverable,xrx.shape.Hoverable),xrx.shape.CircleHoverable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.CircleSelectable=function(e){n.base(this,e)},n.inherits(xrx.shape.CircleSelectable,xrx.shape.Selectable),xrx.shape.CircleSelectable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.CircleModifiable=function(e){n.base(this,e),this.init_()},n.inherits(xrx.shape.CircleModifiable,xrx.shape.Modifiable),xrx.shape.CircleModifiable.prototype.setCoords=function(e){this.shape_.setCoords(e),this.dragger_[0].setCoordX(e[0][0]+this.shape_.getRadius()),this.dragger_[0].setCoordY(e[0][1])},xrx.shape.CircleModifiable.prototype.setCoordAt=function(e,t){this.shape_.setRadius(Math.abs(t[0]-this.shape_.getCenter()[0])),this.dragger_[0].setCoordX(t[0])},xrx.shape.CircleModifiable.prototype.move=function(e,t){var r=this.shape_.getCoordsCopy();r[0][0]+=e,r[0][1]+=t,this.setCoords(r)},xrx.shape.CircleModifiable.prototype.init_=function(){var e=this.shape_.getCenter(),t=this.shape_.getRadius(),r=new xrx.shape.Dragger(this,0);r.setCoords([[e[0]+t,e[1]]]),this.setDragger([r])},xrx.shape.CircleModifiable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.CircleCreatable=function(e){n.base(this,e,new xrx.shape.Circle(e.getDrawing())),this.point_=new Array(2)},n.inherits(xrx.shape.CircleCreatable,xrx.shape.Creatable),xrx.shape.CircleCreatable.prototype.getCoords=function(){return this.preview_.getCoords()},xrx.shape.CircleCreatable.prototype.handleDown=function(e,t){var r=t.getPointTransformed();this.point_[0]=r[0],this.point_[1]=r[1],this.preview_.setCenter(r[0],r[1]),this.preview_.setRadius(0),this.target_.getDrawing().handleShapeCreate([this.preview_])},xrx.shape.CircleCreatable.prototype.handleMove=function(e,t){var r=t.getPointTransformed(),n=r[0]-this.point_[0],i=r[1]-this.point_[1];this.preview_.setCenter(r[0]-n/2,r[1]-i/2),this.preview_.setRadius(Math.sqrt(n*n+i*i)/2)},xrx.shape.CircleCreatable.prototype.handleUp=function(e,t){var r=(t.getPointTransformed(),new xrx.shape.Circle(this.target_.getDrawing())),n=this.preview_.getCenter();r.setStyle(this.target_),r.setCenter(n[0],n[1]),r.setRadius(this.preview_.getRadius()),this.target_.getDrawing().handleShapeCreated(r)},xrx.shape.CircleCreatable.prototype.disposeInternal=function(){this.point_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.Dragger"),n.require("xrx.shape.Circle"),xrx.shape.Dragger=function(e,t){var r=e.getShape().getDrawing();n.base(this,r,r.getEngine().createCircle(r.getCanvas().getEngineElement())),this.modifiable_=e,this.pos_=t,this.init_()},n.inherits(xrx.shape.Dragger,xrx.shape.Circle),xrx.shape.Dragger.prototype.setCoord=function(e){this.modifiable_.setCoordAt(this.pos_,e)},xrx.shape.Dragger.prototype.getPosition=function(){return this.pos_},xrx.shape.Dragger.prototype.getRadius=function(){return this.geometry_.r/this.zoomFactor_},xrx.shape.Dragger.prototype.init_=function(e,t){this.setRadius(3),this.setStrokeColor("black"),this.setStrokeWidth(1),this.setFillColor("white"),this.setFillOpacity(1)},xrx.shape.Dragger.prototype.disposeInternal=function(){n.dispose(this.modifiable_),this.modifiable_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.Polygon"),n.provide("xrx.shape.PolygonCreatable"),n.provide("xrx.shape.PolygonHoverable"),n.provide("xrx.shape.PolygonModifiable"),n.provide("xrx.shape.PolygonSelectable"),n.require("goog.array"),n.require("xrx.geometry.Path"),n.require("xrx.shape.Creatable"),n.require("xrx.shape.Dragger"),n.require("xrx.shape.Hoverable"),n.require("xrx.shape.Modifiable"),n.require("xrx.shape.PathLike"),n.require("xrx.shape.Polyline"),n.require("xrx.shape.Selectable"),xrx.shape.Polygon=function(e){n.base(this,e,new xrx.geometry.Path),this.engineElement_=this.drawing_.getEngine().createPolygon()},n.inherits(xrx.shape.Polygon,xrx.shape.PathLike),xrx.shape.Polygon.prototype.draw=function(){this.startDrawing_(),this.engineElement_.draw(this.getCoords(),this.getRenderingFillColor(),this.getRenderingFillOpacity(),this.getRenderingStrokeColor(),this.getRenderingStrokeWidth()),this.finishDrawing_()},xrx.shape.Polygon.prototype.getHoverable=function(){return this.hoverable_||(this.hoverable_=new xrx.shape.PolygonHoverable(this)),this.hoverable_},xrx.shape.Polygon.prototype.getSelectable=function(){return this.selectable_||(this.selectable_=new xrx.shape.PolygonSelectable(this)),this.selectable_},xrx.shape.Polygon.prototype.getModifiable=function(e){return this.modifiable_||(this.modifiable_=new xrx.shape.PolygonModifiable(this)),this.modifiable_},xrx.shape.Polygon.prototype.getCreatable=function(){return this.creatable_||(this.creatable_=new xrx.shape.PolygonCreatable(this)),this.creatable_},xrx.shape.Polygon.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.PolygonHoverable=function(e){n.base(this,e)},n.inherits(xrx.shape.PolygonHoverable,xrx.shape.Hoverable),xrx.shape.PolygonHoverable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.PolygonSelectable=function(e){n.base(this,e)},n.inherits(xrx.shape.PolygonSelectable,xrx.shape.Selectable),xrx.shape.PolygonSelectable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.PolygonModifiable=function(e,t){n.base(this,e,t),this.init_()},n.inherits(xrx.shape.PolygonModifiable,xrx.shape.Modifiable),xrx.shape.PolygonModifiable.prototype.setCoords=function(e,t){for(var r=0,n=this.dragger_.length;r<n;r++)r!==t&&(this.dragger_[r].setCoordX(e[r][0]),this.dragger_[r].setCoordY(e[r][1]));this.shape_.setCoords(e)},xrx.shape.PolygonModifiable.prototype.setCoordAt=function(e,t){this.dragger_[e].setCoordX(t[0]),this.dragger_[e].setCoordY(t[1]),this.shape_.setCoordXAt(e,t[0]),this.shape_.setCoordYAt(e,t[1])},xrx.shape.PolygonModifiable.prototype.move=function(e,t){for(var r=this.shape_.getCoordsCopy(),n=0,i=r.length;n<i;n++)r[n][0]+=e,r[n][1]+=t;this.setCoords(r)},xrx.shape.PolygonModifiable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.PolygonModifiable.prototype.init_=function(){for(var e,t=this.shape_.getCoords(),r=[],n=0,i=t.length;n<i;n++)e=new xrx.shape.Dragger(this,n),e.setCoords([t[n]]),r.push(e);this.setDragger(r)},xrx.shape.PolygonCreatable=function(e){n.base(this,e,new xrx.shape.Polyline(e.getDrawing())),this.close_,this.count_=0},n.inherits(xrx.shape.PolygonCreatable,xrx.shape.Creatable),xrx.shape.PolygonCreatable.prototype.getCoords=function(){return this.preview_.getCoords()},xrx.shape.PolygonCreatable.prototype.handleDown=function(e,t){var r=t.getShape(),i=t.getPointTransformed();0===this.count_?(this.preview_.setCoords([i,n.array.clone(i)]),this.close_=new xrx.shape.Dragger(this.target_.getModifiable(),0),this.close_.setCoords([i]),this.count_+=1,this.target_.getDrawing().handleShapeCreate([this.preview_,this.close_])):this.close_&&r===this.close_&&1===this.count_||this.preview_.setLastCoord(i)},xrx.shape.PolygonCreatable.prototype.handleMove=function(e,t){var r=t.getShape(),n=t.getPointTransformed();0!==this.count_&&(this.preview_.setLastCoord(n),r===this.close_?(this.close_.setStrokeColor("red"),this.close_.setStrokeWidth(3)):(this.close_.setStrokeColor("black"),this.close_.setStrokeWidth(1)))},xrx.shape.PolygonCreatable.prototype.handleUp=function(e,t){var r=t.getShape(),n=t.getPointTransformed();if(this.close_&&r===this.close_){var i=new xrx.shape.Polygon(this.target_.getDrawing());i.setStyle(this.target_),i.setCoords(this.preview_.getCoordsCopy().splice(0,this.count_)),this.target_.getDrawing().handleShapeCreated(i),this.close_=null,this.count_=0}else this.preview_.setLastCoord(n),this.preview_.appendCoord(n),this.count_+=1},xrx.shape.PolygonCreatable.prototype.disposeInternal=function(){this.close_.dispose(),this.close_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.Line"),n.provide("xrx.shape.LineCreatable"),n.provide("xrx.shape.LineHoverable"),n.provide("xrx.shape.LineModifiable"),n.provide("xrx.shape.LineSelectable"),n.require("xrx.geometry.Line"),n.require("xrx.shape.Creatable"),n.require("xrx.shape.Geometry"),n.require("xrx.shape.Hoverable"),n.require("xrx.shape.Modifiable"),n.require("xrx.shape.Selectable"),xrx.shape.Line=function(e){n.base(this,e,new xrx.geometry.Line),this.engineElement_=this.drawing_.getEngine().createLine()},n.inherits(xrx.shape.Line,xrx.shape.Geometry),xrx.shape.Line.prototype.getX1=function(){return this.geometry_.x1},xrx.shape.Line.prototype.setX1=function(e){this.geometry_.x1=e},xrx.shape.Line.prototype.getY1=function(){return this.geometry_.y1},xrx.shape.Line.prototype.setY1=function(e){this.geometry_.y1=e},xrx.shape.Line.prototype.getX2=function(){return this.geometry_.x2},xrx.shape.Line.prototype.setX2=function(e){this.geometry_.x2=e},xrx.shape.Line.prototype.getY2=function(){return this.geometry_.y2},xrx.shape.Line.prototype.setY2=function(e){this.geometry_.y2=e},xrx.shape.Line.prototype.getCoords=function(){return[[this.geometry_.x1,this.geometry_.y1],[this.geometry_.x2,this.geometry_.y2]]},xrx.shape.Line.prototype.setCoords=function(e){this.geometry_.x1=e[0][0],this.geometry_.y1=e[0][1],this.geometry_.x2=e[1][0],this.geometry_.y2=e[1][1]},xrx.shape.Line.prototype.draw=function(){this.startDrawing_(),this.engineElement_.draw(this.geometry_.x1,this.geometry_.y1,this.geometry_.x2,this.geometry_.y2,this.getRenderingStrokeColor(),this.getRenderingStrokeWidth()),this.finishDrawing_()},xrx.shape.Line.prototype.getHoverable=function(){return this.hoverable_||(this.hoverable_=new xrx.shape.LineHoverable(this)),this.hoverable_},xrx.shape.Line.prototype.getSelectable=function(){return this.selectable_||(this.selectable_=new xrx.shape.LineSelectable(this)),this.selectable_},xrx.shape.Line.prototype.getModifiable=function(e){return this.modifiable_||(this.modifiable_=new xrx.shape.LineModifiable(this)),this.modifiable_},xrx.shape.Line.prototype.getCreatable=function(){return this.creatable_||(this.creatable_=new xrx.shape.LineCreatable(this)),this.creatable_},xrx.shape.Line.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.LineHoverable=function(e){n.base(this,e)},n.inherits(xrx.shape.LineHoverable,xrx.shape.Hoverable),xrx.shape.LineHoverable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.LineSelectable=function(e){n.base(this,e)},n.inherits(xrx.shape.LineSelectable,xrx.shape.Selectable),xrx.shape.LineSelectable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.LineModifiable=function(e,t){n.base(this,e,t),this.init_()},n.inherits(xrx.shape.LineModifiable,xrx.shape.Modifiable),xrx.shape.LineModifiable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.LineModifiable.prototype.setCoords=function(e){this.shape_.setCoords(e),this.dragger_[0].setCoordX(e[0][0]),this.dragger_[0].setCoordY(e[0][1]),this.dragger_[1].setCoordX(e[1][0]),this.dragger_[1].setCoordY(e[1][1])},xrx.shape.LineModifiable.prototype.setCoordAt=function(e,t){0===e?(this.dragger_[0].setCoordX(t[0]),this.dragger_[0].setCoordY(t[1]),this.shape_.setX1(t[0]),this.shape_.setY1(t[1])):(this.dragger_[1].setCoordX(t[0]),this.dragger_[1].setCoordY(t[1]),this.shape_.setX2(t[0]),this.shape_.setY2(t[1]))},xrx.shape.LineModifiable.prototype.move=function(e,t){var r=this.shape_.getCoordsCopy();r[0][0]+=e,r[0][1]+=t,r[1][0]+=e,r[1][1]+=t,this.setCoords(r)},xrx.shape.LineModifiable.prototype.init_=function(){var e=new xrx.shape.Dragger(this,0);e.setCoords([[this.shape_.getX1(),this.shape_.getY1()]]);var t=new xrx.shape.Dragger(this,1);t.setCoords([[this.shape_.getX2(),this.shape_.getY2()]]),this.setDragger([e,t])},xrx.shape.LineModifiable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.LineCreatable=function(e){n.base(this,e,new xrx.shape.Line(e.getDrawing()))},n.inherits(xrx.shape.LineCreatable,xrx.shape.Creatable),xrx.shape.LineCreatable.prototype.getCoords=function(){return this.helper_.getCoords()},xrx.shape.LineCreatable.prototype.handleDown=function(e,t){var r=t.getPointTransformed();this.preview_.setX1(r[0]),this.preview_.setY1(r[1]),this.preview_.setX2(r[0]),this.preview_.setY2(r[1]),this.target_.getDrawing().handleShapeCreate([this.preview_])},xrx.shape.LineCreatable.prototype.handleMove=function(e,t){var r=t.getPointTransformed();this.preview_.setX2(r[0]),this.preview_.setY2(r[1])},xrx.shape.LineCreatable.prototype.handleUp=function(e,t){var r=t.getPointTransformed(),n=new xrx.shape.Line(this.target_.getDrawing());n.setStyle(this.target_),n.setX1(this.preview_.getX1()),n.setY1(this.preview_.getY1()),n.setX2(r[0]),n.setY2(r[1]),this.target_.getDrawing().handleShapeCreated(n)},xrx.shape.LineCreatable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.shape.Rect"),n.provide("xrx.shape.RectCreatable"),n.provide("xrx.shape.RectHoverable"),n.provide("xrx.shape.RectModifiable"),n.provide("xrx.shape.RectSelectable"),n.require("goog.array"),n.require("xrx.geometry.Path"),n.require("xrx.shape.Creatable"),n.require("xrx.shape.Dragger"),n.require("xrx.shape.Hoverable"),n.require("xrx.shape.Modifiable"),n.require("xrx.shape.PathLike"),n.require("xrx.shape.Selectable"),xrx.shape.Rect=function(e){n.base(this,e,new xrx.geometry.Path(4)),this.engineElement_=this.drawing_.getEngine().createRect()},n.inherits(xrx.shape.Rect,xrx.shape.PathLike),xrx.shape.Rect.prototype.setX=function(e){this.geometry_.coords[0][0]=e,this.geometry_.coords[3][0]=e},xrx.shape.Rect.prototype.getX=function(){return this.geometry_.coords[0][0]},xrx.shape.Rect.prototype.setY=function(e){this.geometry_.coords[0][1]=e,this.geometry_.coords[1][1]=e},xrx.shape.Rect.prototype.getY=function(){return this.geometry_.coords[0][1]},xrx.shape.Rect.prototype.setWidth=function(e){var t=this.geometry_.coords[0][0];this.geometry_.coords[1][0]=t+e,this.geometry_.coords[2][0]=t+e},xrx.shape.Rect.prototype.getWidth=function(){var e=this.geometry_.coords;return e[1][0]-e[0][0]},xrx.shape.Rect.prototype.setHeight=function(e){var t=this.geometry_.coords[0][1];this.geometry_.coords[2][1]=t+e,this.geometry_.coords[3][1]=t+e},xrx.shape.Rect.prototype.getHeight=function(){var e=this.geometry_.coords;return e[3][1]-e[0][1]},xrx.shape.Rect.prototype.setAffineCoords=function(e){var t=this.getCoords();return 0===e||2===e?(t[1][0]=t[2][0],t[1][1]=t[0][1],t[3][0]=t[0][0],t[3][1]=t[2][1]):(t[0][0]=t[3][0],t[0][1]=t[1][1],t[2][0]=t[1][0],t[2][1]=t[3][1]),t},xrx.shape.Rect.prototype.draw=function(){this.startDrawing_(),this.engineElement_.draw(this.getCoords(),this.getRenderingFillColor(),this.getRenderingFillOpacity(),this.getRenderingStrokeColor(),this.getRenderingStrokeWidth()),this.finishDrawing_()},xrx.shape.Rect.prototype.getHoverable=function(){return this.hoverable_||(this.hoverable_=new xrx.shape.RectHoverable(this)),this.hoverable_},xrx.shape.Rect.prototype.getSelectable=function(){return this.selectable_||(this.selectable_=new xrx.shape.RectSelectable(this)),this.selectable_},xrx.shape.Rect.prototype.getModifiable=function(e){return this.modifiable_||(this.modifiable_=new xrx.shape.RectModifiable(this)),this.modifiable_},xrx.shape.Rect.prototype.getCreatable=function(){return this.creatable_||(this.creatable_=new xrx.shape.RectCreatable(this)),this.creatable_},xrx.shape.Rect.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.RectHoverable=function(e){n.base(this,e)},n.inherits(xrx.shape.RectHoverable,xrx.shape.Hoverable),xrx.shape.RectHoverable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.RectSelectable=function(e){n.base(this,e)},n.inherits(xrx.shape.RectSelectable,xrx.shape.Selectable),xrx.shape.RectSelectable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.RectModifiable=function(e,t){n.base(this,e,t),this.init_()},n.inherits(xrx.shape.RectModifiable,xrx.shape.Modifiable),xrx.shape.RectModifiable.prototype.setCoords=function(e,t){for(var r=0,n=this.dragger_.length;r<n;r++)r!==t&&(this.dragger_[r].setCoordX(e[r][0]),this.dragger_[r].setCoordY(e[r][1]));this.shape_.setCoords(e)},xrx.shape.RectModifiable.prototype.setCoordAt=function(e,t){var r;this.shape_.setCoordAt(e,t),this.shape_.setAffineCoords(e),r=this.shape_.getCoords(),this.dragger_[0].setCoordX(r[0][0]),this.dragger_[0].setCoordY(r[0][1]),this.dragger_[1].setCoordX(r[1][0]),this.dragger_[1].setCoordY(r[1][1]),this.dragger_[2].setCoordX(r[2][0]),this.dragger_[2].setCoordY(r[2][1]),this.dragger_[3].setCoordX(r[3][0]),this.dragger_[3].setCoordY(r[3][1])},xrx.shape.RectModifiable.prototype.move=function(e,t){for(var r=this.shape_.getCoordsCopy(),n=0,i=r.length;n<i;n++)r[n][0]+=e,r[n][1]+=t;this.setCoords(r)},xrx.shape.RectModifiable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},xrx.shape.RectModifiable.prototype.init_=function(){for(var e,t=this.shape_.getCoords(),r=[],n=0,i=t.length;n<i;n++)e=new xrx.shape.Dragger(this,n),e.setCoords([t[n]]),r.push(e);this.setDragger(r)},xrx.shape.RectCreatable=function(e){n.base(this,e,new xrx.shape.Rect(e.getDrawing()))},n.inherits(xrx.shape.RectCreatable,xrx.shape.Creatable),xrx.shape.RectCreatable.prototype.getCoords=function(){return this.preview_.getCoords()},xrx.shape.RectCreatable.prototype.handleDown=function(e,t){var r=t.getPointTransformed(),i=new Array(4);i[0]=n.array.clone(r),i[1]=n.array.clone(r),i[2]=n.array.clone(r),i[3]=n.array.clone(r),this.preview_.setCoords(i),this.target_.getDrawing().handleShapeCreate([this.preview_])},xrx.shape.RectCreatable.prototype.handleMove=function(e,t){var r=t.getPointTransformed();this.preview_.setCoordAt(2,r),this.preview_.setAffineCoords(2)},xrx.shape.RectCreatable.prototype.handleUp=function(e,t){var r=new xrx.shape.Rect(this.target_.getDrawing());r.setStyle(this.target_),r.setCoords(this.preview_.getCoordsCopy()),this.target_.getDrawing().handleShapeCreated(r)};xrx.shape.RectCreatable.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.shape.ShapeGroup"),n.provide("xrx.shape.ShapeGroupCreatable"),n.provide("xrx.shape.ShapeGroupHoverable"),n.provide("xrx.shape.ShapeGroupModifiable"),n.provide("xrx.shape.ShapeGroupSelectable"),n.require("xrx.shape.Group"),n.require("xrx.shape.Creatable"),n.require("xrx.shape.Hoverable"),n.require("xrx.shape.Modifiable"),n.require("xrx.shape.Selectable"),xrx.shape.ShapeGroup=function(e){n.base(this,e)},n.inherits(xrx.shape.ShapeGroup,xrx.shape.Group),xrx.shape.ShapeGroup.prototype.addChildren=function(e){n.base(this,"addChildren",e);for(var t=0,r=this.childs_.length;t<r;t++)this.childs_[t].setShapeGroup(this),this.geometry_.addChild(this.childs_[t].getGeometry())},xrx.shape.ShapeGroup.prototype.getHoverable=function(){return void 0===this.hoverable_&&(this.hoverable_=new xrx.shape.ShapeGroupHoverable(this)),this.hoverable_},xrx.shape.ShapeGroup.prototype.getSelectable=function(){return void 0===this.selectable_&&(this.selectable_=new xrx.shape.ShapeGroupSelectable(this)),this.selectable_},xrx.shape.ShapeGroup.prototype.getModifiable=function(){return void 0===this.modifiable_&&(this.modifiable_=new xrx.shape.ShapeGroupModifiable(this)),this.modifiable_},xrx.shape.ShapeGroup.prototype.getCreatable=function(){return void 0===this.creatable_&&(this.creatable_=new xrx.shape.ShapeGroupCreatable(this)),this.creatable_},xrx.shape.ShapeGroupHoverable=function(e){n.base(this,e)},n.inherits(xrx.shape.ShapeGroupHoverable,xrx.shape.Hoverable),xrx.shape.ShapeGroupSelectable=function(e){n.base(this,e)},n.inherits(xrx.shape.ShapeGroupSelectable,xrx.shape.Selectable),xrx.shape.ShapeGroupModifiable=function(e){n.base(this,e)},n.inherits(xrx.shape.ShapeGroupModifiable,xrx.shape.Modifiable),xrx.shape.ShapeGroupModifiable.prototype.getDragger=function(){for(var e=this.shape_.getChildren(),t=[],r=0,n=e.length;r<n;r++)t=t.concat(e[r].getModifiable().getDragger());return t},xrx.shape.ShapeGroupModifiable.prototype.move=function(e,t){for(var r=this.shape_.getChildren(),n=0,i=r.length;n<i;n++)r[n].getModifiable().move(e,t)},xrx.shape.ShapeGroupCreatable=function(e){n.base(this,e,new xrx.shape.ShapeGroup(e.getDrawing())),this.current=0},n.inherits(xrx.shape.ShapeGroupCreatable,xrx.shape.Creatable),xrx.shape.ShapeGroupCreatable.prototype.allShapesCreated=function(){return this.current===this.target_.getChildren().length-1},xrx.shape.ShapeGroupCreatable.prototype.reset=function(){this.current=0,this.preview_.removeChildren()},xrx.shape.ShapeGroupCreatable.prototype.handleDown=function(e,t){this.target_.getChild(this.current).getCreatable().handleDown(e,t)},xrx.shape.ShapeGroupCreatable.prototype.handleMove=function(e,t){this.target_.getChild(this.current).getCreatable().handleMove(e,t)},xrx.shape.ShapeGroupCreatable.prototype.handleUp=function(e,t){this.target_.getChild(this.current).getCreatable().handleUp(e,t)},n.provide("xrx.shape.Canvas"),n.require("goog.dom.DomHelper"),n.require("xrx.shape"),n.require("xrx.shape.Container"),xrx.shape.Canvas=function(e){n.base(this,e),this.engineElement_=this.drawing_.getEngine().getCanvas(),n.dom.append(this.drawing_.getElement(),this.engineElement_.getElement())},n.inherits(xrx.shape.Canvas,xrx.shape.Container),xrx.shape.Canvas.prototype.getElement=function(){return this.drawing_.getElement()},xrx.shape.Canvas.prototype.getEngine=function(){return this.drawing_.getEngine()},xrx.shape.Canvas.prototype.getHeight=function(){return this.engineElement_.getHeight()},xrx.shape.Canvas.prototype.setHeight=function(e){this.engineElement_.setHeight(e)},xrx.shape.Canvas.prototype.getWidth=function(){return this.engineElement_.getWidth()},xrx.shape.Canvas.prototype.setWidth=function(e){this.engineElement_.setWidth(e)},xrx.shape.Canvas.prototype.draw=function(){this.startDrawing_();for(var e=0,t=this.childs_.length;e<t;e++)this.childs_[e].draw();this.finishDrawing_()},xrx.shape.Canvas.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.shape.Shapes"),n.require("xrx.shape"),n.require("xrx.shape.Canvas"),n.require("xrx.shape.Circle"),n.require("xrx.shape.CircleCreatable"),n.require("xrx.shape.CircleHoverable"),n.require("xrx.shape.CircleModifiable"),n.require("xrx.shape.CircleSelectable"),n.require("xrx.shape.Dragger"),n.require("xrx.shape.Ellipse"),n.require("xrx.shape.EllipseCreatable"),n.require("xrx.shape.EllipseHoverable"),n.require("xrx.shape.EllipseModifiable"),n.require("xrx.shape.EllipseSelectable"),n.require("xrx.shape.Group"),n.require("xrx.shape.Image"),n.require("xrx.shape.Line"),n.require("xrx.shape.LineCreatable"),n.require("xrx.shape.LineHoverable"),n.require("xrx.shape.LineModifiable"),n.require("xrx.shape.LineSelectable"),n.require("xrx.shape.Polygon"),n.require("xrx.shape.PolygonCreatable"),n.require("xrx.shape.PolygonHoverable"),n.require("xrx.shape.PolygonModifiable"),n.require("xrx.shape.PolygonSelectable"),n.require("xrx.shape.Polyline"),n.require("xrx.shape.PolylineCreatable"),n.require("xrx.shape.PolylineHoverable"),n.require("xrx.shape.PolylineModifiable"),n.require("xrx.shape.PolylineSelectable"),n.require("xrx.shape.Rect"),n.require("xrx.shape.RectCreatable"),n.require("xrx.shape.RectHoverable"),n.require("xrx.shape.RectModifiable"),n.require("xrx.shape.RectSelectable"),n.require("xrx.shape.ShapeGroup"),xrx.shape.Shapes=function(){},n.provide("xrx.drawing.EventTarget"),n.require("goog.events"),n.require("goog.Disposable"),n.require("goog.events.EventHandler"),n.require("goog.events.EventType"),n.require("goog.events.MouseWheelHandler"),n.require("goog.events.MouseWheelHandler.EventType"),n.require("goog.math"),n.require("goog.style"),n.require("goog.Timer"),n.require("goog.userAgent"),n.require("xrx.event.Handler"),n.require("xrx.event.Type"),n.require("xrx.drawing.Cursor"),n.require("xrx.drawing.Mode"),n.require("xrx.shape.Shapes"),xrx.drawing.EventTarget=function(){n.base(this),this.handler_=new n.events.EventHandler(this),this.cursor_=new xrx.drawing.Cursor(this),this.eventTarget_=xrx.drawing.EventTarget.DRAWING},n.inherits(xrx.drawing.EventTarget,n.Disposable),xrx.drawing.EventTarget.DRAWING="DRAWING",xrx.drawing.EventTarget.VIEWBOX="VIEWBOX",xrx.drawing.EventTarget.prototype.setEventTarget=function(e){if(e!==xrx.drawing.EventTarget.DRAWING&&e!==xrx.drawing.EventTarget.VIEWBOX)throw Error("xrx.drawing.EventTarget.DRAWING or xrx.drawing.EventTarget.VIEWBOX expected.");this.eventTarget_=e},xrx.drawing.EventTarget.prototype.getHandler=function(){return this.handler_},xrx.drawing.EventTarget.prototype.registerEvent_=function(e,t,r){this.cursor_.init(e);var n=this.viewbox_.containsPoint(this.cursor_.getPoint());(this.eventTarget_===xrx.drawing.EventTarget.VIEWBOX&&n||this.eventTarget_===xrx.drawing.EventTarget.DRAWING)&&(e.preventDefault(),e.stopPropagation(),e.getBrowserEvent().changedTouches&&e.init(e.getBrowserEvent().changedTouches[0],e.currentTarget),t[r](e,this.cursor_),this.draw())},xrx.drawing.EventTarget.prototype.registerClick=function(e){var t=this;this.handler_.listen(t.canvas_.getEngineElement().getEventTarget(),xrx.event.Type.CLICK,function(r){t.registerEvent_(r,e,xrx.event.Handler.CLICK)},!1)},xrx.drawing.EventTarget.prototype.registerDblClick=function(e){var t=this;this.handler_.listen(t.canvas_.getEngineElement().getEventTarget(),xrx.event.Type.DBLCLICK,function(r){t.registerEvent_(r,e,xrx.event.Handler.DBLCLICK)},!1)},xrx.drawing.EventTarget.prototype.registerDown=function(e){var t=this;this.handler_.listen(t.canvas_.getEngineElement().getEventTarget(),xrx.event.Type.DOWN,function(r){t.registerEvent_(r,e,xrx.event.Handler.DOWN)},!1)},xrx.drawing.EventTarget.prototype.registerDrag=function(e){this.registerDown(e),this.registerMove(e),this.registerUp(e)},xrx.drawing.EventTarget.prototype.registerMove=function(e){var t=this;this.handler_.listen(t.canvas_.getEngineElement().getEventTarget(),xrx.event.Type.MOVE,function(r){t.registerEvent_(r,e,xrx.event.Handler.MOVE)},!1)},xrx.drawing.EventTarget.prototype.registerHover=function(e){var t=this;this.handler_.listen(t.canvas_.getEngineElement().getEventTarget(),xrx.event.Type.MOVE,function(r){t.registerEvent_(r,e,xrx.event.Handler.MOVE)},!1)},xrx.drawing.EventTarget.prototype.registerOut=function(e){var t=this;this.handler_.listen(t.canvas_.getEngineElement().getEventTarget(),xrx.event.Type.OUT,function(r){t.registerEvent_(r,e,xrx.event.Handler.OUT)},!1)},xrx.drawing.EventTarget.prototype.registerUp=function(e){var t=this;this.handler_.listen(t.canvas_.getEngineElement().getEventTarget(),xrx.event.Type.UP,function(r){t.registerEvent_(r,e,xrx.event.Handler.UP)},!1)},xrx.drawing.EventTarget.prototype.registerWheel=function(e){if(!n.userAgent.MOBILE){var t=this,r=new n.events.MouseWheelHandler(t.canvas_.getEngineElement().getEventTarget());this.handler_.listen(r,xrx.event.Type.WHEEL,function(r){t.registerEvent_(r,e,xrx.event.Handler.WHEEL)},!1)}},xrx.drawing.EventTarget.prototype.disposeInternal=function(){this.handler_&&(this.handler_.dispose(),this.handler_=null)},xrx.drawing.EventTarget.prototype.registerEvents=function(e){switch(this.handler_.removeAll(),e){case void 0:case xrx.drawing.Mode.DISABLED:break;case xrx.drawing.Mode.VIEW:this.registerDblClick(this.viewbox_),this.registerDrag(this.viewbox_),this.registerOut(this.viewbox_),this.registerWheel(this.viewbox_);break;case xrx.drawing.Mode.SELECT:this.registerDown(this.selectable_),this.registerWheel(this.viewbox_);break;case xrx.drawing.Mode.MODIFY:this.registerDrag(this.modifiable_),this.registerWheel(this.viewbox_);break;case xrx.drawing.Mode.CREATE:this.registerDown(this.creatable_),this.registerMove(this.creatable_),this.registerUp(this.creatable_),this.registerWheel(this.viewbox_);break;case xrx.drawing.Mode.HOVER:case xrx.drawing.Mode.HOVERMULTIPLE:this.registerHover(this.hoverable_),this.registerOut(this.hoverable_),this.registerWheel(this.viewbox_),this.registerDrag(this.viewbox_);break;default:throw Error("Unknown mode.")}},xrx.drawing.EventTarget.prototype.disposeInternal=function(){this.handler_.removeAll(),this.handler_.dispose(),this.handler_=null,this.cursor_.dispose(),this.cursor_=null,n.base(this,"disposeInternal")},n.provide("xrx.drawing.EventHandler"),n.require("goog.style"),n.require("xrx.drawing.EventTarget"),xrx.drawing.EventHandler=function(){n.base(this)},n.inherits(xrx.drawing.EventHandler,xrx.drawing.EventTarget),xrx.drawing.EventHandler.prototype.handleShapeCreate=function(e){this.creatable_.handleCreate(e)},xrx.drawing.EventHandler.prototype.handleShapeCreated=function(e){this.creatable_.handleCreated(e)},xrx.drawing.EventHandler.prototype.getClientPoint=function(e){var t,r,n=e.getBrowserEvent().changedTouches;return n?(t=n[0].clientX,r=n[0].clientY):(t=e.clientX,r=e.clientY),[t,r]},xrx.drawing.EventHandler.prototype.getOffsetPoint=function(e,t){var r=n.style.getClientPosition(this.canvas_.getEngineElement().getEventTarget()),i=this.getClientPoint(e),o=[i[0]-r.x,i[1]-r.y];return!0===t?this.getViewbox().getCTM().transformPoint(o):o},xrx.drawing.EventHandler.prototype.getShapeSelected=function(e){for(var t,r,n,i=!1,o=this.layer_.length-1;o>=0;o--){if(t=this.layer_[o],!t.isLocked()){r=t.getShapes()||[];for(var s=r.length-1;s>=0;s--)if(n=r[s],n.getGeometry().containsPoint(e)){i=!0;break}}if(!0===i)break}return i?n:void 0},xrx.drawing.EventHandler.prototype.getShapesSelected=function(e){for(var t,r,n,i=[],o=this.layer_.length-1;o>=0;o--)if(t=this.layer_[o],!t.isLocked()){r=t.getShapes()||[];for(var s=r.length-1;s>=0;s--)n=r[s],n.getGeometry().containsPoint(e)&&i.push(n)}return i},xrx.drawing.EventHandler.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.drawing.LayerShapeModify"),n.require("xrx.drawing.Layer"),xrx.drawing.LayerShapeModify=function(e){n.base(this,e)},n.inherits(xrx.drawing.LayerShapeModify,xrx.drawing.Layer),xrx.drawing.LayerShapeModify.prototype.activate=function(e){this.removeShapes(),this.addShapes(e.getDragger())},xrx.drawing.LayerShapeModify.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("goog.net.EventType"),n.net.EventType={COMPLETE:"complete",SUCCESS:"success",ERROR:"error",ABORT:"abort",READY:"ready",READY_STATE_CHANGE:"readystatechange",TIMEOUT:"timeout",INCREMENTAL_DATA:"incrementaldata",PROGRESS:"progress"},n.provide("goog.net.ImageLoader"),n.require("goog.array"),n.require("goog.dom"),n.require("goog.events.EventHandler"),n.require("goog.events.EventTarget"),n.require("goog.events.EventType"),n.require("goog.net.EventType"),n.require("goog.object"),n.require("goog.userAgent"),n.net.ImageLoader=function(e){n.events.EventTarget.call(this),this.imageIdToRequestMap_={},this.imageIdToImageMap_={},this.handler_=new n.events.EventHandler(this),this.parent_=e},n.inherits(n.net.ImageLoader,n.events.EventTarget),n.net.ImageLoader.CorsRequestType={ANONYMOUS:"anonymous",USE_CREDENTIALS:"use-credentials"},n.net.ImageLoader.ImageRequest_,n.net.ImageLoader.IMAGE_LOAD_EVENTS_=[n.userAgent.IE&&!n.userAgent.isVersionOrHigher("11")?n.net.EventType.READY_STATE_CHANGE:n.events.EventType.LOAD,n.net.EventType.ABORT,n.net.EventType.ERROR],n.net.ImageLoader.prototype.addImage=function(e,t,r){var i=n.isString(t)?t:t.src;i&&(this.imageIdToRequestMap_[e]={src:i,corsRequestType:n.isDef(r)?r:null})},n.net.ImageLoader.prototype.removeImage=function(e){delete this.imageIdToRequestMap_[e];var t=this.imageIdToImageMap_[e];t&&(delete this.imageIdToImageMap_[e],this.handler_.unlisten(t,n.net.ImageLoader.IMAGE_LOAD_EVENTS_,this.onNetworkEvent_),n.object.isEmpty(this.imageIdToImageMap_)&&n.object.isEmpty(this.imageIdToRequestMap_)&&this.dispatchEvent(n.net.EventType.COMPLETE))},n.net.ImageLoader.prototype.start=function(){var e=this.imageIdToRequestMap_;n.array.forEach(n.object.getKeys(e),function(t){var r=e[t];r&&(delete e[t],this.loadImage_(r,t))},this)},n.net.ImageLoader.prototype.loadImage_=function(e,t){if(!this.isDisposed()){var r;if(this.parent_){r=n.dom.getDomHelper(this.parent_).createDom("img")}else r=new Image;e.corsRequestType&&(r.crossOrigin=e.corsRequestType),this.handler_.listen(r,n.net.ImageLoader.IMAGE_LOAD_EVENTS_,this.onNetworkEvent_),this.imageIdToImageMap_[t]=r,r.id=t,r.src=e.src}},n.net.ImageLoader.prototype.onNetworkEvent_=function(e){var t=e.currentTarget;if(t){if(e.type==n.net.EventType.READY_STATE_CHANGE){if(t.readyState!=n.net.EventType.COMPLETE)return;e.type=n.events.EventType.LOAD}void 0===t.naturalWidth&&(e.type==n.events.EventType.LOAD?(t.naturalWidth=t.width,t.naturalHeight=t.height):(t.naturalWidth=0,t.naturalHeight=0)),this.dispatchEvent({type:e.type,target:t}),this.isDisposed()||this.removeImage(t.id)}},n.net.ImageLoader.prototype.disposeInternal=function(){delete this.imageIdToRequestMap_,delete this.imageIdToImageMap_,n.dispose(this.handler_),n.net.ImageLoader.superClass_.disposeInternal.call(this)},n.provide("xrx.EventTarget"),n.require("goog.Disposable"),n.require("goog.string"),xrx.EventTarget=function(){n.base(this)},n.inherits(xrx.EventTarget,n.Disposable),xrx.EventTarget.prototype.dispatchExternal=function(e,t){if(!n.string.startsWith(e,"event"))throw Error('Invalid event-type "". Prefix "event*" expected.');var r;r=void 0!==t?t:this,r[e]&&(arguments.length<=2?r[e].apply(r):r[e].apply(r,this.argsArray_(arguments)))},xrx.EventTarget.prototype.argsArray_=function(e){for(var t=e.length-2,r=new Array(t),n=0;n<t;n++)r[n]=e[n+2];return r},xrx.EventTarget.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.geometry.Box"),n.require("xrx.geometry.Geometry"),xrx.geometry.Box=function(){n.base(this)},n.inherits(xrx.geometry.Box,xrx.geometry.Geometry),xrx.geometry.Box.containsPoint=function(e,t){return t[0]>=e[3]&&t[0]<=e[1]&&t[1]>=e[0]&&t[1]<=e[2]},n.provide("xrx.geometry.Point"),n.require("xrx.geometry.Geometry"),xrx.geometry.Point=function(){n.base(this)},n.inherits(xrx.geometry.Point,xrx.geometry.Geometry),xrx.geometry.Point.distancePoint=function(e,t){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},xrx.geometry.Point.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.viewbox.ViewboxGeometry"),n.require("goog.array"),n.require("goog.object"),n.require("xrx.geometry.Box"),n.require("xrx.geometry.Point"),n.require("xrx.EventTarget"),xrx.viewbox.ViewboxGeometry=function(){n.base(this),this.box_=new Array(4),this.xy_=new Array(2),this.wh_=new Array(2)},n.inherits(xrx.viewbox.ViewboxGeometry,xrx.EventTarget),xrx.viewbox.ViewboxGeometry.prototype.getWidth=function(e,t){if(!0===t&&this.isHorizontal())return this.getHeight(e);var r=this.getDrawing().getLayerBackground().getImage(),n=r.getImage()?r.getWidth():this.drawing_.getWidth();return e?n*this.ctm_.getScale():n},xrx.viewbox.ViewboxGeometry.prototype.getHeight=function(e,t){if(!0===t&&this.isHorizontal())return this.getWidth(e);var r=this.getDrawing().getLayerBackground().getImage(),n=r.getImage()?r.getHeight():this.drawing_.getHeight();return e?n*this.ctm_.getScale():n},xrx.viewbox.ViewboxGeometry.prototype.getBox=function(){var e=this.getRotation(),t=this.getWidth(!1,!1),r=this.getHeight(!1,!1);return this.ctm_.transform([0,0],0,this.xy_,0,1),this.ctm_.transform([t,r],0,this.wh_,0,1),0===e?(this.box_[0]=this.xy_[1],this.box_[1]=this.wh_[0],this.box_[2]=this.wh_[1],this.box_[3]=this.xy_[0]):90===e?(this.box_[0]=this.xy_[1],this.box_[1]=this.xy_[0],this.box_[2]=this.wh_[1],this.box_[3]=this.wh_[0]):180===e?(this.box_[0]=this.wh_[1],this.box_[1]=this.xy_[0],this.box_[2]=this.xy_[1],this.box_[3]=this.wh_[0]):(this.box_[0]=this.wh_[1],this.box_[1]=this.wh_[0],this.box_[2]=this.xy_[1],this.box_[3]=this.xy_[0]),this.box_},xrx.viewbox.ViewboxGeometry.prototype.containsPoint=function(e){var t=this.getBox();return xrx.geometry.Box.containsPoint(t,e)},xrx.viewbox.ViewboxGeometry.prototype.getCenterPoint_=function(e){var t,r=[this.getWidth()/2,this.getHeight()/2];return!0!==e?r:(t=new Array(2),this.ctm_.transform(r,0,t,0,1),t)},xrx.viewbox.ViewboxGeometry.prototype.getVisibleOrientation_=function(e){var t=["NW","SW","SE","NE"];return t[(n.array.indexOf(t,e)+this.getRotation()/90)%4]},xrx.viewbox.ViewboxGeometry.prototype.FixPoints_={C:[0,0],NE:[0,0],SE:[0,0],SW:[0,0],NW:[0,0]},xrx.viewbox.ViewboxGeometry.prototype.getFixPoints_=function(){var e=this.getWidth(),t=this.getHeight();return this.FixPoints_.C=[e/2,t/2],this.FixPoints_.NE=[e,0],this.FixPoints_.SE=[e,t],this.FixPoints_.SW=[0,t],this.FixPoints_.NW=[0,0],this.FixPoints_},xrx.viewbox.ViewboxGeometry.prototype.getFixPoint_=function(e,t,r){var n=this.getFixPoints_(),i=r?n[this.getVisibleOrientation_(e)]:n[e];if(i||console.error("fixPoint could not be determined. Is the element containing the canvas visible?"),!0===t){var o=new Array(2);return this.ctm_.transform(i,0,o,0,1),o}return i},xrx.viewbox.ViewboxGeometry.prototype.disposeInternal=function(){this.box_=null,n.base(this,"disposeInternal")},n.provide("xrx.viewbox.ViewboxRotate"),n.require("goog.object"),n.require("xrx.drawing.Orientation");n.require("xrx.viewbox.ViewboxGeometry"),xrx.viewbox.ViewboxRotate=function(){n.base(this)},n.inherits(xrx.viewbox.ViewboxRotate,xrx.viewbox.ViewboxGeometry),xrx.viewbox.ViewboxRotate.prototype.getRotation=function(){return this.ctm_.getRotation()},xrx.viewbox.ViewboxRotate.prototype.isValidRotation=function(e){var t=Math.abs(e);return 0===t||90===t||180===t||270===t},xrx.viewbox.ViewboxRotate.prototype.isVertical=function(){var e=this.ctm_.getRotation();return 0===e||180===e},xrx.viewbox.ViewboxRotate.prototype.isHorizontal=function(){var e=this.ctm_.getRotation();return 90===e||270===e},xrx.viewbox.ViewboxRotate.Direction_={0:0,90:1,180:2,270:3},xrx.viewbox.ViewboxRotate.prototype.direction_=function(){var e=this.ctm_.getRotation();return xrx.viewbox.ViewboxRotate.Direction_[parseInt(e)]},xrx.viewbox.ViewboxRotate.prototype.rotateBy=function(e,t){if(void 0===t)this.rotateBy_(e,void 0,void 0);else if(this.isFixPoint_(t))this.rotateBy_(e,void 0,t);else{if(!this.isOrientation_(t))throw Error("Invalid fix-point. Array[2] or xrx.drawing.Orientation.* expected.");this.rotateBy_(e,t,void 0)}this.drawing_.draw()},xrx.viewbox.ViewboxRotate.prototype.rotateLeft=function(e){this.rotateBy(-90,e)},xrx.viewbox.ViewboxRotate.prototype.rotateRight=function(e){this.rotateBy(90,e)},xrx.viewbox.ViewboxRotate.prototype.isFixPoint_=function(e){return e instanceof Array&&2===e.length},xrx.viewbox.ViewboxRotate.prototype.isOrientation_=function(e){return"string"==typeof e&&n.object.containsValue(xrx.drawing.Orientation,e)},xrx.viewbox.ViewboxRotate.prototype.rotateBy_=function(e,t,r){if(0!==e){if(!this.isValidRotation(e))throw Error("Invalid rotation. 0, 90, 180 or 270 expected.");var i,o=!(e>0);void 0!==t&&(i=this.getPivotPoint_(t,o,!0)),void 0!==r&&(i=this.containsPoint(r)?this.ctm_.transformPoint(r):this.getPivotPoint_(xrx.drawing.Orientation.C,o,!0)),void 0===i&&(i=this.getPivotPoint_(xrx.drawing.Orientation.C,o,!0)),this.ctm_.rotate(n.math.toRadians(e),i[0],i[1]),this.dispatchExternal(xrx.drawing.EventType.VIEWBOX_CHANGE,this.drawing_)}},xrx.viewbox.ViewboxRotate.prototype.getPivotPoint_=function(e,t,r){var n=this.getPivotPoints_(t),i={C:function(e,t){return t.getCenterPoint_()},NE:function(e,t,r){var n=[0,1,2,3];return console.log(t.direction_()),e[n[t.direction_()]]},SE:function(e,t,r){return e[[3,0,1,2][t.direction_()]]},SW:function(e,t,r){return e[[2,3,0,1][t.direction_()]]},NW:function(e,t,r){return e[[1,2,3,0][t.direction_()]]}},o=i[e](n,this,t);return!0===r&&this.ctm_.transformPoint(o),o},xrx.viewbox.ViewboxRotate.prototype.getPivotPoints_=function(e){var t=this.getWidth(),r=this.getHeight();return e?[[-r/2+t,r/2],[t/2,t/2],[r/2,r/2],[t/2,t/2+r/2]]:[[t/2,t/2],[r/2,r/2],[t/2,t/2+r/2],[-r/2+t,r/2]]},xrx.viewbox.ViewboxRotate.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.viewbox.ViewboxZoom"),n.require("xrx.viewbox.ViewboxRotate"),xrx.viewbox.ViewboxZoom=function(){n.base(this)},n.inherits(xrx.viewbox.ViewboxZoom,xrx.viewbox.ViewboxRotate),xrx.viewbox.ViewboxZoom.prototype.zoomFactor_=.1,xrx.viewbox.ViewboxZoom.prototype.getZoomFactor=function(){return this.zoomFactor_},xrx.viewbox.ViewboxZoom.prototype.setZoomFactor=function(e){this.zoomFactor_=e},xrx.viewbox.ViewboxZoom.prototype.getZoomValue=function(e){return void 0===e?this.ctm_.getScale():this.zoomMin_+e*this.zoomFactor_},xrx.viewbox.ViewboxZoom.prototype.zoomMin_=.1,xrx.viewbox.ViewboxZoom.prototype.getZoomMin=function(){return this.zoomMin_},xrx.viewbox.ViewboxZoom.prototype.setZoomFactorMin=function(e){this.zoomMin_=e},xrx.viewbox.ViewboxZoom.prototype.zoomMax_=2,xrx.viewbox.ViewboxZoom.prototype.getZoomMax=function(){return this.zoomMax_},xrx.viewbox.ViewboxZoom.prototype.setZoomFactorMax=function(e){this.zoomMax_=e},xrx.viewbox.ViewboxZoom.prototype.getZoomStep=function(e){var t=void 0!==e?e:this.getZoomValue();return Math.round((t-this.zoomMin_)/this.zoomFactor_)},xrx.viewbox.ViewboxZoom.prototype.zoomOffset_=function(e,t){this.ctm_.setTransform(this.ctm_.getScaleX(),this.ctm_.getShearY(),this.ctm_.getShearX(),this.ctm_.getScaleY(),(this.ctm_.getTranslateX()-e[0])*t+e[0],(this.ctm_.getTranslateY()-e[1])*t+e[1])},xrx.viewbox.ViewboxZoom.prototype.zoomTo=function(e,t){var r;r=void 0!==t&&this.containsPoint(t)?t:this.getCenterPoint_(!0),e<this.zoomMin_&&(e=this.zoomMin_),e>this.zoomMax_&&(e=this.zoomMax_);var n=1/this.getZoomValue()*e;this.zoomOffset_(r,n),this.ctm_.scale(n,n),this.drawing_.draw(),this.dispatchExternal(xrx.drawing.EventType.VIEWBOX_CHANGE,this.drawing_)},xrx.viewbox.ViewboxZoom.prototype.zoomIn=function(e){this.zoomTo(this.ctm_.getScale()+this.zoomFactor_,e)},xrx.viewbox.ViewboxZoom.prototype.zoomOut=function(e){this.zoomTo(this.ctm_.getScale()-this.zoomFactor_,e)},xrx.viewbox.ViewboxZoom.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.viewbox.ViewboxTranslate"),n.require("xrx.drawing.EventType"),n.require("xrx.drawing.Orientation"),n.require("xrx.drawing.Position"),n.require("xrx.viewbox.ViewboxZoom"),xrx.viewbox.ViewboxTranslate=function(){n.base(this)},n.inherits(xrx.viewbox.ViewboxTranslate,xrx.viewbox.ViewboxZoom),xrx.viewbox.ViewboxTranslate.prototype.translate=function(e,t){var r=this.ctm_.getIdentity(),n=r.transformPoint([e,t]);this.ctm_=r.translate(n[0],n[1]).concatenate(this.ctm_),this.drawing_.draw(),this.dispatchExternal(xrx.drawing.EventType.VIEWBOX_CHANGE,this.drawing_)},xrx.viewbox.ViewboxTranslate.prototype.center=function(){this.centerHorizontally(),this.centerVertically()},xrx.viewbox.ViewboxTranslate.prototype.centerHorizontally=function(){var e=this.getFixPoint_(xrx.drawing.Orientation.NW,!0,!0),t=this.getWidth(!0,!0),r=this.getDrawing().getWidth()/2-(e[0]+t/2);this.translate(r,0),this.drawing_.draw(),this.dispatchExternal(xrx.drawing.EventType.VIEWBOX_CHANGE,this.drawing_)},xrx.viewbox.ViewboxTranslate.prototype.centerVertically=function(){var e=this.getFixPoint_(xrx.drawing.Orientation.NW,!0,!0),t=this.getHeight(!0,!0),r=this.getDrawing().getHeight()/2-(e[1]+t/2);this.translate(0,r),this.drawing_.draw(),this.dispatchExternal(xrx.drawing.EventType.VIEWBOX_CHANGE,this.drawing_)},xrx.viewbox.ViewboxTranslate.prototype.setPosition=function(e){var t=this.drawing_.getWidth(),r=this.drawing_.getHeight(),n=this.getFixPoint_(e,!0,!0);if(e===xrx.drawing.Position.NW)this.translate(-n[0],-n[1]);else if(e===xrx.drawing.Position.NE)this.translate(t-n[0],-n[1]);else if(e===xrx.drawing.Position.SE)this.translate(t-n[0],r-n[1]);else{if(e!==xrx.drawing.Position.SW)throw Error("Unknown position.");this.translate(-n[0],r-n[1])}this.drawing_.draw(),this.dispatchExternal(xrx.drawing.EventType.VIEWBOX_CHANGE,this.drawing_)},xrx.viewbox.ViewboxTranslate.prototype.disposeInternal=function(){n.base(this,"disposeInternal")},n.provide("xrx.viewbox.FastAffineTransform"),n.require("goog.math"),n.require("goog.math.AffineTransform"),xrx.viewbox.FastAffineTransform=function(){n.base(this),this.identity_,this.inverse_,this.clone_},n.inherits(xrx.viewbox.FastAffineTransform,n.math.AffineTransform),xrx.viewbox.FastAffineTransform.prototype.getIdentity=function(){return this.identity_||(this.identity_=new xrx.viewbox.FastAffineTransform),this.identity_.setTransform(1,0,0,1,0,0),this.identity_},xrx.viewbox.FastAffineTransform.prototype.getInverse=function(){this.inverse_||(this.inverse_=new xrx.viewbox.FastAffineTransform);var e=this.getDeterminant();return this.inverse_.setTransform(this.m11_/e,-this.m10_/e,-this.m01_/e,this.m00_/e,(this.m01_*this.m12_-this.m11_*this.m02_)/e,(this.m10_*this.m02_-this.m00_*this.m12_)/e),this.inverse_},xrx.viewbox.FastAffineTransform.prototype.getClone=function(){return this.clone_||(this.clone_=new xrx.viewbox.FastAffineTransform),this.clone_.copyFrom(this)},xrx.viewbox.FastAffineTransform.prototype.transformPoint=function(e,t){var r=void 0!==t?t:new Array(2);return this.createInverse().transform(e,0,r,0,1),r},xrx.viewbox.FastAffineTransform.prototype.getScale=function(){var e=this.getRotation();return this.getClone().rotate(n.math.toRadians(360-e)),this.clone_.getScaleX()},xrx.viewbox.FastAffineTransform.prototype.getRotation=function(){return{0:0,2:90,3:180,"-2":270}[Math.round(Math.atan2(this.getShearY(),this.getScaleY()))]},xrx.viewbox.FastAffineTransform.prototype.disposeInternal=function(){this.identity_=null,this.inverse_=null,this.clone_=null},n.provide("xrx.viewbox.ViewboxTransform"),n.require("xrx.viewbox.FastAffineTransform"),n.require("xrx.drawing.Orientation"),n.require("xrx.viewbox.ViewboxTranslate"),xrx.viewbox.ViewboxTransform=function(){this.ctm_=new xrx.viewbox.FastAffineTransform,n.base(this)},n.inherits(xrx.viewbox.ViewboxTransform,xrx.viewbox.ViewboxTranslate),xrx.viewbox.ViewboxTransform.prototype.getCTM=function(){return this.ctm_},xrx.viewbox.ViewboxTransform.prototype.setCTM=function(e){this.ctm_=e,this.drawing_.draw()},xrx.viewbox.ViewboxTransform.prototype.ctmDump=function(){return[this.ctm_.m00_,this.ctm_.m10_,this.ctm_.m01_,this.ctm_.m11_,this.ctm_.m02_,this.ctm_.m12_]},xrx.viewbox.ViewboxTransform.prototype.ctmRestore=function(e){if(6!==e.length)throw Error("Invalid CTM dump.");this.ctm_.setTransform(e[0],e[1],e[2],e[3],e[4],e[5]),this.drawing_.draw()},xrx.viewbox.ViewboxTransform.prototype.fitToWidth=function(e){var t=this.getWidth(!0,!0),r=this.drawing_.getCanvas().getWidth(),n=r/t;this.ctm_.scale(n,n),!1!==e&&this.center(),this.drawing_.draw(),this.dispatchExternal(xrx.drawing.EventType.VIEWBOX_CHANGE,this.drawing_)},xrx.viewbox.ViewboxTransform.prototype.fitToHeight=function(e){var t=this.getHeight(!0,!0),r=this.drawing_.getCanvas().getHeight(),n=r/t;this.ctm_.scale(n,n),!1!==e&&this.center(),this.drawing_.draw(),this.dispatchExternal(xrx.drawing.EventType.VIEWBOX_CHANGE,this.drawing_)},xrx.viewbox.ViewboxTransform.prototype.fit=function(e){this.getWidth(!0,!0)>this.getHeight(!0,!0)?this.fitToWidth():this.fitToHeight(),!1!==e&&this.center(),this.drawing_.draw()},xrx.viewbox.ViewboxTransform.prototype.disposeInternal=function(){this.ctm_.disposeInternal(),this.ctm_=null,n.base(this,"disposeInternal")},n.provide("xrx.viewbox.Viewbox"),n.require("xrx.viewbox.FastAffineTransform"),n.require("xrx.viewbox.ViewboxTransform"),n.require("xrx.shape.Group"),xrx.viewbox.Viewbox=function(e){n.base(this),this.drawing_=e,this.group_=new xrx.shape.Group(this.drawing_),this.state_=xrx.drawing.State.NONE,this.origin_},n.inherits(xrx.viewbox.Viewbox,xrx.viewbox.ViewboxTransform),xrx.viewbox.Viewbox.prototype.getDrawing=function(){return this.drawing_},xrx.viewbox.Viewbox.prototype.getGroup=function(){return this.group_},xrx.viewbox.Viewbox.prototype.handleDblClick=function(e,t){this.rotateRight(t.getPoint())},xrx.viewbox.Viewbox.prototype.handleDown=function(e,t){this.origin_=t.getPoint(),this.state_=xrx.drawing.State.DRAG},xrx.viewbox.Viewbox.prototype.handleMove=function(e,t){if(this.state_===xrx.drawing.State.DRAG){var r=t.getPoint()[0]-this.origin_[0],n=t.getPoint()[1]-this.origin_[1];this.translate(r,n),this.origin_=t.getPoint()}},xrx.viewbox.Viewbox.prototype.handleOut=function(e){this.resetState_()},xrx.viewbox.Viewbox.prototype.handleUp=function(e){this.resetState_()},xrx.viewbox.Viewbox.prototype.handleWheel=function(e,t){e.deltaY<0?this.zoomIn(t.getPoint()):this.zoomOut(t.getPoint())},xrx.viewbox.Viewbox.prototype.resetState_=function(){this.state_=xrx.drawing.State.NONE,this.origin_=null},xrx.viewbox.Viewbox.prototype.disposeInternal=function(){this.drawing_.dispose(),this.drawing_=null,this.group_.dispose(),this.group_=null,this.origin_=null,n.base(this,"disposeInternal")},n.provide("xrx.drawing.LayerBackground"),n.require("xrx.drawing.Layer"),n.require("xrx.shape.Group"),n.require("xrx.shape.Rect"),xrx.drawing.LayerBackground=function(e){n.base(this,e),this.image_},n.inherits(xrx.drawing.LayerBackground,xrx.drawing.Layer),xrx.drawing.LayerBackground.prototype.getImage=function(e){return this.image_},xrx.drawing.LayerBackground.prototype.setImage=function(e){this.image_.setImage(e)},xrx.drawing.LayerBackground.prototype.create_=function(){this.group_=new xrx.shape.Group(this.drawing_),this.image_=new xrx.shape.Image(this.drawing_),this.group_.addChildren(this.image_)},xrx.drawing.LayerBackground.prototype.disposeInternal=function(){this.image_.dispose(),this.image_=null,n.base(this,"disposeInternal")},n.provide("xrx.drawing.Creatable"),n.require("xrx.EventTarget"),xrx.drawing.Creatable=function(e){n.base(this),this.drawing_=e,this.shapeCreatable_,this.newShapes_=[],this.previewShapes_=[]},n.inherits(xrx.drawing.Creatable,xrx.EventTarget),xrx.drawing.Creatable.prototype.setShapeCreatable=function(e){this.shapeCreatable_=e},xrx.drawing.Creatable.prototype.handleCreate=function(e){if(this.shapeCreatable_ instanceof xrx.shape.ShapeGroupCreatable){0===this.shapeCreatable_.current&&this.drawing_.getLayerShapeCreate().addShapes(this.shapeCreatable_.getPreview());for(var t=0;t<e.length;t++)e[t]instanceof xrx.shape.Dragger?this.drawing_.getLayerShapeModify().addShapes(e[t]):this.shapeCreatable_.getPreview().addChildren(e[t])}else this.drawing_.getLayerShapeCreate().addShapes(e)},xrx.drawing.Creatable.prototype.handleCreated=function(e){if(this.shapeCreatable_ instanceof xrx.shape.ShapeGroupCreatable)if(this.newShapes_.push(e),this.drawing_.getLayerShapeModify().removeShapes(),this.shapeCreatable_.allShapesCreated()){var t=new xrx.shape.ShapeGroup(this.drawing_);t.addChildren(this.newShapes_),t.setStyles(this.shapeCreatable_.getTarget()),this.drawing_.getLayerShape().addShapes(t),this.drawing_.getLayerShapeCreate().removeShapes(),this.drawing_.draw(),this.shapeCreatable_.reset(),this.newShapes_=[]}else this.shapeCreatable_.current++;else this.drawing_.getLayerShape().addShapes(e),this.drawing_.getLayerShapeCreate().removeShapes(),this.drawing_.draw();this.dispatchExternal(xrx.drawing.EventType.SHAPE_CREATED,this.drawing_,e)},xrx.drawing.Creatable.prototype.handleDown=function(e,t){this.shapeCreatable_.handleDown(e,t)},xrx.drawing.Creatable.prototype.handleMove=function(e,t){this.shapeCreatable_.handleMove(e,t)},xrx.drawing.Creatable.prototype.handleUp=function(e,t){this.shapeCreatable_.handleUp(e,t)},n.provide("xrx.drawing.Hoverable"),n.require("goog.array"),n.require("xrx.drawing.EventType"),n.require("xrx.engine"),n.require("xrx.EventTarget"),xrx.drawing.Hoverable=function(e){n.base(this),this.drawing_=e,this.last_=[],this.multiple_=!1},n.inherits(xrx.drawing.Hoverable,xrx.EventTarget),xrx.drawing.Hoverable.prototype.setMultiple=function(e){this.multiple_=!!e},xrx.drawing.Hoverable.prototype.pop_=function(){var e,t=this.last_.length;if(this.last_.length>0){for(var r=0;r<t;r++)(e=this.last_[r])&&e.getHoverable().hoverOff();this.dispatchExternal(xrx.drawing.EventType.SHAPE_HOVER_OUT,this.drawing_,this.last_)}},xrx.drawing.Hoverable.prototype.push_=function(e){var t,r=e.length;if(r>0){for(var n=0;n<r;n++)(t=e[n])&&t.getHoverable().hoverOn();this.last_=e,this.dispatchExternal(xrx.drawing.EventType.SHAPE_HOVER_IN,this.drawing_,e)}else this.last_=[]},xrx.drawing.Hoverable.prototype.hover_=function(e){n.array.equals(e,this.last_)||(this.pop_(),this.push_(e)),e.length>0&&this.dispatchExternal(xrx.drawing.EventType.SHAPE_HOVER_MOVE,this.drawing_,e)},xrx.drawing.Hoverable.prototype.handleMove=function(e,t){var r;r=this.multiple_?t.getShapes():t.getShape(),n.isArray(r)||(r=[r]),this.hover_(r)},xrx.drawing.Hoverable.prototype.handleOut=function(e){this.pop_()},xrx.drawing.Hoverable.prototype.disposeInternal=function(){this.drawing_.dispose(),this.drawing_=null;for(var e;e=this.last_.pop();)e.dispose(),e=null;this.last_=null,n.base(this,"disposeInternal")},n.provide("xrx.drawing.Selectable"),n.require("xrx.EventTarget"),xrx.drawing.Selectable=function(e){n.base(this),this.drawing_=e,this.last_},n.inherits(xrx.drawing.Selectable,xrx.EventTarget),xrx.drawing.Selectable.prototype.getShape=function(){return this.last_},xrx.drawing.Selectable.prototype.setSelected=function(e){this.last_&&this.last_.getSelectable().selectOff(),e?(e.getSelectable().selectOn(),this.last_=e,this.dispatchExternal(xrx.drawing.EventType.SHAPE_SELECTED,this.drawing_,e)):this.last_=null},xrx.drawing.Selectable.prototype.handleDown=function(e,t){this.setSelected(t.getShape())},xrx.drawing.Selectable.prototype.disposeInternal=function(){this.drawing_.dispose(),this.drawing_=null,n.dispose(this.last_),this.last_=null,n.base(this,"disposeInternal")},n.provide("xrx.engine.Engine"),n.require("goog.Disposable"),n.require("xrx.engine"),n.require("xrx.engine.Engines"),xrx.engine.Engine=function(e,t){n.base(this),this.name_=e,this.available_=!1,this.init_(),this.canvas_=this.createCanvas_(t)},n.inherits(xrx.engine.Engine,n.Disposable),xrx.engine.Engine.prototype.getCanvas=function(){return this.canvas_},xrx.engine.Engine.prototype.createCanvas_=function(e){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Canvas.create(e);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Canvas.create(e);if(this.typeOf(xrx.engine.VML))return xrx.vml.Canvas.create(e);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.createCircle=function(){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Circle.create(this.canvas_);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Circle.create(this.canvas_);if(this.typeOf(xrx.engine.VML))return xrx.vml.Circle.create(this.canvas_);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.createEllipse=function(){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Ellipse.create(this.canvas_);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Ellipse.create(this.canvas_);if(this.typeOf(xrx.engine.VML))return xrx.vml.Ellipse.create(this.canvas_);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.createGroup=function(){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Group.create(this.canvas_);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Group.create(this.canvas_);if(this.typeOf(xrx.engine.VML))return xrx.vml.Group.create(this.canvas_);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.createImage=function(){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Image.create(this.canvas_);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Image.create(this.canvas_);if(this.typeOf(xrx.engine.VML))return xrx.vml.Image.create(this.canvas_);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.createLine=function(){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Line.create(this.canvas_);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Line.create(this.canvas_);if(this.typeOf(xrx.engine.VML))return xrx.vml.Line.create(this.canvas_);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.createPolygon=function(){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Polygon.create(this.canvas_);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Polygon.create(this.canvas_);if(this.typeOf(xrx.engine.VML))return xrx.vml.Polygon.create(this.canvas_);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.createPolyline=function(){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Polyline.create(this.canvas_);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Polyline.create(this.canvas_);if(this.typeOf(xrx.engine.VML))return xrx.vml.Polyline.create(this.canvas_);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.createRect=function(){if(this.typeOf(xrx.engine.CANVAS))return xrx.canvas.Polygon.create(this.canvas_);if(this.typeOf(xrx.engine.SVG))return xrx.svg.Polygon.create(this.canvas_);if(this.typeOf(xrx.engine.VML))return xrx.vml.Polygon.create(this.canvas_);throw Error("Unknown engine.")},xrx.engine.Engine.prototype.getName=function(){return this.name_},xrx.engine.Engine.prototype.typeOf=function(e){return this.name_===e},xrx.engine.Engine.prototype.isAvailable=function(){return this.available_},xrx.engine.Engine.prototype.findOptimalRenderer_=function(){if(xrx.engine.isSupported(xrx.engine.CANVAS))this.name_=xrx.engine.CANVAS,this.available_=!0;else if(xrx.engine.isSupported(xrx.engine.SVG))this.name_=xrx.engine.SVG,this.available_=!0;else{if(!xrx.engine.isSupported(xrx.engine.VML))throw Error("There is no graphics rendering engine available.");this.name_=xrx.engine.VML,this.available_=!0}},xrx.engine.Engine.prototype.forceRenderer_=function(){if(this.name_===xrx.engine.CANVAS)this.available_=xrx.engine.isSupported(xrx.engine.CANVAS);else if(this.name_===xrx.engine.SVG)this.available_=xrx.engine.isSupported(xrx.engine.SVG);else{if(this.name_!==xrx.engine.VML)throw this.available_=!1,Error("Unknown graphics rendering engine.");this.available_=xrx.engine.isSupported(xrx.engine.VML)}},xrx.engine.Engine.prototype.init_=function(){this.name_?this.forceRenderer_():this.findOptimalRenderer_()},xrx.engine.Engine.prototype.disposeInternal=function(){this.canvas_.dispose(),this.canvas_=null,n.base(this,"disposeInternal")},n.provide("goog.dom.ViewportSizeMonitor"),n.require("goog.dom"),n.require("goog.events"),n.require("goog.events.EventTarget"),n.require("goog.events.EventType"),n.require("goog.math.Size"),n.dom.ViewportSizeMonitor=function(e){n.events.EventTarget.call(this),this.window_=e||window,this.listenerKey_=n.events.listen(this.window_,n.events.EventType.RESIZE,this.handleResize_,!1,this),this.size_=n.dom.getViewportSize(this.window_)},n.inherits(n.dom.ViewportSizeMonitor,n.events.EventTarget),n.dom.ViewportSizeMonitor.getInstanceForWindow=function(e){var t=e||window,r=n.getUid(t);return n.dom.ViewportSizeMonitor.windowInstanceMap_[r]=n.dom.ViewportSizeMonitor.windowInstanceMap_[r]||new n.dom.ViewportSizeMonitor(t)},n.dom.ViewportSizeMonitor.removeInstanceForWindow=function(e){var t=n.getUid(e||window);n.dispose(n.dom.ViewportSizeMonitor.windowInstanceMap_[t]),delete n.dom.ViewportSizeMonitor.windowInstanceMap_[t]},n.dom.ViewportSizeMonitor.windowInstanceMap_={},n.dom.ViewportSizeMonitor.prototype.listenerKey_=null,n.dom.ViewportSizeMonitor.prototype.window_=null,n.dom.ViewportSizeMonitor.prototype.size_=null,n.dom.ViewportSizeMonitor.prototype.getSize=function(){return this.size_?this.size_.clone():null},n.dom.ViewportSizeMonitor.prototype.disposeInternal=function(){n.dom.ViewportSizeMonitor.superClass_.disposeInternal.call(this),this.listenerKey_&&(n.events.unlistenByKey(this.listenerKey_),this.listenerKey_=null),this.window_=null,this.size_=null},n.dom.ViewportSizeMonitor.prototype.handleResize_=function(e){var t=n.dom.getViewportSize(this.window_);n.math.Size.equals(t,this.size_)||(this.size_=t,this.dispatchEvent(n.events.EventType.RESIZE))},n.provide("xrx.drawing.Modifiable"),n.require("xrx.EventTarget"),n.require("xrx.geometry"),n.require("xrx.shape.Dragger"),xrx.drawing.Modifiable=function(e){n.base(this),this.drawing_=e,this.mode_=xrx.drawing.Modifiable.Mode.SHAPEHOVER,this.dragger_,this.shape_,this.origin_,this.propageted_=!1},n.inherits(xrx.drawing.Modifiable,xrx.EventTarget),xrx.drawing.Modifiable.Mode={DRAGSHAPE:1,HOVERSHAPE:2,DRAGDRAGGER:3},xrx.drawing.Modifiable.prototype.getShape=function(){return this.shape_},xrx.drawing.Modifiable.prototype.handleDown=function(e,t){var r,n=t.getShape();if(!n)return this.drawing_.getViewbox().handleDown(e,t),this.propageted_=!0,this.drawing_.getLayerShapeModify().removeShapes(),this.shape_&&this.shape_.getModifiable().selectOff(),this.shape_=null,void this.resetState_();this.origin_=t.getPointTransformed(),n&&n.isModifiable()?(this.state_=xrx.drawing.State.DRAG,n instanceof xrx.shape.Dragger?(this.mode_=xrx.drawing.Modifiable.Mode.DRAGDRAGGER,this.dragger_=n):(this.mode_=xrx.drawing.Modifiable.Mode.DRAGSHAPE,this.shape_&&this.shape_.getModifiable().selectOff(),this.shape_=n,r=this.shape_.getModifiable(),this.drawing_.getLayerShapeModify().activate(r),this.shape_.getModifiable().selectOn())):(this.drawing_.getLayerShapeModify().removeShapes(),this.shape_&&this.shape_.getModifiable().selectOff(),this.resetState_())},xrx.drawing.Modifiable.prototype.handleHover_=function(e,t){},xrx.drawing.Modifiable.prototype.handleDragShape_=function(e,t){var r=t.getPointTransformed(),n=r[0]-this.origin_[0],i=r[1]-this.origin_[1];this.shape_.getModifiable().move(n,i),this.origin_=r},xrx.drawing.Modifiable.prototype.handleMove=function(e,t){t.getShape();if(this.propageted_)return void this.drawing_.getViewbox().handleMove(e,t);var r=t.getPointTransformed();if(this.mode_===xrx.drawing.Modifiable.Mode.SHAPEHOVER)this.handleHover_(e,t);else if(this.mode_===xrx.drawing.Modifiable.Mode.DRAGDRAGGER)this.dragger_.setCoord(r),this.dispatchExternal(xrx.drawing.EventType.SHAPE_MODIFY,this.drawing_,this.shape_);else{if(this.mode_!==xrx.drawing.Modifiable.Mode.DRAGSHAPE)return;this.handleDragShape_(e,t),this.dispatchExternal(xrx.drawing.EventType.SHAPE_MODIFY,this.drawing_,this.shape_)}},xrx.drawing.Modifiable.prototype.handleUp=function(e,t){t.getShape()||this.drawing_.getViewbox().handleUp(e,t),this.resetState_(),this.propageted_=!1},xrx.drawing.Modifiable.prototype.resetState_=function(){this.mode_=xrx.drawing.Modifiable.Mode.SHAPEHOVER},xrx.drawing.Modifiable.prototype.disposeInternal=function(){this.drawing_.dispose(),this.drawing_=null,n.dispose(this.dragger_),n.dispose(this.shape_),this.origin_=null,n.base(this,"disposeInternal")},n.provide("xrx.drawing.Drawing"),n.require("goog.array"),n.require("goog.dom.DomHelper"),n.require("goog.dom.ViewportSizeMonitor"),n.require("xrx.engine.Engine"),n.require("xrx.engine.Engines"),n.require("goog.events"),n.require("goog.events.EventType"),n.require("goog.net.ImageLoader"),n.require("goog.style");n.require("goog.userAgent"),n.require("xrx.drawing.Creatable"),n.require("xrx.drawing.EventHandler"),n.require("xrx.drawing.Hoverable"),n.require("xrx.drawing.LayerBackground"),n.require("xrx.drawing.LayerShape"),n.require("xrx.drawing.LayerShapeCreate"),n.require("xrx.drawing.LayerShapeModify"),n.require("xrx.drawing.LayerTool"),n.require("xrx.drawing.Mode"),n.require("xrx.drawing.Modifiable"),n.require("xrx.drawing.Selectable"),n.require("xrx.drawing.State"),n.require("xrx.engine.Engine"),n.require("xrx.viewbox.Viewbox"),n.require("xrx.shape"),n.require("xrx.shape.Shapes"),xrx.drawing.Drawing=function(e,t){n.base(this),this.element_=e,this.engine_,this.canvas_,this.layer_=[],this.shield_,this.mode_=xrx.drawing.Mode.NONE,this.modifiable_=new xrx.drawing.Modifiable(this),this.selectable_=new xrx.drawing.Selectable(this),this.hoverable_=new xrx.drawing.Hoverable(this),this.creatable_=new xrx.drawing.Creatable(this),this.viewbox_,this.width_,this.height_,this.eventBeforeRendering,this.vsm_,this.timeoutDraw_,this.timeoutResize_,this.install_(t)},n.inherits(xrx.drawing.Drawing,xrx.drawing.EventHandler),xrx.drawing.Drawing.prototype.eventShapeModify=function(e){},xrx.drawing.Drawing.prototype.getElement=function(){return this.element_},xrx.drawing.Drawing.prototype.getEngine=function(){return this.engine_},xrx.drawing.Drawing.prototype.getCanvas=function(){return this.canvas_},xrx.drawing.Drawing.prototype.getLayerBackground=function(){return this.layer_[0]},xrx.drawing.Drawing.prototype.getLayerShape=function(){return this.layer_[1]},xrx.drawing.Drawing.prototype.getLayerShapeModify=function(){return this.layer_[3]},xrx.drawing.Drawing.prototype.getLayerShapeCreate=function(){return this.layer_[2]},xrx.drawing.Drawing.prototype.getLayerTool=function(){return this.layer_[4]},xrx.drawing.Drawing.prototype.getViewbox=function(){return this.viewbox_},xrx.drawing.Drawing.prototype.setSize=function(e,t){n.style.setSize(this.element_,e+"px",t+"px"),this.handleResize()},xrx.drawing.Drawing.prototype.getWidth=function(){return this.width_},xrx.drawing.Drawing.prototype.setWidth=function(e){this.setSize(e,this.height_)},xrx.drawing.Drawing.prototype.getHeight=function(){return this.height_},xrx.drawing.Drawing.prototype.setHeight=function(e){this.setSize(this.width_,e)},xrx.drawing.Drawing.prototype.setStyle=function(e,t){n.style.setStyle(this.element_,e,t),this.handleResize()},xrx.drawing.Drawing.prototype.getBackgroundImage=function(){return this.layer_[0].getImage().getImage()},xrx.drawing.Drawing.prototype.setBackgroundImage=function(e,t){var r=this.layer_[0].getImage();if(!r||r.src!==e){var i=this,o=new n.net.ImageLoader,s=n.dom.createElement("img");s.id="_tmp",s.src=e,n.events.listen(o,n.events.EventType.LOAD,function(e){i.layer_[0].setImage(e.target),t&&t.apply(i),i.draw()}),o.addImage("_tmp",s),o.start()}},xrx.drawing.Drawing.prototype.addShapes=function(e){this.layer_[1].addShapes(n.array.toArray(arguments)),this.draw()},xrx.drawing.Drawing.prototype.getShapes=function(){return this.layer_[1].getShapes()||[]},xrx.drawing.Drawing.prototype.removeShape=function(e){this.layer_[1].removeShape(e),this.layer_[3].removeShapes(),this.draw()},xrx.drawing.Drawing.prototype.getSelectedShape=function(){return this.mode_===xrx.drawing.Mode.SELECT?this.selectable_.getShape():this.mode_===xrx.drawing.Mode.MODIFY?this.modifiable_.getShape():null},xrx.drawing.Drawing.prototype.draw=function(){var e=this,t=this.getViewbox();this.eventBeforeRendering=function(e){e===t.getGroup()?e.setCTM(t.getCTM()):e instanceof xrx.shape.Style&&e.setZoomFactor(t.getZoomValue())},n.dom.getWindow().clearTimeout(this.timeoutDraw_),this.timeoutDraw_=n.dom.getWindow().setTimeout(function(){e.eventBeforeDraw&&e.eventBeforeDraw(),e.canvas_.draw()})},xrx.drawing.Drawing.prototype.getMode=function(){return this.mode_},xrx.drawing.Drawing.prototype.setMode_=function(e){e===this.mode_&&e!==xrx.drawing.Mode.CREATE||(this.mode_=e,this.registerEvents(e),this.draw())},xrx.drawing.Drawing.prototype.setModeDisabled=function(){this.getLayerBackground().setLocked(!0),this.getLayerShape().setLocked(!0),this.getLayerShapeModify().setLocked(!0),this.getLayerShapeCreate().setLocked(!0),this.getLayerShapeModify().removeShapes(),this.getLayerShapeCreate().removeShapes(),this.setMode_(xrx.drawing.Mode.DISABLED)},xrx.drawing.Drawing.prototype.setModeView=function(){this.getLayerBackground().setLocked(!1),this.getLayerShape().setLocked(!0),this.getLayerShapeModify().setLocked(!0),this.getLayerShapeCreate().setLocked(!0),this.getLayerShapeModify().removeShapes(),this.getLayerShapeCreate().removeShapes(),this.setMode_(xrx.drawing.Mode.VIEW)},xrx.drawing.Drawing.prototype.setModeHover=function(e){this.getLayerBackground().setLocked(!0),this.getLayerShape().setLocked(!1),this.getLayerShapeModify().setLocked(!0),this.getLayerShapeCreate().setLocked(!0),this.getLayerShapeModify().removeShapes(),this.getLayerShapeCreate().removeShapes(),this.hoverable_.setMultiple(e),!0===e?this.setMode_(xrx.drawing.Mode.HOVERMULTIPLE):this.setMode_(xrx.drawing.Mode.HOVER)},xrx.drawing.Drawing.prototype.setModeSelect=function(){this.getLayerBackground().setLocked(!0),this.getLayerShape().setLocked(!1),this.getLayerShapeModify().setLocked(!0),this.getLayerShapeCreate().setLocked(!0),this.getLayerShapeModify().removeShapes(),this.getLayerShapeCreate().removeShapes(),this.setMode_(xrx.drawing.Mode.SELECT)},xrx.drawing.Drawing.prototype.setSelected=function(e){this.selectable_.setSelected(e),this.draw()},xrx.drawing.Drawing.prototype.setModeModify=function(){this.getLayerBackground().setLocked(!0),this.getLayerShape().setLocked(!1),this.getLayerShapeModify().setLocked(!1),this.getLayerShapeCreate().setLocked(!0),this.getLayerShapeModify().removeShapes(),this.getLayerShapeCreate().removeShapes(),this.setMode_(xrx.drawing.Mode.MODIFY)},xrx.drawing.Drawing.prototype.setModeCreate=function(e){if(e){if(!(e instanceof xrx.shape.Creatable))throw Error("Instance of xrx.shape.Creatable expected.");this.creatable_.setShapeCreatable(e),this.getLayerBackground().setLocked(!0),this.getLayerShape().setLocked(!0),this.getLayerShapeModify().setLocked(!1),this.getLayerShapeCreate().setLocked(!1),this.getLayerShapeModify().removeShapes(),this.getLayerShapeCreate().removeShapes(),this.setMode_(xrx.drawing.Mode.CREATE)}},xrx.drawing.Drawing.prototype.handleResize=function(){var e=this;n.dom.getWindow().clearTimeout(this.timeoutResize_),this.timeoutResize_=n.dom.getWindow().setTimeout(function(){e.calculateSize_(),e.canvas_.setHeight(e.height_),e.canvas_.setWidth(e.width_),e.shield_.setHeight(e.height_),e.shield_.setWidth(e.width_)}),this.draw()},xrx.drawing.Drawing.prototype.calculateSize_=function(){var e=n.style.getSize(this.element_),t=n.style.getPaddingBox(this.element_),r=n.style.getBorderBox(this.element_),i=e.height-t.top-t.bottom-r.top-r.bottom,o=e.width-t.left-t.right-r.left-r.right;this.width_=o,this.height_=i},xrx.drawing.Drawing.prototype.installCanvas_=function(){var e=this;this.vsm_=new n.dom.ViewportSizeMonitor,n.events.listen(this.vsm_,n.events.EventType.RESIZE,function(t){e.handleResize()},!1,e),this.canvas_=new xrx.shape.Canvas(this),this.canvas_.setHeight(this.height_),this.canvas_.setWidth(this.width_)},xrx.drawing.Drawing.prototype.installViewbox_=function(){this.viewbox_=new xrx.viewbox.Viewbox(this),this.canvas_.addChildren(this.viewbox_.getGroup())},xrx.drawing.Drawing.prototype.installLayerBackground_=function(){this.layer_[0]=new xrx.drawing.LayerBackground(this),this.viewbox_.getGroup().addChildren(this.layer_[0].getGroup())},xrx.drawing.Drawing.prototype.installLayerShape_=function(){this.layer_[1]=new xrx.drawing.LayerShape(this),this.viewbox_.getGroup().addChildren(this.layer_[1].getGroup())},xrx.drawing.Drawing.prototype.installLayerShapeModify_=function(){this.layer_[3]=new xrx.drawing.LayerShapeModify(this),this.viewbox_.getGroup().addChildren(this.layer_[3].getGroup())},xrx.drawing.Drawing.prototype.installLayerShapecreatable_=function(){this.layer_[2]=new xrx.drawing.LayerShapeCreate(this),this.viewbox_.getGroup().addChildren(this.layer_[2].getGroup())},xrx.drawing.Drawing.prototype.installShield_=function(){this.shield_=new xrx.shape.Rect(this),this.shield_.setX(0),this.shield_.setY(0),this.shield_.setWidth(this.width_),this.shield_.setHeight(this.height_),this.shield_.setFillOpacity(0),this.shield_.setStrokeWidth(0),this.canvas_.addChildren(this.shield_)},xrx.drawing.Drawing.prototype.installLayerTool_=function(){this.layer_[4]=new xrx.drawing.LayerTool(this)},xrx.drawing.Drawing.prototype.initEngine_=function(e){this.engine_=new xrx.engine.Engine(e,this.element_)},xrx.drawing.Drawing.prototype.install_=function(e){this.initEngine_(e),this.engine_.isAvailable()&&(n.dom.removeChildren(this.element_),this.calculateSize_(),this.installCanvas_(),this.installViewbox_(),this.installLayerBackground_(),this.installLayerShape_(),this.installLayerShapecreatable_(),this.installLayerShapeModify_(),this.installShield_(),this.installLayerTool_())},xrx.drawing.Drawing.prototype.disposeInternal=function(){n.dom.removeNode(this.element_),this.element_=null,this.engine_.dispose(),this.engine_=null,this.canvas_.dispose(),this.canvas_=null;for(var e;e=this.layer_.pop();)e.dispose(),e=null;this.layer_=null,this.shield_.dispose(),this.shield_=null,this.modifiable_.dispose(),this.modifiable_=null,this.selectable_.dispose(),this.selectable_=null,this.hoverable_.dispose(),this.hoverable_=null,n.dispose(this.creatable_),this.creatable_=null,this.viewbox_.dispose(),this.viewbox_=null,this.eventBeforeRendering=null,this.vsm_.removeAllListeners(),this.vsm_.dispose(),this.vsm_=null,this.timeoutDraw_=null,this.timeoutResize_=null,n.base(this,"disposeInternal")},n.provide("xrx.shape.DiPolygon"),n.provide("xrx.shape.DiPolygonPolygon"),n.provide("xrx.shape.DiPolygonArrow"),n.provide("xrx.shape.DiPolygonArrowModifiable"),n.require("xrx.geometry"),n.require("xrx.shape.Group"),n.require("xrx.shape.Line"),n.require("xrx.shape.LineModifiable"),n.require("xrx.shape.Polygon"),n.require("xrx.shape.Rect"),xrx.shape.DiPolygonArrow=function(e,t){n.base(this,e),this.diPolygon_=t,this.angle_},n.inherits(xrx.shape.DiPolygonArrow,xrx.shape.Line),xrx.shape.DiPolygonArrow.prototype.getDiPolygon=function(){return this.diPolygon_},xrx.shape.DiPolygonArrow.prototype.getModifiable=function(){return void 0===this.modifiable_&&(this.modifiable_=new xrx.shape.DiPolygonArrowModifiable(this)),this.modifiable_},xrx.shape.DiPolygonArrowModifiable=function(e){n.base(this,e)},n.inherits(xrx.shape.DiPolygonArrowModifiable,xrx.shape.LineModifiable),xrx.shape.DiPolygonArrowModifiable.prototype.setCoordAt=function(e,t){var r=this.shape_.getDiPolygon().getBox(),n=t[0],i=t[1];n<r.x?n=r.x:n>r.x2&&(n=r.x2),i<r.y?i=r.y:i>r.y2&&(i=r.y2);var o=r.x+r.width/2,s=r.y+r.height/2,a=o-(n-o),l=s-(i-s);0===e?(this.dragger_[0].setCoordX(n),this.dragger_[0].setCoordY(i),this.dragger_[1].setCoordX(a),this.dragger_[1].setCoordY(l),this.shape_.setX1(n),this.shape_.setY1(i),this.shape_.setX2(a),this.shape_.setY2(l)):(this.dragger_[1].setCoordX(n),this.dragger_[1].setCoordY(i),this.dragger_[0].setCoordX(a),this.dragger_[0].setCoordY(l),this.shape_.setX1(a),this.shape_.setY1(l),this.shape_.setX2(n),this.shape_.setY2(i))},xrx.shape.DiPolygonArrowModifiable.prototype.move=function(){},xrx.shape.DiPolygonPolygon=function(e){n.base(this,e)},n.inherits(xrx.shape.DiPolygonPolygon,xrx.shape.Polygon),xrx.shape.DiPolygon=function(e){n.base(this,e),this.box_,this.init_()},n.inherits(xrx.shape.DiPolygon,xrx.shape.Group),xrx.shape.DiPolygon.prototype.getArrow=function(){return this.arrow_},xrx.shape.DiPolygon.prototype.getBox=function(){return this.box_},xrx.shape.DiPolygon.prototype.MARGIN=20,xrx.shape.DiPolygon.prototype.setCoords=function(e){this.childs_[0].setCoords(e)},xrx.shape.DiPolygon.prototype.init_=function(){var e=new xrx.shape.DiPolygonPolygon(this.drawing_),t=new xrx.shape.DiPolygonArrow(this.drawing_,this);this.addChildren([e,t])},n.provide("xrx.extension.Extensions"),n.require("xrx.shape.DiPolygon"),n.provide("xrx.api.drawing"),n.require("xrx.drawing"),n.require("xrx.drawing.Drawing"),n.require("xrx.engine"),n.require("xrx.engine.Engine"),n.require("xrx.engine.Engines"),n.require("xrx.extension.Extensions"),n.require("xrx.shape"),n.require("xrx.shape.Shapes"),xrx.api.drawing=function(){}}]);
//# sourceMappingURL=xrx.js.map